var __ubi_isregist=true;try {if (typeof nexacro == 'undefined' || (typeof nexacro.Browser != 'undefined' && nexacro.Browser != 'Runtime') || (typeof nexacro._Browser != 'undefined' && nexacro._Browser != 'Runtime')) {__ubi_isregist=true;} else { __ubi_isregist=false; }} catch (e) {__ubi_isregist=true;}if (__ubi_isregist) {function _ubi_ajax(options) { options={ type: options.type || "POST", url: options.url || "", timeout: options.timeout || 60000, onComplete: options.onComplete || function(){}, onError: options.onError || function(){}, onSuccess: options.onSuccess || function(){}, onStatus: options.onStatus || null, reqdata: options.reqdata || "", datatype: options.datatype || "", exportseq: "" }; if(typeof XMLHttpRequest == "undefined"){ XMLHttpRequest=function() { return new ActiveXObject( navigator.userAgent.indexOf("MSIE 5") >= 0 ? "Microsoft.XMLHTTP" : "Msxml2.XMLHTTP" ); }; } var xml=new XMLHttpRequest(); if(options.type == "POST") { xml.open(options.type, options.url, true); } else if(options.type == "GET") { xml.open(options.type, options.url+((options.reqdata != "")?"?"+serialize(options.reqdata):""), true); } var timeoutLength=options.timeout; var requestDone=false; setTimeout(function() { requestDone=true; }, timeoutLength); var statuslength=0; var reqtype=""; try { reqtype=options.reqdata['reqtype']; } catch(e) {} xml.onreadystatechange=function() { if (!xml) return; try { if (xml.responseText && options.onStatus) { var status=xml.responseText.substring(statuslength); statuslength=xml.responseText.length; options.onStatus(status); if( (reqtype == "93") ) { if (status.indexOf("ER0") == 0) { options.onError(status.substring(status.indexOf("ER0"), status.length)); options.onComplete(); xml=null; return; } } else { if (status.indexOf("ER0") == 0) { options.onError(status); options.onComplete(); xml=null; return; } } } } catch(e) { } if( xml.readyState == 4 && !requestDone) { if( (reqtype == "93") && xml.responseText.indexOf("ER0") == 0 ) { options.onError(xml.responseText.substring(xml.responseText.indexOf("ER0"))); } else { if( xml.responseText.indexOf("ER0") != 0 && xml != null && httpSuccess(xml) ) { var xmldata=httpData(xml, options.datatype); if (xmldata != null) { options.exportseq=xml.getResponseHeader("exportseq"); options.onSuccess(xmldata); } else { options.onError(xml.responseText); } } else { options.onError(xml.responseText); } } options.onComplete(); xml=null; } }; if(options.type == "POST") { xml.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"); xml.send(serialize(options.reqdata)); } else { xml.send(); } function httpSuccess(r) { try{ return (!r.status && location.protocol == "file:") || (r.status >= 200 && r.status < 300) || r.satus == 304 || navigator.userAgent.indexOf("Safari") >= 0 && typeof r.status == "undefined;"; }catch(e){} return false; } function httpData(r, type) { var ct=r.getResponseHeader("content-type"); var data=!type && ct && ct.indexOf("xml") >= 0; data=type == "xml" || data ? r.responseXML : r.responseText; if(type == "script") eval.call(window, data); return data; } function serialize(a) { var s=[]; if(a.constructor == Array) { for(var i=0; i<a.length; i++) s.push(a[i].name + "=" + encodeURIComponent(encodeURIComponent(a[i].value))); } else { for(var j in a){ s.push( j + "=" + encodeURIComponent(encodeURIComponent(a[j]))); if (j === "userHeader") { var _userheader=a[j]; if (_userheader != undefined && _userheader != '') { var hrowarr=_userheader.split("^n"); for(var k in hrowarr) { if (hrowarr[k] == undefined || hrowarr[k] == '') { continue; } var hcolarr=hrowarr[k].split("^t"); if (hcolarr.length >= 2) { xml.setRequestHeader(hcolarr[0], hcolarr[1]); } } } } } } return s.join("&"); } }var _UBI_REPORT_VERSION_NO="4.0";var _UBI_REPORT_BUILD_NO="Build 4.0.2107.901";var Base=function() { };Base.extend=function(_instance, _static) { var extend=Base.prototype.extend; Base._prototyping=true; var proto=new this; extend.call(proto, _instance); delete Base._prototyping; var constructor=proto.constructor; var klass=proto.constructor=function() { if (!Base._prototyping) { if (this._constructing || this.constructor == klass) { this._constructing=true; constructor.apply(this, arguments); delete this._constructing; } else if (arguments[0] != null) { return (arguments[0].extend || extend).call(arguments[0], proto); } } }; klass.ancestor=this; klass.extend=this.extend; klass.forEach=this.forEach; klass.implement=this.implement; klass.prototype=proto; klass.toString=this.toString; klass.valueOf=function(type) { return (type == "object") ? klass : constructor.valueOf(); }; extend.call(klass, _static); if (typeof klass.init == "function") klass.init(); return klass;};Base.prototype={ extend: function(source, value) { if (arguments.length > 1) { var ancestor=this[source]; if (ancestor && (typeof value == "function") && (!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) && /\bbase\b/.test(value)) { var method=value.valueOf(); value=function() { var previous=this.base || Base.prototype.base; this.base=ancestor; var returnValue=method.apply(this, arguments); this.base=previous; return returnValue; }; value.valueOf=function(type) { return (type == "object") ? value : method; }; value.toString=Base.toString; } this[source]=value; } else if (source) { var extend=Base.prototype.extend; if (!Base._prototyping && typeof this != "function") { extend=this.extend || extend; } var proto={toSource: null}; var hidden=["constructor", "toString", "valueOf"]; var i=Base._prototyping ? 0 : 1; while (key=hidden[i++]) { if (source[key] != proto[key]) { extend.call(this, key, source[key]); } } for (var key in source) { if (!proto[key]) extend.call(this, key, source[key]); } } return this; }, base: function() { }};Base=Base.extend({ constructor: function() { this.extend(arguments[0]); }}, { ancestor: Object, version: "1.1", forEach: function(object, block, context) { for (var key in object) { if (this.prototype[key] === undefined) { block.call(context, object[key], key, object); } } }, implement: function() { for (var i=0; i < arguments.length; i++) { if (typeof arguments[i] == "function") { arguments[i](this.prototype); } else { this.prototype.extend(arguments[i]); } } return this; }, toString: function() { return String(this.valueOf()); }});function getAttributeStringValue(attributes, name, defvalue){ if (defvalue == undefined) defvalue=""; var item=attributes.getNamedItem(name); if(item == null) { return defvalue; } return item.nodeValue;}function getAttributeIntValue(attributes, name, defvalue){ if (defvalue == undefined) defvalue=0; var item=attributes.getNamedItem(name); if(item == null) { return defvalue; } return parseInt(item.nodeValue);}function getAttributeColorValue(attributes, name, defvalue){ var item=attributes.getNamedItem(name); if(item == null) { if (defvalue == undefined) return "000000"; else return defvalue; } return item.nodeValue;}function getAttributeBooleanValue(attributes, name, defvalue){ if (defvalue == undefined) defvalue=false; var item=attributes.getNamedItem(name); if(item == null) { return defvalue; } return (item.nodeValue=="1"||item.nodeValue=="true")?true:false;}function nvl(value) { if (value == null) return ""; return value;}function getNodeValue(node) { try { if (node == null) return ""; return (node.nodeValue==null?"":node.nodeValue); } catch (e) { } return "";}function makeArray() { var arr=[]; for(var i=0; i<arguments.length; i++) { arr.push(arguments[i]); } return arr;}var UbiObject=Base.extend({ classname: "", constructor: function(classname) { if(typeof classname == "undefined") { classname=UbiObject.CLASSNAME; } this.classname=classname; }, GetClassname: function(){ return this.classname; }},{ CLASSNAME: "UbiObject", ATTRCLASSNAME: "classname"});var UbiMap=UbiObject.extend({ constructor: function() { this.base(UbiMap.CLASSNAME); this.keys=new Array(); this.datum=new Array(); }, Lookup: function(key){ var index=this.FindIndex(key); var rvalue; if(index >= 0) { rvalue=this.GetValue(index); } return rvalue; }, SetAt: function(key, newValue){ var index=this.FindIndex(key); if (index < 0) { this.keys.push(key); this.datum.push(newValue); } else { this.SetValue(index, newValue); } }, GetAt: function(index) { return this.GetKey(index); }, GetCount: function(){ return this.keys.length; }, FindIndex: function(key){ var index=-1; for(var i=0; i<this.GetCount(); i++) { if(key == this.GetKey(i)) { index=i; break; } } return index; }, GetKey: function(index){ return this.keys[index]; }, SetValue: function(index, value){ this.datum[index]=value; }, GetValue: function(index){ return this.datum[index]; }},{ CLASSNAME: "UbiMap"});var UbiList=UbiObject.extend({ constructor: function() { this.base(UbiList.CLASSNAME); this.datum=new Array(); }, GetSize: function() { return this.datum.length; }, GetAt: function(index) { return this.datum[index]; }, Add: function(value) { this.datum.push(value); return this.GetSize(); }, SetAt: function(index, value) { this.datum[index]=value; return this.GetSize(); }, Remove: function(index) { this.datum.splice(index, 1); }},{ CLASSNAME: "UbiList"});var UbiDocObject=UbiObject.extend({ id: "", constructor: function(classname, id){ if(typeof classname == "undefined") { classname=UbiDocObject.CLASSNAME; } this.base(classname); if(typeof id == "undefined") { id=""; } this.id=id; }},{ CLASSNAME: "UbiDocObject", NODEOBJECT: "Object", ATTRID: "id", CreateInstance: function(node){ }});var UbiFontObject=UbiDocObject.extend({ name: "", style: 0, size: 0, constructor: function(){ this.base(UbiFontObject.CLASSNAME); }, getFont: function(ds) { var str=""; if(this.style == 0){ str="normal normal " + Math.round(this.size*ds) + "px '" + this.name + "'"; }else if(this.style == 1){ str="normal bold " + Math.round(this.size*ds) + "px '" + this.name + "'"; }else if(this.style == 2){ str="italic normal " + Math.round(this.size*ds) + "px '" + this.name + "'"; }else if(this.style == 3){ str="italic bold " + Math.round(this.size*ds) + "px '" + this.name + "'"; } return str; }, getFontSize: function(ds) { return Math.round(this.size*ds); }},{ CLASSNAME: "UbiFontObject", NODEFONTOBJ: "Fontobj", ATTRNAME: "name", ATTRSTYLE: "style", ATTRSIZE: "size", CreateInstance: function(node){ var data=UbiFontObject.getData(node); var fontobj=new UbiFontObject(); fontobj.id=data.id; fontobj.name=data.name; fontobj.style=data.style; fontobj.size=data.size; return fontobj; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiDocObject.ATTRID), name: getAttributeStringValue(attributes, UbiFontObject.ATTRNAME), style: getAttributeIntValue(attributes, UbiFontObject.ATTRSTYLE), size: getAttributeIntValue(attributes, UbiFontObject.ATTRSIZE) }; }});var UbiLineObject=UbiDocObject.extend({ type: 0, thickness: 0, colorid: "", constructor: function(){ this.base(UbiLineObject.CLASSNAME); }, getWidth : function(){ var str; str=this.thickness; return str; }, getStyle : function() { var str; if(this.type == -1) { str="none"; }else if(this.type == 0) { str="solid"; }else if(this.type == 1) { str="dotted"; }else if(this.type == 2) { str="dashed"; }else if(this.type == 3) { str="dashed"; } return str; }},{ CLASSNAME: "UbiLineObject", NODELINEOBJ: "Lineobj", ATTRTYPE: "type", ATTRTHICKNESS: "thickness", ATTRCOLORID: "colorid", CreateInstance: function(node){ var data=UbiLineObject.getData(node); var lineobj=new UbiLineObject(); lineobj.id=data.id; lineobj.type=data.type; lineobj.thickness=data.thickness; lineobj.colorid=data.colorid; return lineobj; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiDocObject.ATTRID), type: getAttributeIntValue(attributes, UbiLineObject.ATTRTYPE), thickness: getAttributeIntValue(attributes, UbiLineObject.ATTRTHICKNESS), colorid: getAttributeStringValue(attributes, UbiLineObject.ATTRCOLORID) }; }});var UbiColorObject=UbiDocObject.extend({ color: "", constructor: function(){ this.base(UbiColorObject.CLASSNAME); }},{ CLASSNAME: "UbiColorObject", NODECOLOROBJ: "Colorobj", ATTRCOLOR: "color", CreateInstance: function(node){ var data=UbiColorObject.getData(node); var colorobj=new UbiColorObject(); colorobj.id=data.id; colorobj.color=data.color; return colorobj; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiDocObject.ATTRID), color: getAttributeColorValue(attributes, UbiColorObject.ATTRCOLOR) }; }});var UbiBorderObject=UbiDocObject.extend({ top: "", bottom: "", left: "", right: "", diagonaldown: "", diagonalup: "", constructor: function(){ this.base(UbiBorderObject.CLASSNAME); }},{ CLASSNAME: "UbiBorderObject", NODEBORDEROBJ: "Borderobj", ATTRTOP: "top", ATTRBOTTOM: "bottom", ATTRLEFT: "left", ATTRRIGHT: "right", ATTRDIAGONALDOWN: "diagonaldown", ATTRDIAGONALUP: "diagonalup", CreateInstance: function(node){ var data=UbiBorderObject.getData(node); var borderobj=new UbiBorderObject(); borderobj.id=data.id; borderobj.top=data.top; borderobj.bottom=data.bottom; borderobj.left=data.left; borderobj.right=data.right; borderobj.diagonaldown=data.diagonaldown; borderobj.diagonalup=data.diagonalup; return borderobj; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiDocObject.ATTRID), top: getAttributeStringValue(attributes, UbiBorderObject.ATTRTOP), bottom: getAttributeStringValue(attributes, UbiBorderObject.ATTRBOTTOM), left: getAttributeStringValue(attributes, UbiBorderObject.ATTRLEFT), right: getAttributeStringValue(attributes, UbiBorderObject.ATTRRIGHT), diagonaldown: getAttributeStringValue(attributes, UbiBorderObject.ATTRDIAGONALDOWN), diagonalup: getAttributeStringValue(attributes, UbiBorderObject.ATTRDIAGONALUP) }; }});var UbiImageObject=UbiDocObject.extend({ width: 0, height: 0, originalsize: false, fixedrate: false, brightness: 0, loadtype: 0, loadsrc: "", imagesrc: "", constructor: function(){ this.base(UbiImageObject.CLASSNAME); }},{ CLASSNAME: "UbiImageObject", NODEIMAGEOBJ: "Imageobj", ATTRWIDTH: "width", ATTRHEIGHT: "height", ATTRORIGINALSIZE: "originalsize", ATTRFIXEDRATE: "fixedrate", ATTRBRIGHTNESS: "brightness", ATTRLOADTYPE: "loadtype", ATTRLOADSRC: "loadsrc", NODEIMAGESRC: "src", CreateInstance: function(node){ var data=UbiImageObject.getData(node); var imageobj=new UbiImageObject(); imageobj.id=data.id; imageobj.width=data.width; imageobj.height=data.height; imageobj.originalsize=data.originalsize; imageobj.fixedrate=data.fixedrate; imageobj.brightness=data.brightness; imageobj.loadtype=data.loadtype; if (data.loadtype == 3) { imageobj.loadsrc=data.imagesrc; } else { imageobj.loadsrc=data.loadsrc; } data=null; return imageobj; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiDocObject.ATTRID), width: getAttributeIntValue(attributes, UbiImageObject.ATTRWIDTH), height: getAttributeIntValue(attributes, UbiImageObject.ATTRHEIGHT), originalsize: getAttributeBooleanValue(attributes, UbiImageObject.ATTRORIGINALSIZE), fixedrate: getAttributeBooleanValue(attributes, UbiImageObject.ATTRFIXEDRATE), brightness: getAttributeIntValue(attributes, UbiImageObject.ATTRBRIGHTNESS), loadtype: getAttributeIntValue(attributes, UbiImageObject.ATTRLOADTYPE), loadsrc: getAttributeStringValue(attributes, UbiImageObject.ATTRLOADSRC), imagesrc: (node.getElementsByTagName(UbiImageObject.NODEIMAGESRC)[0]==null)?"":getNodeValue(node.getElementsByTagName(UbiImageObject.NODEIMAGESRC)[0].childNodes[0]) }; }});var UbiDocProperty=UbiObject.extend({ width: 0, height: 0, margintop: 0, marginbottom: 0, marginleft: 0, marginright: 0, pagesize: "A4", orientation: "Portrait", language:"Korean", constructor: function() { this.base(UbiDocProperty.CLASSNAME); }},{ CLASSNAME: "UbiDocProperty", NODEDOCPROPERTY: "DocProperty", ATTRWIDTH: "width", ATTRHEIGHT: "height", ATTRMARGINTOP: "margintop", ATTRMARGINBOTTOM: "marginbottom", ATTRMARGINLEFT: "marginleft", ATTRMARGINRIGHT: "marginright", ATTRPAGESIZE: "pagesize", ATTRORIENTATION: "orientation", ATTRLANGUAGE: "language", CreateInstance: function(parent) { var data=UbiDocProperty.getData(parent); var docprop=new UbiDocProperty(); docprop.width=data.width; docprop.height=data.height; docprop.margintop=data.margintop; docprop.marginbottom=data.marginbottom; docprop.marginleft=data.marginleft; docprop.marginright=data.marginright; docprop.pagesize=data.pagesize; docprop.orientation=data.orientation; docprop.language=data.language; return docprop; }, getData: function(parent) { var node=parent.getElementsByTagName(UbiDocProperty.NODEDOCPROPERTY)[0]; var attributes=node.attributes; return { width: getAttributeIntValue(attributes, UbiDocProperty.ATTRWIDTH), height: getAttributeIntValue(attributes, UbiDocProperty.ATTRHEIGHT), margintop: getAttributeIntValue(attributes, UbiDocProperty.ATTRMARGINTOP), marginbottom: getAttributeIntValue(attributes, UbiDocProperty.ATTRMARGINBOTTOM), marginleft: getAttributeIntValue(attributes, UbiDocProperty.ATTRMARGINLEFT), marginright: getAttributeIntValue(attributes, UbiDocProperty.ATTRMARGINRIGHT), pagesize: getAttributeStringValue(attributes, UbiDocProperty.ATTRPAGESIZE), orientation: getAttributeStringValue(attributes, UbiDocProperty.ATTRORIENTATION), language: getAttributeStringValue(attributes, UbiDocProperty.ATTRLANGUAGE) }; }});var UbiTextStyleInfo=UbiObject.extend({ constructor: function() { this.base(UbiTextStyleInfo.CLASSNAME); this.styles=new UbiList(); }},{ CLASSNAME: "UbiTextStyleInfo", NODETEXTSTYLE: "TextStyle", CreateInstance: function(node) { var data=UbiTextStyleInfo.getData(node); var styleinfo=new UbiTextStyleInfo(); var stylelist=data.stylelist; if (stylelist != null) { for(var i=0; i<stylelist.length; i++) { var stylenode=stylelist[i]; var styleobj=UbiTextStyleObject.CreateInstance(stylenode); styleinfo.styles.Add(styleobj); } } return styleinfo; }, getData: function(node) { return { stylelist: node.getElementsByTagName(UbiTextStyleObject.NODESTYLEOBJ) }; }}); var UbiTextStyleObject=UbiObject.extend({ startindex: -1, endindex: -1, fontname: "", fontsize: -1, fontstyle: -1, fontcolor: "", underlined: false, strike: false, highlight: "", superscript: false, subscript: false, lineheight: 0, constructor: function() { this.base(UbiTextStyleObject.CLASSNAME); }},{ CLASSNAME: "UbiTextStyleObject", NODESTYLEOBJ: "Style", ATTRSTARTINDEX: "startindex", ATTRENDINDEX: "endindex", ATTRFONTNAME: "fontname", ATTRFONTSIZE: "fontsize", ATTRFONTSTYLE: "fontstyle", ATTRFONTCOLOR: "fontcolor", ATTRUNDERLINED: "underlined", ATTRSTRIKE: "strike", ATTRTEXTHIGHLIGHT: "highlight", ATTRSUPERSCRIPT: "super", ATTRSUBSCRIPT: "sub", ATTRLINEHEIGHT: "lineheight", CreateInstance: function(node) { var data=UbiTextStyleObject.getData(node); var styleobj=new UbiTextStyleObject(); styleobj.startindex=data.startindex; styleobj.endindex=data.endindex; styleobj.fontname=data.fontname; styleobj.fontsize=data.fontsize; styleobj.fontstyle=data.fontstyle; styleobj.fontcolor=data.fontcolor; styleobj.underlined=data.underlined; styleobj.strike=data.strike; styleobj.highlight=data.highlight; styleobj.superscript=data.superscript; styleobj.subscript=data.subscript; styleobj.lineheight=data.lineheight; return styleobj; }, getData: function(node) { var attributes=node.attributes; return { startindex: getAttributeIntValue(attributes, UbiTextStyleObject.ATTRSTARTINDEX, -1), endindex: getAttributeIntValue(attributes, UbiTextStyleObject.ATTRENDINDEX, -1), fontname: getAttributeStringValue(attributes, UbiTextStyleObject.ATTRFONTNAME, ""), fontsize: getAttributeIntValue(attributes, UbiTextStyleObject.ATTRFONTSIZE, -1), fontstyle: getAttributeIntValue(attributes, UbiTextStyleObject.ATTRFONTSTYLE, -1), fontcolor: getAttributeColorValue(attributes, UbiTextStyleObject.ATTRFONTCOLOR, ""), underlined: getAttributeBooleanValue(attributes, UbiTextStyleObject.ATTRUNDERLINED, false), strike: getAttributeBooleanValue(attributes, UbiTextStyleObject.ATTRSTRIKE, false), highlight: getAttributeColorValue(attributes, UbiTextStyleObject.ATTRTEXTHIGHLIGHT, ""), superscript: getAttributeBooleanValue(attributes, UbiTextStyleObject.ATTRSUPERSCRIPT, false), subscript: getAttributeBooleanValue(attributes, UbiTextStyleObject.ATTRSUBSCRIPT, false), lineheight: getAttributeIntValue(attributes, UbiTextStyleObject.ATTRLINEHEIGHT, 0) }; }});var UbiItem=UbiObject.extend({ id: "", x: 0, y: 0, width: 0, height: 0, foregroundid: "", backgroundid: "", transparent: false, iseditable: false, ispreview : true, isprint : true, isvoiceye : false, voiceyetitle : "", linked: false, linkfilename: "", linkargs: "", linkstyle: "", constructor: function(classname) { if(typeof classname == "undefined") { classname=UbiItem.CLASSNAME; } this.base(classname); }},{ CLASSNAME: "UbiItem", NODEITEM: "Item", ATTRID: "id", ATTRX: "x", ATTRY: "y", ATTRWIDTH: "width", ATTRHEIGHT: "height", ATTRFORECOLORID: "forecolorid", ATTRBACKCOLORID: "backcolorid", ATTRTRANSPARENT: "transparent", ATTRISEDITABLE: "iseditable", ATTRISPREVIEW: "ispreview", ATTRISPRINT: "isprint", ATTRLINKED: "linked", ATTRLINKFILENAME: "linkfilename", ATTRLINKARGS: "linkarg", ATTRLINKSTYLE: "linkstyle", NODELINKARG: "Linkarg", ATTRNAME: "name", ATTRISVOICEYE: "isvoiceye", ATTRVOICEYETITLE: "voiceyetitle", CreateInstance: function(node, doc){ var attributes=node.attributes; var _classname=getAttributeStringValue(attributes, UbiObject.ATTRCLASSNAME); if (_classname == UbiTextItem.CLASSNAME) { return UbiTextItem.CreateInstance(node, doc); } else if (_classname == UbiCircleItem.CLASSNAME) { return UbiCircleItem.CreateInstance(node, doc); } else if (_classname == UbiLineItem.CLASSNAME) { return UbiLineItem.CreateInstance(node, doc); } else if (_classname == UbiRectangleItem.CLASSNAME) { return UbiRectangleItem.CreateInstance(node, doc); } else if (_classname == UbiImageItem.CLASSNAME) { return UbiImageItem.CreateInstance(node, doc); } else if (_classname == UbiBarcodeItem.CLASSNAME) { return UbiBarcodeItem.CreateInstance(node, doc); } }, SetMemberFromNode: function(item, node){ var data=UbiItem.getData(node); item.id=data.id; item.x=data.x; item.y=data.y; item.width=data.width; item.height=data.height; item.foregroundid=data.foregroundid; item.backgroundid=data.backgroundid; item.transparent=data.transparent; item.iseditable=data.iseditable; item.ispreview=data.ispreview; item.isprint=data.isprint; item.linked=data.linked; item.linkfilename=data.linkfilename; item.linkargs=data.linkargs; item.linkstyle=data.linkstyle; item.isvoiceye=data.isvoiceye; item.voiceyetitle=data.voiceyetitle; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiItem.ATTRID), x: getAttributeIntValue(attributes, UbiItem.ATTRX), y: getAttributeIntValue(attributes, UbiItem.ATTRY), width: getAttributeIntValue(attributes, UbiItem.ATTRWIDTH), height: getAttributeIntValue(attributes, UbiItem.ATTRHEIGHT), foregroundid: getAttributeStringValue(attributes, UbiItem.ATTRFORECOLORID), backgroundid: getAttributeStringValue(attributes, UbiItem.ATTRBACKCOLORID), transparent: getAttributeBooleanValue(attributes, UbiItem.ATTRTRANSPARENT, true), iseditable: getAttributeBooleanValue(attributes, UbiItem.ATTRISEDITABLE, false), ispreview: getAttributeBooleanValue(attributes, UbiItem.ATTRISPREVIEW, true), isprint: getAttributeBooleanValue(attributes, UbiItem.ATTRISPRINT, true), linked: getAttributeBooleanValue(attributes, UbiItem.ATTRLINKED, false), linkfilename: getAttributeStringValue(attributes, UbiItem.ATTRLINKFILENAME, ""), linkargs: getAttributeStringValue(attributes, UbiItem.ATTRLINKARGS, ""), linkstyle: getAttributeStringValue(attributes, UbiItem.ATTRLINKSTYLE, "REPORT"), isvoiceye: getAttributeStringValue(attributes, UbiItem.ATTRISVOICEYE, false), voiceyetitle: getAttributeStringValue(attributes, UbiItem.ATTRVOICEYETITLE, "") }; }});var UbiTextItem=UbiItem.extend({ value: "", fontid: "", halign: 0, valign: 0, underlined: false, underlinecolor: null, strike: false, strikecolor: null, superscript: false, subscript: false, textdirection: true, textdirection2: 0, borderid: "", leftMargin: 0, rightMargin: 0, topMargin: 0, bottomMargin: 0, lineSpace: 0, lineHeight: 0, styleinfo: null, itemvalue: "", isspacevalue: false, htmlcodeproc: 0, iswordwrap: false, ischeckbox: false, checkflag: false, highlight: null, indent: 0, eformitem: null, divid: '', constructor: function() { this.base(UbiTextItem.CLASSNAME); }, getVAlign: function() { var str; if(this.valign == 0) { str="top"; }else if(this.valign == 1) { str="middle"; }else if(this.valign == 2) { str="bottom"; } return str; }, getHAlign: function() { var str; if(this.halign == 0) { str="left"; }else if(this.halign == 1) { str="center"; }else if(this.halign == 2) { str="right"; }else if(this.halign == 3) { str="justify"; }else if(this.halign == 4) { str="justify"; } return str; }, getStyleValue: function(ds) { var value=[]; var subvalue=""; if (this.styleinfo.styles != null && this.styleinfo.styles.GetSize() > 0) { var styleobj=null; var orgvalue=this.value; var styles=this.styleinfo.styles; var preindex=0; var startidx=0; var endidx=0; if (this.underlined) { value.push("<font style='text-decoration:underline;'>"); } for (var i=0; i<styles.GetSize(); i++) { styleobj=styles.GetAt(i); startidx=styleobj.startindex; endidx=styleobj.endindex+1; if (preindex < startidx) { subvalue=orgvalue.substring(preindex, startidx); subvalue=subvalue.replace('<', '&lt;').replace('>', '&gt;'); value.push(subvalue); } value.push("<font style='"); if (styleobj.fontname != "") value.push("font-family:" + styleobj.fontname + "; "); if (styleobj.fontsize != "") value.push("font-size:" + (styleobj.fontsize*ds) + "px; "); if (styleobj.fontcolor != "") value.push("color:#" + styleobj.fontcolor + "; "); if (styleobj.fontstyle != -1) { if (styleobj.fontstyle == 0) value.push("font-weight:normal; "); else if (styleobj.fontstyle == 1) value.push("font-weight:bold; "); else if (styleobj.fontstyle == 2) value.push("font-style:italic; "); else if (styleobj.fontstyle == 3) { value.push("font-weight:bold; font-style:italic; "); } } if (styleobj.underlined != this.underlined) { if (styleobj.underlined) { value.push("text-decoration:underline; "); } else { value.push("text-decoration:none; "); } } if (styleobj.highlight != "") { value.push("background-color:#" + styleobj.highlight + "; "); } if (styleobj.lineheight > 0) { value.push("line-height:" + (styleobj.lineheight*ds) + "px; "); } value.push("'>"); if (styleobj.superscript) { value.push("<sup>"); } if (styleobj.subscript) { value.push("<sub>"); } if (styleobj.strike != this.strike && styleobj.strike) { value.push("<strike>"); } subvalue=orgvalue.substring(startidx, endidx); subvalue=subvalue.replace('<', '&lt;').replace('>', '&gt;'); value.push(subvalue); if (styleobj.strike != this.strike && styleobj.strike) { value.push("</strike>"); } if (styleobj.superscript) { value.push("</sup>"); } if (styleobj.subscript) { value.push("</sub>"); } preindex=endidx; value.push("</font>"); } if (preindex < orgvalue.length) { subvalue=orgvalue.substring(preindex, orgvalue.length); subvalue=subvalue.replace('<', '&lt;').replace('>', '&gt;'); value.push(subvalue); } if (this.underlined) { value.push("</font>"); } } return value.join(""); }},{ CLASSNAME: "UbiTextItem", NODETEXT: "Text", ATTRFONTID: "fontid", ATTRHALIGN: "halign", ATTRVALIGN: "valign", ATTRUNDERLINED: "underlined", ATTRUNDERLINECOLOR: "underlinecolor", ATTRSTRIKE: "strike", ATTRSTRIKECOLOR: "strikecolor", ATTRSUPERSCRIPT: "superscript", ATTRSUBSCRIPT: "subscript", ATTRTEXTDIRECTION: "textdirection", ATTRTEXTDIRECTION2: "textdirection2", ATTRBORDERID: "border", ATTRMARGINLEFT: "marginleft", ATTRMARGINRIGHT: "marginright", ATTRMARGINTOP: "margintop", ATTRMARGINBOTTOM: "marginbottom", ATTRLINESPACE: "linespace", ATTRLINEHEIGHT: "lineheight", ATTRISSPACEVALUE: "isspc", ATTRHTMLCODEPROC: "htmlcodeproc", ATTRISWORDWRAP: "iswordwrap", ATTRISCHECKBOX: "ischeckbox", ATTRCHECKFLAG: "checkflag", ATTRTEXTHIGHLIGHT: "highlight", ATTRINDENT: "indent", NODEEFORM: "EForm", NODEITEMVALUE: "ItemValue", CreateInstance: function(node, doc){ var data=UbiTextItem.getData(node); var item=new UbiTextItem(); UbiItem.SetMemberFromNode(item, node); item.value=data.value; item.fontid=data.fontid; item.halign=data.halign; item.valign=data.valign; item.underlined=data.underlined; item.underlinecolor=data.underlinecolor; item.strike=data.strike; item.strikecolor=data.strikecolor; item.superscript=data.superscript; item.subscript=data.subscript; item.textdirection=data.textdirection; item.textdirection2=data.textdirection2; item.borderid=data.borderid; item.leftMargin=data.leftMargin; item.rightMargin=data.rightMargin; item.topMargin=data.topMargin; item.bottomMargin=data.bottomMargin; item.lineSpace=data.lineSpace; item.lineHeight=data.lineHeight; item.htmlcodeproc=data.htmlcodeproc; item.iswordwrap=data.iswordwrap; item.ischeckbox=data.ischeckbox; item.checkflag=data.checkflag; item.highlight=data.highlight; item.indent=data.indent; if (data.isspacevalue == true) { item.value=item.value.substring(1, item.value.length); } if (data.styleinfonode != null) { item.value=data.itemvalue; if (data.isspacevalue == true) { item.value=item.value.substring(1, item.value.length); } item.styleinfo=UbiTextStyleInfo.CreateInstance(data.styleinfonode, doc); } if (data.eformnode != null) { item.value=''; item.eformitem=UbiEformItem.CreateInstance(data.eformnode, doc); item.eformitem.value=item.value; item.eformitem.page=doc.currpagenum; doc.eformNodes.push(data.eformnode); doc.eformItems.push(item); } return item; }, getData: function(node) { var textnode=node.getElementsByTagName(UbiTextItem.NODETEXT)[0]; var textattributes=textnode.attributes; return { value: (textnode.childNodes[0]==null)?"":getNodeValue(textnode.childNodes[0]), fontid: getAttributeStringValue(textattributes, UbiTextItem.ATTRFONTID), halign: getAttributeIntValue(textattributes, UbiTextItem.ATTRHALIGN, 0), valign: getAttributeIntValue(textattributes, UbiTextItem.ATTRVALIGN, 1), underlined: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRUNDERLINED, false), underlinecolor: getAttributeStringValue(textattributes, UbiTextItem.ATTRUNDERLINECOLOR, null), strike: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRSTRIKE, false), strikecolor: getAttributeStringValue(textattributes, UbiTextItem.ATTRSTRIKECOLOR, null), superscript: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRSUPERSCRIPT, false), subscript: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRSUBSCRIPT, false), textdirection: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRTEXTDIRECTION, true), textdirection2: getAttributeIntValue(textattributes, UbiTextItem.ATTRTEXTDIRECTION2, 0), borderid: getAttributeStringValue(textattributes, UbiTextItem.ATTRBORDERID), leftMargin: getAttributeIntValue(textattributes, UbiTextItem.ATTRMARGINLEFT), rightMargin: getAttributeIntValue(textattributes, UbiTextItem.ATTRMARGINRIGHT), topMargin: getAttributeIntValue(textattributes, UbiTextItem.ATTRMARGINTOP), bottomMargin: getAttributeIntValue(textattributes, UbiTextItem.ATTRMARGINBOTTOM), lineSpace: getAttributeIntValue(textattributes, UbiTextItem.ATTRLINESPACE), lineHeight: getAttributeIntValue(textattributes, UbiTextItem.ATTRLINEHEIGHT), styleinfonode: node.getElementsByTagName(UbiTextStyleInfo.NODETEXTSTYLE)[0], isspacevalue: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRISSPACEVALUE), htmlcodeproc: getAttributeIntValue(textattributes, UbiTextItem.ATTRHTMLCODEPROC), iswordwrap: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRISWORDWRAP), ischeckbox: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRISCHECKBOX, false), checkflag: getAttributeBooleanValue(textattributes, UbiTextItem.ATTRCHECKFLAG, false), highlight: (textattributes.getNamedItem(UbiTextItem.ATTRTEXTHIGHLIGHT)==null)?null:getAttributeColorValue(textattributes, UbiTextItem.ATTRTEXTHIGHLIGHT, null), indent: getAttributeIntValue(textattributes, UbiTextItem.ATTRINDENT, 0), itemvalue: (textnode.getElementsByTagName(UbiTextItem.NODEITEMVALUE)[0]==null)?"":getNodeValue(textnode.getElementsByTagName(UbiTextItem.NODEITEMVALUE)[0].childNodes[0]), eformnode: node.getElementsByTagName(UbiTextItem.NODEEFORM)[0] }; }});var UbiShapeItem=UbiItem.extend({ lineid: "", constructor: function(classname) { this.base(classname); }},{ CLASSNAME: "UbiShapeItem", NODESHAPE: "Shape", ATTRLINEID: "lineid", SetMemberFromNode: function(item, node){ var data=UbiShapeItem.getData(node); item.lineid=data.lineid; }, getData: function(node) { var attributes=node.attributes; return { lineid: getAttributeStringValue(attributes, UbiShapeItem.ATTRLINEID) }; }});var UbiCircleItem=UbiShapeItem.extend({ constructor: function() { this.base(UbiCircleItem.CLASSNAME); }},{ CLASSNAME: "UbiCircleItem", CreateInstance: function(node, doc){ var item=new UbiCircleItem(); item.doc=doc; UbiItem.SetMemberFromNode(item, node); var shapenode=node.getElementsByTagName(UbiShapeItem.NODESHAPE)[0]; UbiShapeItem.SetMemberFromNode(item, shapenode); return item; }, getData: function(node) { }});var UbiLineItem=UbiShapeItem.extend({ linedir: 0, constructor: function() { this.base(UbiLineItem.CLASSNAME); }},{ CLASSNAME: "UbiLineItem", ATTRLINEDIR: "linedir", CreateInstance: function(node, doc){ var item=new UbiLineItem(); item.doc=doc; UbiItem.SetMemberFromNode(item, node); var shapenode=node.getElementsByTagName(UbiShapeItem.NODESHAPE)[0]; var data=UbiLineItem.getData(shapenode); UbiShapeItem.SetMemberFromNode(item, shapenode); item.linedir=data.linedir; return item; }, getData: function(node) { var attributes=node.attributes; return { linedir: getAttributeIntValue(attributes, UbiLineItem.ATTRLINEDIR) }; }});var UbiRectangleItem=UbiShapeItem.extend({ edgetype: 0, edgewidth: 0, constructor: function() { this.base(UbiRectangleItem.CLASSNAME); }},{ CLASSNAME: "UbiRectangleItem", ATTREDGETYPE: "edgetype", ATTREDGEWIDTH: "edgewidth", CreateInstance: function(node, doc){ var item=new UbiRectangleItem(); item.doc=doc; UbiItem.SetMemberFromNode(item, node); var shapenode=node.getElementsByTagName(UbiShapeItem.NODESHAPE)[0]; var data=UbiRectangleItem.getData(shapenode); UbiShapeItem.SetMemberFromNode(item, shapenode); item.edgetype=data.edgetype; item.edgewidth=data.edgewidth; return item; }, getData: function(node) { var attributes=node.attributes; return { edgetype: getAttributeIntValue(attributes, UbiRectangleItem.ATTREDGETYPE), edgewidth: getAttributeIntValue(attributes, UbiRectangleItem.ATTREDGEWIDTH) }; }});var UbiImageItem=UbiItem.extend({ imageid: "", halign: 0, valign: 0, borderid: "", constructor: function() { this.base(UbiImageItem.CLASSNAME); }, getVAlign: function() { var str; if(this.valign == 0) { str="top"; }else if(this.valign == 1) { str="middle"; }else if(this.valign == 2) { str="bottom"; } return str; }, getHAlign: function() { var str; if(this.halign == 0) { str="left"; }else if(this.halign == 1) { str="center"; }else if(this.halign == 2) { str="right"; } return str; }},{ CLASSNAME: "UbiImageItem", NODEIMAGE: "Image", ATTRIMAGEID: "imageid", ATTRHALIGN: "halign", ATTRVALIGN: "valign", ATTRBORDERID: "borderid", CreateInstance: function(node, doc){ var item=new UbiImageItem(); item.doc=doc; UbiItem.SetMemberFromNode(item, node); var imagenode=node.getElementsByTagName(UbiImageItem.NODEIMAGE)[0]; var data=UbiImageItem.getData(imagenode); item.imageid=data.imageid; item.halign=data.halign; item.valign=data.valign; item.borderid=data.borderid; return item; }, getData: function(node) { var attributes=node.attributes; return { imageid: getAttributeStringValue(attributes, UbiImageItem.ATTRIMAGEID), halign: getAttributeIntValue(attributes, UbiImageItem.ATTRHALIGN), valign: getAttributeIntValue(attributes, UbiImageItem.ATTRVALIGN), borderid: getAttributeStringValue(attributes, UbiImageItem.ATTRBORDERID) }; }});var UbiBarcodeItem=UbiItem.extend({ code: "", borderid: "", loadtype: 0, loadsrc: "", constructor: function() { this.base(UbiBarcodeItem.CLASSNAME);}},{ CLASSNAME: "UbiBarcodeItem", NODEBARCODE: "Barcode", ATTRBORDERID: "borderid", ATTRLOADTYPE: "loadtype", ATTRLOADSRC: "loadsrc", CreateInstance: function(node, doc){ var item=new UbiBarcodeItem(); UbiItem.SetMemberFromNode(item, node); var barcodenode=node.getElementsByTagName(UbiBarcodeItem.NODEBARCODE)[0]; var data=UbiBarcodeItem.getData(barcodenode); item.code=data.code; item.borderid=data.borderid; item.loadtype=data.loadtype; item.loadsrc=data.loadsrc; return item; }, getData: function(node) { var attributes=node.attributes; return { code: getNodeValue(node.childNodes[0]), borderid: getAttributeStringValue(attributes, UbiBarcodeItem.ATTRBORDERID), loadtype: getAttributeIntValue(attributes, UbiBarcodeItem.ATTRLOADTYPE), loadsrc: getAttributeStringValue(attributes, UbiBarcodeItem.ATTRLOADSRC) }; }});var UbiBarcodeItem=UbiItem.extend({ code: "", borderid: "", loadtype: 0, loadsrc: "", constructor: function() { this.base(UbiBarcodeItem.CLASSNAME);}},{ CLASSNAME: "UbiBarcodeItem", NODEBARCODE: "Barcode", ATTRBORDERID: "borderid", ATTRLOADTYPE: "loadtype", ATTRLOADSRC: "loadsrc", CreateInstance: function(node, doc){ var item=new UbiBarcodeItem(); UbiItem.SetMemberFromNode(item, node); var barcodenode=node.getElementsByTagName(UbiBarcodeItem.NODEBARCODE)[0]; var data=UbiBarcodeItem.getData(barcodenode); item.code=data.code; item.borderid=data.borderid; item.loadtype=data.loadtype; item.loadsrc=data.loadsrc; return item; }, getData: function(node) { var attributes=node.attributes; return { code: getNodeValue(node.childNodes[0]), borderid: getAttributeStringValue(attributes, UbiBarcodeItem.ATTRBORDERID), loadtype: getAttributeIntValue(attributes, UbiBarcodeItem.ATTRLOADTYPE), loadsrc: getAttributeStringValue(attributes, UbiBarcodeItem.ATTRLOADSRC) }; }});var UbiChartComponent=UbiObject.extend({ id: "", x: 0, y: 0, width: 0, height: 0, linked: false, linkfilename: "", linkargs: "", linkstyle: "", loadtype: 0, loadsrc: "", constructor: function() { this.base(UbiChartComponent.CLASSNAME); }},{ CLASSNAME: "UbiChartComponent", NODECHARTCOMPONENT: "Chartcomponent", ATTRID: "id", ATTRX: "x", ATTRY: "y", ATTRWIDTH: "width", ATTRHEIGHT: "height", ATTRLINKED: "linked", ATTRLINKFILENAME: "linkfilename", ATTRLINKSTYLE: "linkstyle", NODELINKARG: "Linkarg", ATTRNAME: "name", ATTRLOADTYPE: "loadtype", ATTRLOADSRC: "loadsrc", CreateInstance: function(node, doc){ var data=UbiChartComponent.getData(node); var charcomponent=new UbiChartComponent(); charcomponent.id=data.id; charcomponent.x=data.x; charcomponent.y=data.y; charcomponent.width=data.width; charcomponent.height=data.height; charcomponent.linked=data.linked; charcomponent.linkfilename=data.linkfilename; charcomponent.loadtype=data.loadtype; charcomponent.loadsrc=data.loadsrc; return charcomponent; }, getData: function(node) { var attributes=node.attributes; return { id: getAttributeStringValue(attributes, UbiChartComponent.ATTRID), x: getAttributeIntValue(attributes, UbiChartComponent.ATTRX), y: getAttributeIntValue(attributes, UbiChartComponent.ATTRY), width: getAttributeIntValue(attributes, UbiChartComponent.ATTRWIDTH), height: getAttributeIntValue(attributes, UbiChartComponent.ATTRHEIGHT), linked: getAttributeBooleanValue(attributes, UbiChartComponent.ATTRLINKED), linkfilename: getAttributeStringValue(attributes, UbiChartComponent.ATTRLINKFILENAME), linkstyle: getAttributeStringValue(attributes, UbiChartComponent.ATTRLINKSTYLE), loadtype: getAttributeIntValue(attributes, UbiChartComponent.ATTRLOADTYPE), loadsrc: getAttributeStringValue(attributes, UbiChartComponent.ATTRLOADSRC) }; }});var UbiPage=UbiObject.extend({ constructor: function(doc) { this.base(UbiPage.CLASSNAME); this.doc=doc; this.items=new UbiList(); this.chartcomponents=new UbiList(); this.contents=""; this.iscustom=false; this.width=0; this.height=0; this.left=0; this.top=0; this.right=0; this.bottom=0; this.bgcolor=""; }},{ CLASSNAME: "UbiPage", NODEPAGE: "Page", ATTRPAGENUM: "pagenum", ATTRPAGEWIDTH: "width", ATTRPAGEHEIGHT: "height", ATTRPAGEMARGINTOP: "y", ATTRPAGEMARGINLEFT: "x", ATTRBACKGROUNDCOLOR: "bgcolor", NODEFONTID: "Fontid", NODELINEID: "Lineid", NODECOLORID: "Colorid", NODEBORDERID: "Borderid", NODEOBJECTID: "Objectid", CreateInstance: function(node, doc){ var data=UbiPage.getData(node); var page=new UbiPage(doc); var itemlist=data.itemlist; for(var i=0; i<itemlist.length; i++) { var childnode=itemlist[i]; page.items.Add(UbiItem.CreateInstance(childnode, doc)); } var chartcomponentlist=data.chartcomponentlist; for(var i=0; i<chartcomponentlist.length; i++) { var childnode=chartcomponentlist[i]; page.chartcomponents.Add(UbiChartComponent.CreateInstance(childnode, doc)); } page.width=data.width; page.height=data.height; page.top=data.top; page.bottom=data.height - data.top; page.left=data.left; page.right=data.width - data.left; page.bgcolor=data.bgcolor; return page; }, getData: function(node) { var attributes=node.attributes; return { width: getAttributeIntValue(attributes, UbiPage.ATTRPAGEWIDTH), height: getAttributeIntValue(attributes, UbiPage.ATTRPAGEHEIGHT), top: getAttributeIntValue(attributes, UbiPage.ATTRPAGEMARGINTOP), left: getAttributeIntValue(attributes, UbiPage.ATTRPAGEMARGINLEFT), bgcolor : getAttributeStringValue(attributes, UbiPage.ATTRBACKGROUNDCOLOR), itemlist: node.getElementsByTagName(UbiItem.NODEITEM), chartcomponentlist: node.getElementsByTagName(UbiChartComponent.NODECHARTCOMPONENT) }; }});var UbiDoc=UbiObject.extend({ version: "", pagecount: 0, serviceid: "", isEnableNoPage: false, isWA: false, totalpageNodes: [], totalpageItems: [], eformNodes: [], eformItems: [], currpagenum: 0, constructor: function() { this.base(UbiDoc.CLASSNAME); this.docprop; this.pages=new UbiList(); this.fonts=new UbiMap(); this.lines=new UbiMap(); this.colors=new UbiMap(); this.borders=new UbiMap(); this.objects=new UbiMap(); }},{ CLASSNAME: "UbiDoc", NODEDOC: "Doc", ATTRVERSION: "version", ATTRPAGECOUNT: "pagecount", ATTRSERVICEID: "serviceid", ATTRENABLENOPAGE: "enableNoPage", CreateInstance: function(node, flag) { var docnode=node.getElementsByTagName(UbiDoc.NODEDOC)[0]; var data=UbiDoc.getData(docnode); var doc=new UbiDoc(); if (flag) { doc.version=data.version; doc.pagecount=data.pagecount; doc.serviceid=data.serviceid; doc.isEnableNoPage=data.enableNoPage; doc.docprop=UbiDocProperty.CreateInstance(docnode); } var fontlist=data.fontlist; for(var i=0; i<fontlist.length; i++) { var fontnode=fontlist[i]; var fontobj=UbiFontObject.CreateInstance(fontnode); doc.fonts.SetAt(fontobj.id, fontobj); } var linelist=data.linelist; for(var i=0; i<linelist.length; i++) { var linenode=linelist[i]; var lineobj=UbiLineObject.CreateInstance(linenode); doc.lines.SetAt(lineobj.id, lineobj); } var colorlist=data.colorlist; for(var i=0; i<colorlist.length; i++) { var colornode=colorlist[i]; var colorobj=UbiColorObject.CreateInstance(colornode); doc.colors.SetAt(colorobj.id, colorobj); } var borderlist=data.borderlist; for(var i=0; i<borderlist.length; i++) { var bordernode=borderlist[i]; var borderobj=UbiBorderObject.CreateInstance(bordernode); doc.borders.SetAt(borderobj.id, borderobj); } var imagelist=data.imagelist; for(var i=0; i<imagelist.length; i++) { var imagenode=imagelist[i]; var imageobj=UbiImageObject.CreateInstance(imagenode); doc.objects.SetAt(imageobj.id, imageobj); } var pagelist=data.pagelist; for(var i=0; i<pagelist.length; i++) { var pagenode=pagelist[i]; doc.currpagenum=i+1; var page=UbiPage.CreateInstance(pagenode, doc); doc.pages.Add(page); } doc.currpagenum=1; return doc; }, getData: function(docnode) { var docattributes=docnode.attributes; return { version: getAttributeStringValue(docattributes, UbiDoc.ATTRVERSION), pagecount: getAttributeIntValue(docattributes, UbiDoc.ATTRPAGECOUNT), serviceid: getAttributeStringValue(docattributes, UbiDoc.ATTRSERVICEID), enableNoPage: getAttributeStringValue(docattributes, UbiDoc.ATTRENABLENOPAGE), fontlist: docnode.getElementsByTagName(UbiFontObject.NODEFONTOBJ), linelist: docnode.getElementsByTagName(UbiLineObject.NODELINEOBJ), colorlist: docnode.getElementsByTagName(UbiColorObject.NODECOLOROBJ), borderlist: docnode.getElementsByTagName(UbiBorderObject.NODEBORDEROBJ), imagelist: docnode.getElementsByTagName(UbiImageObject.NODEIMAGEOBJ), pagelist: docnode.getElementsByTagName(UbiPage.NODEPAGE) }; }});var UbiEformItem=UbiItem.extend({ name: "", type: 0, required: false, readonly: false, guidestring: "", description: "", codecolumns: [], datacolumns: [], value: "", page: 0, constructor: function(classname) { this.base(classname); }},{ CLASSNAME: "UbiEFormItem", NODEEFORM: "EForm", ATTRNAME: "name", ATTRTYPE: "type", ATTRREQUIRED: "required", ATTRREADONLY: "readonly", ATTRCODECOLUMN: "codecolumn", ATTRDATACOLUMN: "datacolumn", ATTRGUIDESTRING: "guidestring", ATTRDESCRIPTION: "description", TYPETEXT: 0, TYPERADIOBOX: 1, TYPECHECKBOX: 2, TYPECOMBOBOX: 3, TYPELIST: 4, TYPESIGNATURE: 5, CreateInstance: function(node, doc){ var data=UbiEformItem.getData(node); var item=new UbiEformItem(); item.name=data.name; item.type=data.type; item.required=data.required; item.readonly=data.readonly; item.guidestring=data.guidestring; item.description=data.description; return item; }, getData: function(node) { var attributes=node.attributes; return { name: getAttributeStringValue(attributes, UbiEformItem.ATTRLINENAME), type: getAttributeIntValue(attributes, UbiEformItem.ATTRLINETYPE), required: getAttributeBooleanValue(attributes, UbiEformItem.ATTRLINEREQUIRED), readonly: getAttributeBooleanValue(attributes, UbiEformItem.ATTRLINEREADONLY), guidestring: getAttributeStringValue(attributes, UbiEformItem.ATTRLINEGUIDESTRING), description: getAttributeStringValue(attributes, UbiEformItem.ATTRLINEDESCRIPTION) }; }});var _ubi_cindex=0;var _ubi_iindex=0;var _ubi_imgcount=0;var _ubi_print_imgcount=0;var __ubi_NS_SVG="http://www.w3.org/2000/svg";var __ubi_NS_XLINK="http://www.w3.org/1999/xlink";var UbiDocument=Base.extend({ jrffile : "", key : "", resid: "", keyurl : "", zindex : 0, vid:0, exportseq:"", canvaslist: new Array(), constructor: function(doc, vid, jrffile, key, resid, keyurl, exportseq) { this.jrffile=jrffile; this.doc=doc; this.key=key; this.resid=resid; this.keyurl=keyurl; this.zindex=0; this.vid=vid; this.exportseq=exportseq; }, GetReportStyle: function(doc, cssid, ds) { var cssStr=[]; for (var i=0; i<doc.fonts.GetCount(); i++) { key=doc.fonts.GetKey(i); value=doc.fonts.GetValue(i); cssStr.push("."+cssid+"font_"+ key +" {font: "+ value.getFont(ds) +"; }\n"); } for (var i=0; i<doc.colors.GetCount(); i++) { key=doc.colors.GetKey(i); value=doc.colors.GetValue(i); cssStr.push("."+cssid+"color_f_"+ key +" {color: #"+ value.color +"; }\n"); cssStr.push("."+cssid+"color_b_"+ key +" {background-color: #"+ value.color +"; }\n"); } cssStr.push(".UbiAjaxViewerrotate_90 {-webkit-transform: rotate(90deg); -moz-transform: rotate(90deg); -o-transform: rotate(90deg); -ms-transform: rotate(90deg); }\n"); cssStr.push(".UbiAjaxViewerrotate_180 {-webkit-transform: rotate(180deg); -moz-transform: rotate(180deg); -o-transform: rotate(180deg); -ms-transform: rotate(180deg); }\n"); cssStr.push(".UbiAjaxViewerrotate_270 {-webkit-transform: rotate(270deg); -moz-transform: rotate(270deg); -o-transform: rotate(270deg); -ms-transform: rotate(270deg) }\n"); cssStr.push(".UbiAjaxViewervertical { -ms-writing-mode: tb-rl; -webkit-writing-mode: vertical-rl; -moz-writing-mode: vertical-rl; -ms-writing-mode: vertical-rl; writing-mode: vertical-rl }"); cssStr.push(".UbiAjaxViewervertical_lr { -ms-writing-mode: tb-lr; -webkit-writing-mode: vertical-lr; -moz-writing-mode: vertical-lr; -ms-writing-mode: vertical-lr; writing-mode: vertical-lr }"); return cssStr.join(""); }, Draw: function(divid, pagenum, ds, isprint) { if( typeof ds == "undefined" ) ds=1.0; if( typeof isprint == "undefined" ) isprint=false; if( pagenum > this.doc.pages.GetSize() || pagenum <= 0 ) { alert( pagenum + "번째 페이지는 존재하지 않습니다."); return; } var page=this.doc.pages.GetAt(pagenum - 1); var urlstr=this.keyurl + "?jrffile=" + encodeURI(encodeURIComponent(this.jrffile)) + "&key=" + this.key + "&resid=" + this.resid + "&exportseq=" + this.exportseq; var isPrint=isprint; var textitems=null; var drawcanvaslist=this.canvaslist; var cssid=divid.id; var cssStr=this.GetReportStyle(this.doc, cssid, ds); DrawPage(divid, this.doc, page, urlstr, ds, this.vid); function DrawPage(divid, doc, page, keyurl, ds, vid) { if (page.iscustom) { divid.innerHTML=page.contents; return; } var styleNode=document.createElement("style"); styleNode.setAttribute("type", "text/css"); if (__ubi_isIE && __ubi_ieVersion < 11) { styleNode.styleSheet.cssText=cssStr; } else { try{ styleNode.innerHTML=cssStr; }catch(e){ styleNode.innerText=cssStr; } } divid.appendChild(styleNode); _ubi_cindex=0; _ubi_iindex=0; textitems=new Array(); var items=page.items; for( var i=0; i < items.GetSize(); i++ ) { var item=items.GetAt(i); if (item) { if( item.GetClassname() == UbiTextItem.CLASSNAME ) DrawTextItem(divid, doc, item, ds, cssid, pagenum, i); else if (item.GetClassname() == UbiLineItem.CLASSNAME) DrawLineItem(divid, doc, item, ds, pagenum); else if (item.GetClassname() == UbiRectangleItem.CLASSNAME) DrawRectangleItem(divid, doc, item, ds, pagenum); else if (item.GetClassname() == UbiCircleItem.CLASSNAME) DrawCircleItem(divid, doc, item, ds, pagenum); else if( item.GetClassname() == UbiBarcodeItem.CLASSNAME ) DrawBarcodeItem(divid, doc, item, keyurl, ds); else if( item.GetClassname() == UbiImageItem.CLASSNAME ) DrawImageItem(divid, doc, item, keyurl, ds, cssid); } } var charts=page.chartcomponents; for( var i=0; i < charts.GetSize(); i++ ) { var chart=charts.GetAt(i); DrawChartComponent(divid, doc, chart, keyurl, ds); } if (doc.isWA) { textitems.sort(sortNumber); var nodes=divid.childNodes; var tabindex=12; var width=parseInt(doc.docprop.width); tabindex=(1000)*pagenum; var textObj=null; for( var i=0; i < nodes.length; i++ ) { if( nodes[i].nodeName == "DIV" ) { var x=parseInt(nodes[i].style.left); var y=parseInt(nodes[i].style.top); var key=x + y * width; var index=findIndex(key); if( index >= 0 ) { textObj=document.getElementById(nodes[i].id +"_td"); if (textObj) { var textDivid=nodes[i].id; textObj.setAttribute("onfocus", "_ubi_wafoucus('"+ textDivid +"')"); textObj.setAttribute("onblur", "_ubi_wablur('"+ textDivid +"')"); textObj.tabIndex=tabindex + index; } } } } } function findIndex(value) { for( var i=0; i < textitems.length; i++ ) { if( value == textitems[i] ) return i; } return -1; } function sortNumber(a, b) { return a-b; } }; function DrawTextItem(divid, doc, item, ds, vid, page, seq) { if( item.width == 0 || item.height == 0 ) return; if ( item.ispreview == false ) return; var div=document.createElement("div"); div.id=vid + "_"+ item.id +"_"+page +"_"+seq; div.className="textitem "+ vid + "font_"+ item.fontid +" "+ vid + "color_f_"+ item.foregroundid + ( item.transparent ?"": " "+ vid + "color_b_"+item.backgroundid); item.divid=div.id; var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var leftMargin=Math.round(item.leftMargin * ds); var rightMargin=Math.round(item.rightMargin * ds); var topMargin=Math.round(item.topMargin * ds); var bottomMargin=Math.round(item.bottomMargin * ds); textitems.push(parseInt(x)+(parseInt(y)*parseInt(doc.docprop.width))); var divWidth=(width + 1) - (getBorderWidth("left", doc, item) + getBorderWidth("right", doc, item)); var divHeight=(height + 1) - (getBorderWidth("top", doc, item) + getBorderWidth("bottom", doc, item)); var indent=Math.round(item.indent * ds); if (item.indent < 0) { divWidth -= indent; x += indent; } div.style.left=x + "px"; div.style.top=y + "px"; div.style.width=divWidth + "px"; div.style.height=divHeight + "px"; var borderwidth=0; borderwidth=getBorderWidth("top", doc, item); if (borderwidth > 0) div.style.borderTop=borderwidth + "px " + getBorderStyle("top", doc, item) + " #" + getBorderColor("top", doc, item); borderwidth=getBorderWidth("right", doc, item); if (borderwidth > 0) div.style.borderRight=borderwidth + "px " + getBorderStyle("right", doc, item) + " #" + getBorderColor("right", doc, item); borderwidth=getBorderWidth("bottom", doc, item); if (borderwidth > 0) div.style.borderBottom=getBorderWidth("bottom", doc, item) + "px " + getBorderStyle("bottom", doc, item) + " #" + getBorderColor("bottom", doc, item); borderwidth=getBorderWidth("left", doc, item); if (borderwidth > 0) div.style.borderLeft=getBorderWidth("left", doc, item) + "px " + getBorderStyle("left", doc, item) + " #" + getBorderColor("left", doc, item); var ddwidth=getBorderWidth("dd", doc, item); var duwidth=getBorderWidth("du", doc, item); var diagonalArray=[]; if (ddwidth > 0 || duwidth > 0) { diagonalArray.push('<div style="position:absolute; left:0px; top:0px; '); diagonalArray.push('width:'+ divWidth +'px; '); diagonalArray.push('height:'+ divHeight +'px; '); diagonalArray.push('\">'); diagonalArray.push('<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style="position:absolute; left:0px; top:0px; '); diagonalArray.push('width:'+ divWidth +'px; '); diagonalArray.push('height:'+ divHeight +'px; '); diagonalArray.push('\">'); } if (ddwidth > 0) { diagonalArray.push('<line '); diagonalArray.push('x1="'+0+'" '); diagonalArray.push('y1="'+0+'" '); diagonalArray.push('x2="'+divWidth+'" '); diagonalArray.push('y2="'+divHeight+'" '); diagonalArray.push('stroke="'+"#"+getBorderColor("dd", doc, item)+'" '); diagonalArray.push('stroke-width="'+ddwidth+'" '); diagonalArray.push('/>'); } if (duwidth > 0) { diagonalArray.push('<line '); diagonalArray.push('x1="'+0+'" '); diagonalArray.push('y1="'+divHeight+'" '); diagonalArray.push('x2="'+divWidth+'" '); diagonalArray.push('y2="'+0+'" '); diagonalArray.push('stroke="'+"#"+getBorderColor("du", doc, item)+'" '); diagonalArray.push('stroke-width="'+duwidth+'" '); diagonalArray.push('/>'); } if (ddwidth > 0 || duwidth > 0) { diagonalArray.push('</svg></div>'); div.innerHTML=diagonalArray.join(""); } if(div.style.font.indexOf("bold") != -1 ) { div.style.letterSpacing= "-1"; } var table=document.createElement("table"); var tbody=document.createElement("tbody"); var tr=document.createElement("tr"); var td=document.createElement("td"); if (item.ischeckbox) { var checkboxWidth=parseInt(10*ds); var tdCheck=document.createElement("td"); tdCheck.style.width=checkboxWidth + "px"; tdCheck.innerHTML="<input type='checkbox' "+ (item.checkflag==true?"checked":"") +" onclick='return(false)' style='position:relative;margin:0px; width:"+checkboxWidth+"px; height:"+checkboxWidth+"px;'>"; tr.appendChild(tdCheck); } var tableHeight=0; var tableWidth=0; if (item.textdirection2 == 2 || item.textdirection2 == 4) { tableWidth=(divHeight - (topMargin + bottomMargin)); tableHeight=(divWidth - (leftMargin + rightMargin)); } else { tableWidth=(divWidth - (leftMargin + rightMargin)); tableHeight=(divHeight - (topMargin + bottomMargin)); } table.style.width=tableWidth + "px"; table.style.height=tableHeight + "px"; var tclassname=vid + "font_"+ item.fontid +" "+ vid + "color_f_"+ item.foregroundid; if (item.textdirection2 == 1) { tclassname += " UbiAjaxViewervertical"; } else if (item.textdirection2 == 2) { tclassname += " UbiAjaxViewerrotate_90"; var halfwidth=(divWidth - (leftMargin + rightMargin)-2) / 2; table.style.msTransformOrigin=halfwidth + "px " + halfwidth + "px"; table.style.WebkitTransformOrigin=halfwidth + "px " + halfwidth + "px"; table.style.MozTransformOrigin=halfwidth + "px " + halfwidth + "px"; } else if (item.textdirection2 == 3) { tclassname += " UbiAjaxViewerrotate_180"; } else if (item.textdirection2 == 4) { tclassname += " UbiAjaxViewerrotate_270"; var halfheight=(divHeight - (topMargin + bottomMargin)) / 2; table.style.msTransformOrigin=halfheight + "px " + halfheight + "px"; table.style.WebkitTransformOrigin=halfheight + "px " + halfheight + "px"; table.style.MozTransformOrigin=halfheight + "px " + halfheight + "px"; } table.className=tclassname; table.style.borderSpacing="0px"; var marginTop=0; if ( (leftMargin + rightMargin + topMargin + bottomMargin) > 0) { table.style.marginLeft=(1+leftMargin) +"px"; table.style.marginRight=rightMargin +"px"; marginTop=(1+topMargin); table.style.marginTop=(1+topMargin) +"px"; table.style.marginBottom=bottomMargin +"px"; } if (item.lineSpace > 0) { var gap=Math.floor(item.lineSpace*ds/2); table.style.marginTop=(marginTop - gap + 1)+ "px"; table.style.height=(tableHeight + Math.round(item.lineSpace*ds)) + "px"; } if (doc.docprop.language == "Arabic") tr.dir="rtl"; td.className=vid + "font_"+ item.fontid +" "+ vid + "color_f_"+ item.foregroundid; td.id=div.id +"_td"; if (item.iswordwrap == true) { td.style.wordBreak="keep-all"; } if (item.textdirection2 == 2) { if (item.halign == 0) td.style.verticalAlign="bottom"; else if (item.halign == 2) td.style.verticalAlign="top"; if (item.valign == 0) td.style.textAlign="left"; else if (item.valign == 2) td.style.textAlign="right"; } else if (item.textdirection2 == 3) { if (item.halign == 0) td.style.textAlign="right"; else if (item.halign == 2) td.style.textAlign="left"; if (item.valign == 0) td.style.verticalAlign="bottom"; else if (item.valign == 2) td.style.verticalAlign="top"; } else if (item.textdirection2 == 4) { if (item.halign == 0) td.style.verticalAlign="top"; else if (item.halign == 2) td.style.verticalAlign="bottom"; if (item.valign == 0) td.style.textAlign="right"; else if (item.valign == 2) td.style.textAlign="left"; } else if (item.textdirection2 == 1) { if (item.valign == 0) td.style.textAlign="left"; else if (item.valign == 2) td.style.textAlign="right"; } else { if (item.halign != 1) { td.style.textAlign=item.getHAlign(); if (td.style.textAlign == "justify") { td.style.whiteSpace="pre-line"; } } if (item.valign != 1) td.style.verticalAlign=item.getVAlign(); } if (item.ischeckbox) { td.style.width="*"; } else { td.style.width=table.style.width; } td.style.height=table.style.height; var lineHeight=(getFontSize(doc, item, ds) + Math.round(item.lineSpace*ds)); if (item.lineHeight > 0) { var height=Math.round((item.lineHeight + item.lineSpace)*ds); if (lineHeight < height) { lineHeight=height; } } td.style.lineHeight=lineHeight + "px"; if (indent != 0) { if (indent < 0) { td.style.paddingLeft=(-indent) + "px"; td.style.textIndent=indent +"px"; } else { td.style.textIndent=indent + "px"; } } var underIE8StyleStart=[]; var underIE8StyleEnd=[]; if (__ubi_isIE && __ubi_ieVersion < 8) { if (item.superscript) { underIE8StyleStart.push("<sup>"); } if (item.subscript) { underIE8StyleStart.push("<sub>"); } var changedColor=false; var addSpan=false; var addSpanCount=0; if (item.highlight != null) { addSpan=true; addSpanCount++; underIE8StyleStart.push("<span style=\"background-color:#"+ item.highlight +";"); } if( item.underlined ) { if (addSpan) { underIE8StyleStart.push("text-decoration:underline;"); } else { addSpan=true; addSpanCount++; underIE8StyleStart.push("<span style=\"text-decoration:underline;"); } if (item.underlinecolor && item.underlinecolor != '') { changedColor=true; underIE8StyleStart.push("color:#"+ item.underlinecolor +";"); } } if (addSpan) { underIE8StyleStart.push("\">"); } if (item.strike) { addSpanCount++; underIE8StyleStart.push("<span style=\"text-decoration:line-through;"); if (item.strikecolor && item.strikecolor != '') { changedColor=true; underIE8StyleStart.push("color:#"+ item.strikecolor +";"); } underIE8StyleStart.push("\">"); } if (addSpanCount > 0) { underIE8StyleStart.push("<span"); if (changedColor) { underIE8StyleStart.push(" style='color:#"+ getForegroundColor(doc,item) +"'"); } underIE8StyleStart.push(">"); for (var i=0; i<addSpanCount; i++) { underIE8StyleEnd.push("</span>"); } underIE8StyleEnd.push("</span>"); } if (item.subscript) { underIE8StyleStart.push("</sub>"); } if (item.superscript) { underIE8StyleStart.push("</sup>"); } } if (item.linked) { var alink=document.createElement("a"); if (__ubi_viewers[vid] && __ubi_viewers[vid].events.linkButtonDown) { alink.style.textDecoration='underline'; alink.style.color='#0000cc'; alink.onmouseover=function() { this.style.cursor="pointer";}; alink.onmouseout=function() { this.style.cursor="default";}; alink.onclick=function() {__ubi_viewers[vid]._linkButtonDown(item.linkfilename, item.linkargs); }; } else { if (item.linkstyle == "SCRIPT") { alink.href="javascript:"+item.linkfilename; } else if (item.linkstyle == "REPORT"){ alink.href="javascript:refreshFrame('"+ divid.parentNode.parentNode.parentNode.id +"','"+ item.linkfilename +"','"+ item.linkargs +"')"; } else if (item.linkstyle == "WEBPAGE"){ var url=item.linkfilename; if (item.linkfilename.indexOf(":/"+"/") == -1 && item.linkfilename.indexOf("mailto:") == -1) { url="http:/"+"/"+ item.linkfilename; } alink.href="javascript:window.open(\""+ url + item.linkargs +"\"); void 0;"; } } var textnode=document.createTextNode(item.value); alink.appendChild(textnode); if (item.value.indexOf("^totalpage^") >= 0) { doc.totalpageNodes.push(textnode); doc.totalpageItems.push(item); } td.appendChild(alink); } else { if (item.styleinfo != null && item.styleinfo.styles != null && item.styleinfo.styles.GetSize() > 0) { if (__ubi_isIE && __ubi_ieVersion < 8) { td.innerHTML="<pre style=\"margin:0px; font:"+ getFont(doc, item, ds) +"; line-height:"+lineHeight+"px;\">"+ item.getStyleValue(ds) +"</pre>"; } else { td.innerHTML=item.getStyleValue(ds); } } else { if (__ubi_isIE && __ubi_ieVersion < 8) { td.innerHTML="<pre style=\"margin:0px; font:"+ getFont(doc, item, ds) +"; line-height:"+lineHeight+"px;\">"+ underIE8StyleStart.join('') + item.value + underIE8StyleEnd.join('') + "</pre>"; } else { if(item.htmlcodeproc=='1'){ td.innerHTML=item.value; }else{ var changedColor=false; var addSpan=false; var spanobj=null; var lastobj=null; if (item.highlight != null) { addSpan=true; spanobj=document.createElement("span"); spanobj.style.backgroundColor="#" + item.highlight; lastobj=spanobj; } if( item.underlined ) { if (addSpan) { spanobj.style.textDecoration="underline"; } else { addSpan=true; spanobj=document.createElement("span"); spanobj.style.textDecoration="underline"; lastobj=spanobj; } if (item.underlinecolor && item.underlinecolor != '') { changedColor=true; spanobj.style.color="#"+ item.underlinecolor; } } if (item.strike) { var strikespanobj=null; if (item.underlined) { strikespanobj=document.createElement("span"); spanobj.appendChild(strikespanobj); lastobj=strikespanobj; } else { if (addSpan) { strikespanobj=spanobj; } else { strikespanobj=document.createElement("span"); spanobj=strikespanobj; lastobj=strikespanobj; } } strikespanobj.style.textDecoration="line-through"; if (item.strikecolor && item.strikecolor != '') { changedColor=true; strikespanobj.style.color="#"+ item.strikecolor; } } if (changedColor) { var textspanobj=document.createElement("span"); textspanobj.style.color="#"+ getForegroundColor(doc,item); lastobj.appendChild(textspanobj); lastobj=textspanobj; } if (item.superscript) { var supobj=document.createElement("sup"); if (lastobj) { lastobj.appendChild(supobj); } lastobj=supobj; } if (item.subscript) { var subobj=document.createElement("sub"); if (lastobj) { lastobj.appendChild(subobj); } lastobj=subobj; } var textnode=document.createTextNode(item.value); if (lastobj) { lastobj.appendChild(textnode); if (spanobj) { td.appendChild(spanobj); } else { td.appendChild(lastobj); } } else { td.appendChild(textnode); } if (item.value.indexOf("^totalpage^") >= 0) { doc.totalpageNodes.push(textnode); doc.totalpageItems.push(item); } } } } } tr.appendChild(td); tbody.appendChild(tr); table.appendChild(tbody); div.appendChild(table); divid.appendChild(div); }; function DrawLineItem(divid, doc, item, ds, page) { if ( item.ispreview == false ) return; var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; if( width == 0 || height == 0 ) { var div=document.createElement("div"); div.id=item.id + "_" + page; divid.appendChild(div); div.style.position="absolute"; div.style.top=y + "px"; div.style.left=x + "px"; div.style.width=((width == 0)?getLineThickness(doc, item):(width + 1)) + "px"; div.style.height=((height == 0)?getLineThickness(doc, item):(height + 1)) + "px"; if( __ubi_isIE && __ubi_ieVersion == 6 ) { div.style.lineHeight='0px'; div.style.fontSize='0px'; } if( (__ubi_isIE && __ubi_ieVersion == 6) && parseInt(div.style.height) == 1 ) { div.style.border="0px"; div.style.borderTop="1px solid #" + getLineColor(doc, item); } else { div.style.backgroundColor="#" + getLineColor(doc, item); } } else { var canvas=document.createElement("canvas"); canvas.id=item.id + (_ubi_cindex++)+ "cv"; divid.appendChild(canvas); if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas); canvas.style.position="absolute"; canvas.style.left=x + "px"; canvas.style.top=y + "px"; canvas.width=width + 1; canvas.height=height + 1; var ctx=canvas.getContext("2d"); ctx.save(); ctx.lineWidth=getLineThickness(doc, item); ctx.strokeStyle="#" + getLineColor(doc, item); ctx.beginPath(); if( item.linedir == 1 ) { ctx.moveTo(0, canvas.height); ctx.lineTo(canvas.width, 0); } else { ctx.moveTo(0, 0); ctx.lineTo(canvas.width, canvas.height); } ctx.closePath(); ctx.stroke(); ctx.restore(); } }; function DrawRectangleItem(divid, doc, item, ds, page) { if( item.width == 0 && item.height == 0 ) return; if ( item.ispreview == false ) return; var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var canvas=document.createElement("canvas"); canvas.id=item.id + (_ubi_cindex++) + "_" + page + "_" + "cv"; divid.appendChild(canvas); if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas); canvas.style.position="absolute"; canvas.style.left=x + "px"; canvas.style.top=y + "px"; canvas.width=width + 1; canvas.height=height + 1; if (isPrint) { var canvasobj=new UbiCanvasObject(); if( item.edgetype == 1 ) { canvasobj.type="ROUNDRECT"; canvasobj.radius=item.edgewidth; } else { canvasobj.type="RECT"; } canvasobj.canvasid=canvas.id; canvasobj.linewidth=getLineThickness(doc, item); canvasobj.strokestyle="#" + getLineColor(doc, item); if( !item.transparent ) { canvasobj.fillstyle="#" + getBackgroundColor(doc, item); } drawcanvaslist[drawcanvaslist.length]=canvasobj; } else { var ctx=canvas.getContext("2d"); ctx.save(); ctx.lineWidth=getLineThickness(doc, item); ctx.strokeStyle="#" + getLineColor(doc, item); ctx.beginPath(); if( item.edgetype == 1 ) { roundedRect(ctx, ctx.lineWidth / 2, ctx.lineWidth / 2, canvas.width - ctx.lineWidth, canvas.height - ctx.lineWidth, item.edgewidth); } else { ctx.rect(ctx.lineWidth / 2, ctx.lineWidth / 2, canvas.width - ctx.lineWidth, canvas.height - ctx.lineWidth); } ctx.closePath(); if( !item.transparent ) { ctx.fillStyle="#" + getBackgroundColor(doc, item); ctx.fill(); } ctx.stroke(); ctx.restore(); } }; function roundedRect(ctx, x, y, width, height, radius){ ctx.beginPath(); ctx.moveTo(x,y+radius); ctx.lineTo(x,y+height-radius); ctx.quadraticCurveTo(x,y+height,x+radius,y+height); ctx.lineTo(x+width-radius,y+height); ctx.quadraticCurveTo(x+width,y+height,x+width,y+height-radius); ctx.lineTo(x+width,y+radius); ctx.quadraticCurveTo(x+width,y,x+width-radius,y); ctx.lineTo(x+radius,y); ctx.quadraticCurveTo(x,y,x,y+radius); }; function DrawCircleItem(divid, doc, item, ds, page) { if( item.width == 0 && item.height == 0 ) return; if ( item.ispreview == false ) return; var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var canvas=document.createElement("canvas"); canvas.id=item.id + (_ubi_cindex++) + "_" + page + "_" + "cv"; divid.appendChild(canvas); if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas); canvas.style.position="absolute"; canvas.style.left=x + "px"; canvas.style.top=y + "px"; canvas.width=width + 1; canvas.height=height + 1; if (isPrint) { var canvasobj=new UbiCanvasObject(); canvasobj.type="CIRCLE"; canvasobj.canvasid=canvas.id; canvasobj.linewidth=getLineThickness(doc, item); canvasobj.strokestyle="#" + getLineColor(doc, item); if( !item.transparent ) { canvasobj.fillstyle="#" + getBackgroundColor(doc, item); } drawcanvaslist[drawcanvaslist.length]=canvasobj; } else { var ctx=canvas.getContext("2d"); ctx.save(); ctx.lineWidth=getLineThickness(doc, item); ctx.strokeStyle="#" + getLineColor(doc, item); var KAPPA=4 * ((Math.sqrt(2) - 1) / 3); var cx=canvas.width / 2; var cy=canvas.height / 2; var rx=cx * KAPPA; var ry=cy * KAPPA; ctx.beginPath(); ctx.moveTo(cx, ctx.lineWidth); ctx.bezierCurveTo(cx + rx, ctx.lineWidth, canvas.width - ctx.lineWidth, cy - ry, canvas.width - ctx.lineWidth, cy); ctx.bezierCurveTo(canvas.width - ctx.lineWidth, cy + ry, cx + rx, canvas.height - ctx.lineWidth, cx, canvas.height - ctx.lineWidth); ctx.bezierCurveTo(cx - rx, canvas.height - ctx.lineWidth, ctx.lineWidth, cy + ry, ctx.lineWidth, cy); ctx.bezierCurveTo(ctx.lineWidth, cy - ry, cx - rx, ctx.lineWidth, cx, ctx.lineWidth); ctx.closePath(); if( !item.transparent ) { ctx.fillStyle="#" + getBackgroundColor(doc, item); ctx.fill(); } ctx.stroke(); ctx.restore(); } }; function DrawImageItem(divid, doc, item, keyurl, ds, vid) { if( item.width == 0 || item.height == 0 ) return; if ( item.ispreview == false ) return; if (item.imageid.indexOf("voiceye") != -1) return; var imageDiv=getImageDiv(doc, item, ds); var alink=null; if (item.linked) { var alink=document.createElement("a"); if (__ubi_viewers[vid] && __ubi_viewers[vid].events.linkButtonDown) { alink.onmouseover=function() { this.style.cursor="pointer";}; alink.onmouseout=function() { this.style.cursor="default";}; alink.onclick=function() {__ubi_viewers[vid]._linkButtonDown(item.linkfilename, item.linkargs); }; } else { if (item.linkstyle == "SCRIPT") { alink.href="javascript:"+item.linkfilename; } else if (item.linkstyle == "REPORT"){ alink.href="javascript:refreshFrame('"+ divid.parentNode.parentNode.parentNode.id +"','"+ item.linkfilename +"','"+ item.linkargs +"')"; } else if (item.linkstyle == "WEBPAGE"){ var url=item.linkfilename; if (item.linkfilename.indexOf(":/"+"/") == -1 && item.linkfilename.indexOf("mailto:") == -1) { url="http:/"+"/"+ item.linkfilename; } alink.href="javascript:window.open(\""+ url + item.linkargs +"\"); void 0;"; } } alink.appendChild(imageDiv); divid.appendChild(alink); } else { divid.appendChild(imageDiv); } var imageobj=doc.objects.Lookup(item.imageid); if( imageobj.loadtype == 1 && imageobj.loadsrc != "" ) { if( __ubi_isMobile ) { var image=getImage2(doc, item, keyurl, imageobj, ds); imageDiv.appendChild(image); } else { var canvas=getCanvas(doc, item, ds); imageDiv.appendChild(canvas); var canvasobj=null; drawCanvas2(doc, canvas, item, keyurl, imageobj, ds); } } else if ((imageobj.loadtype == 2 || imageobj.loadtype == 3) && imageobj.loadsrc != "" ) { getImageType2(imageDiv, doc, item, keyurl, imageobj, ds); } var borderDiv=getBorderDiv(doc, item, ds); if (item.linked) { alink.appendChild(borderDiv); } else { divid.appendChild(borderDiv); } }; function DrawBarcodeItem(divid, doc, item, keyurl, ds) { if( item.width == 0 || item.height == 0 ) return; if ( item.ispreview == false ) return; var imageDiv=getImageDiv(doc, item, ds); divid.appendChild(imageDiv); if( item.loadtype == 1 && item.loadsrc != "" ) { if( __ubi_isMobile ) { var image=getImage(doc, item, keyurl, ds); imageDiv.appendChild(image); } else { var canvas=getCanvas(doc, item); imageDiv.appendChild(canvas); drawCanvas(doc, canvas, item, keyurl, ds); } } var borderDiv=getBorderDiv(doc, item, ds); divid.appendChild(borderDiv); }; function DrawChartComponent(divid, doc, chart, keyurl, ds) { if( chart.width == 0 || chart.height == 0 ) return; var imageDiv=getImageDiv(doc, chart, ds); divid.appendChild(imageDiv); if( (chart.loadtype == 1 || chart.loadtype == 2) && chart.loadsrc != "" ) { if( __ubi_isMobile ) { var image=getImage(doc, chart, keyurl, ds); imageDiv.appendChild(image); } else { var image=getChartImage(doc, chart, keyurl, ds); imageDiv.innerHTML=image; } } }; function getBorderColor(tp, doc, item) { if( tp == "top") return doc.colors.Lookup(doc.lines.Lookup(doc.borders.Lookup(item.borderid).top).colorid).color; else if( tp == "right" ) return doc.colors.Lookup(doc.lines.Lookup(doc.borders.Lookup(item.borderid).right).colorid).color; else if( tp == "bottom" ) return doc.colors.Lookup(doc.lines.Lookup(doc.borders.Lookup(item.borderid).bottom).colorid).color; else if( tp == "left" ) return doc.colors.Lookup(doc.lines.Lookup(doc.borders.Lookup(item.borderid).left).colorid).color; else if( tp == "dd" ) return doc.colors.Lookup(doc.lines.Lookup(doc.borders.Lookup(item.borderid).diagonaldown).colorid).color; else if( tp == "du" ) return doc.colors.Lookup(doc.lines.Lookup(doc.borders.Lookup(item.borderid).diagonalup).colorid).color; }; function getBorderStyle(tp, doc, item) { if( tp == "top") return doc.lines.Lookup(doc.borders.Lookup(item.borderid).top).getStyle(); else if( tp == "right" ) return doc.lines.Lookup(doc.borders.Lookup(item.borderid).right).getStyle(); else if( tp == "bottom" ) return doc.lines.Lookup(doc.borders.Lookup(item.borderid).bottom).getStyle(); else if( tp == "left" ) return doc.lines.Lookup(doc.borders.Lookup(item.borderid).left).getStyle(); else if( tp == "dd" ) return doc.lines.Lookup(doc.borders.Lookup(item.borderid).diagonaldown).getStyle(); else if( tp == "du" ) return doc.lines.Lookup(doc.borders.Lookup(item.borderid).diagonalup).getStyle(); }; function getBorderWidth(tp, doc, item) { var width; var style=getBorderStyle(tp, doc, item); if( tp == "top") width=doc.lines.Lookup(doc.borders.Lookup(item.borderid).top).getWidth(); else if( tp == "right" ) width=doc.lines.Lookup(doc.borders.Lookup(item.borderid).right).getWidth(); else if( tp == "bottom" ) width=doc.lines.Lookup(doc.borders.Lookup(item.borderid).bottom).getWidth(); else if( tp == "left" ) width=doc.lines.Lookup(doc.borders.Lookup(item.borderid).left).getWidth(); else if( tp == "dd" ) width=doc.lines.Lookup(doc.borders.Lookup(item.borderid).diagonaldown).getWidth(); else if( tp == "du" ) width=doc.lines.Lookup(doc.borders.Lookup(item.borderid).diagonalup).getWidth(); if( style == "none" ) width=0; else { if( width % 2 == 1 ) width=parseInt(width / 2) + 1; else width=parseInt(width / 2); } return width; }; function getLineThickness(doc, item) { var width=doc.lines.Lookup(item.lineid).thickness; if( width != 0 ) { if( width % 2 == 1 ) width=parseInt(width / 2) + 1; else width=parseInt(width / 2); } return width; }; function getLineColor(doc, item) { return doc.colors.Lookup(doc.lines.Lookup(item.lineid).colorid).color; }; function getBackgroundColor(doc, item) { return doc.colors.Lookup(item.backgroundid).color; }; function getFont(doc, item, ds) { if( typeof ds == "undefined" ) ds=1.0; return doc.fonts.Lookup(item.fontid).getFont(ds); }; function getFontSize(doc, item, ds) { if( typeof ds == "undefined" ) ds=1.0; return doc.fonts.Lookup(item.fontid).getFontSize(ds); }; function getForegroundColor(doc, item) { return doc.colors.Lookup(item.foregroundid).color; }; function getImageDiv(doc, item, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var div=document.createElement("div"); div.id=item.id; div.style.overflow="hidden"; div.style.position="absolute"; div.style.left=x + "px"; div.style.top=y + "px"; div.style.width=(width + 1) + "px"; div.style.height=(height + 1) + "px"; return div; }; function getBorderDiv(doc, item, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var div=document.createElement("div"); div.style.backgroundColor="transparent"; div.style.position="absolute"; div.style.left=x + "px"; div.style.top=y + "px"; div.style.width=(width + 1) - (getBorderWidth("left", doc, item) + getBorderWidth("right", doc, item)) + "px"; div.style.height=(height + 1) - (getBorderWidth("top", doc, item) + getBorderWidth("bottom", doc, item)) + "px"; div.style.borderTop=getBorderWidth("top", doc, item) + "px " + getBorderStyle("top", doc, item) + " #" + getBorderColor("top", doc, item); div.style.borderRight=getBorderWidth("right", doc, item) + "px " + getBorderStyle("right", doc, item) + " #" + getBorderColor("right", doc, item); div.style.borderBottom=getBorderWidth("bottom", doc, item) + "px " + getBorderStyle("bottom", doc, item) + " #" + getBorderColor("bottom", doc, item); div.style.borderLeft=getBorderWidth("left", doc, item) + "px " + getBorderStyle("left", doc, item) + " #" + getBorderColor("left", doc, item); return div; }; function getCanvas(doc, item, ctx) { var canvas=document.createElement("canvas"); canvas.id=item.id + (_ubi_cindex++)+ "cv"; return canvas; }; function getImage(doc, item, keyurl, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var image=document.createElement("img"); image.id=item.id + (_ubi_iindex++)+ "img"; image.src=keyurl + "&cHJvY2lk=GATEWAY&reqtype=3&serviceid="+doc.serviceid+"&imageid=" + item.loadsrc; image.style.position="absolute"; image.style.left=0 + "px"; image.style.top=0 + "px"; image.style.width=(width + 1) + "px"; image.style.height=(height + 1) + "px"; return image; }; function getImage2(doc, item, keyurl, imageobj, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; var image=document.createElement("img"); image.id=item.id + (_ubi_iindex++)+ "img"; image.src=keyurl + "&cHJvY2lk=GATEWAY&reqtype=3&serviceid="+doc.serviceid+"&imageid=" + imageobj.loadsrc; if( imageobj.fixedrate || imageobj.originalsize ) { var imgleft=0; var imgtop=0; var imgwidth=(Math.round(imageobj.width*ds) / 3) + 1; var imgheight=(Math.round(imageobj.height*ds) / 3) + 1; if( imgwidth < (width + 1) && item.halign != 0 ) { if( item.halign == 1 ) imgleft=((width + 1) - imgwidth) / 2; else if( item.halign == 2 ) imgleft=((width + 1) - imgwidth); } if( imgheight < (height + 1) && item.valign != 0 ) { if( item.valign == 1 ) imgtop=((height + 1) - imgheight) / 2; else if( item.valign == 2 ) imgtop=((height + 1) - imgheight); } image.style.position="absolute"; image.style.left=imgleft + "px"; image.style.top=imgtop + "px"; image.style.width=imgwidth + "px"; image.style.height=imgheight + "px"; } else { image.style.position="absolute"; image.style.left=0 + "px"; image.style.top=0 + "px"; image.style.width=(width + 1) + "px"; image.style.height=(height + 1) + "px"; } return image; }; function getImageType2(imageDiv, doc, item, keyurl, imageobj, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; _ubi_imgcount++; newImg=new Image(); newImg.onload=function(){ var imgWidth=Math.floor(this.width*ds*0.75); var imgHeight=Math.floor(this.height*ds*0.75); var innerhtml=""; var imgsrc=""; if (imageobj.loadtype == 3) { imgsrc=imageobj.loadsrc; if (imgsrc.length > 11 && imgsrc.substr(0,11) != 'data:image/') { var srcarray=[]; srcarray.push('data:image/png;base64,'); srcarray.push(imgsrc); imgsrc=srcarray.join(''); } } else { imgsrc=imageobj.loadsrc; } if (item.valign != 0) { innerhtml += "<table width=\""+width+"px\" height=\""+height+"px\" cellspacing='0'><tr><td align=\""+ item.getHAlign() +"\" valign=\""+ item.getVAlign() +"\">"; } if (item.halign != 1) { imageDiv.style.textAlign=item.getHAlign(); } if (imageobj.originalsize) { innerhtml += "<div style='left:0px;top:0px; overflow:hidden; position:relative;'><img id=\"" + item.id + (_ubi_iindex++)+ "img\" width="+imgWidth+" height="+imgHeight+" src='"+imgsrc+"' style='position:relative; "; if (imageobj.brightness > 0) { innerhtml += " opacity:" + ((100-imageobj.brightness*2)/100) +"; " +" alpha(opacity:"+(100-imageobj.brightness*2)+");"; } innerhtml += "'></div>"; } else { innerhtml += "<img id=\"" + item.id + (_ubi_iindex++)+ "img\""; innerhtml += " src=\"" + imgsrc +"\""; innerhtml += " style=\"position:relative; "; if (imageobj.fixedrate) { var hds=width / imgWidth; var vds=height / imgHeight; var imgds=Math.min(hds, vds); innerhtml += " width:"+ Math.floor(imgWidth*imgds) +"px; height:"+ Math.floor(imgHeight*imgds) +"px; "; } else { innerhtml += " width:"+ width +"px; height:"+ height +"px;"; } if (imageobj.brightness > 0) { innerhtml += " opacity:" + ((100-imageobj.brightness*2)/100) +"; " +" alpha(opacity:"+(100-imageobj.brightness*2)+");"; } innerhtml += "\">"; } if (item.valign != 0) { innerhtml += "</td></tr></table>"; } imageDiv.innerHTML=innerhtml; _ubi_imgcount--; }; newImg.onerror=function(){ _ubi_imgcount--; }; if (imageobj.loadtype == 3) { newImg.onload(); } else { newImg.src=imageobj.loadsrc; } }; function getChartImage(doc, chart, keyurl, ds) { var x=Math.round(chart.x * ds); var y=Math.round(chart.y * ds); var width=Math.round((chart.x+chart.width) * ds) - x; var height=Math.round((chart.y+chart.height) * ds)- y; var innerhtml=""; var imgurl=keyurl + "&cHJvY2lk=GATEWAY&reqtype=3&serviceid="+doc.serviceid+"&imageid=" + chart.loadsrc; innerhtml += "<img id=\"chart_" + (_ubi_iindex++)+ "img\""; innerhtml += " src=\"" + imgurl +"\""; innerhtml += " style=\""; innerhtml += " position:relative; width:"+ width +"px; height:"+ height +"px;"; innerhtml += "\">"; return innerhtml; }; function drawCanvas(doc, canvas, item, keyurl, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas); var ctx=canvas.getContext("2d"); canvas.style.position="absolute"; canvas.style.left=0 + "px"; canvas.style.top=0 + "px"; canvas.width=width + 1; canvas.height=height + 1; var image=new Image(); image.id=item.id + (_ubi_iindex++)+ "img"; image.onload=function() { if (isPrint == false) { ctx.drawImage(image, 0, 0, canvas.width, canvas.height); } }; image.src=keyurl + "&cHJvY2lk=GATEWAY&reqtype=3&serviceid="+doc.serviceid+"&imageid=" + item.loadsrc; if (isPrint) { var canvasobj=new UbiCanvasObject(); canvasobj.type="IMAGE"; canvasobj.canvasid=canvas.id; canvasobj.imageid=image.id; canvasobj.x=0; canvasobj.y=0; canvasobj.width=width + 1; canvasobj.height=height + 1; canvasobj.src=image.src; drawcanvaslist[drawcanvaslist.length]=canvasobj; } }; function drawCanvas2(doc, canvas, item, keyurl, imageobj, ds) { var x=Math.round(item.x * ds); var y=Math.round(item.y * ds); var width=Math.round((item.x+item.width) * ds) - x; var height=Math.round((item.y+item.height) * ds)- y; if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas); var ctx=canvas.getContext("2d"); canvas.style.position="absolute"; canvas.style.left=0 + "px"; canvas.style.top=0 + "px"; canvas.width=width + 1; canvas.height=height + 1; var imgleft=0; var imgtop=0; var imgwidth=canvas.width; var imgheight=canvas.height; if( imageobj.fixedrate || imageobj.originalsize ) { imgwidth=(Math.round(imageobj.width * ds) / 3) + 1; imgheight=(Math.round(imageobj.height * ds) / 3) + 1; if( imgwidth < canvas.width && item.halign != 0 ) { if( item.halign == 1 ) imgleft=(canvas.width - imgwidth) / 2; else if( item.halign == 2 ) imgleft=(canvas.width - imgwidth); } if( imgheight < canvas.height && item.valign != 0 ) { if( item.valign == 1 ) imgtop=(canvas.height - imgheight) / 2; else if( item.valign == 2 ) imgtop=(canvas.height - imgheight); } } var image=new Image(); image.id=item.id + (_ubi_iindex++)+ "img"; image.onload=function() { if (isPrint == false) { ctx.drawImage(image, imgleft, imgtop, imgwidth, imgheight); } }; if (imageobj.loadtype == 2) { image.src=imageobj.loadsrc; } else { image.src=keyurl + "&cHJvY2lk=GATEWAY&reqtype=3&serviceid="+doc.serviceid+"&imageid=" + imageobj.loadsrc; } if (isPrint) { var canvasobj=new UbiCanvasObject(); canvasobj.type="IMAGE"; canvasobj.canvasid=canvas.id; canvasobj.imageid=image.id; canvasobj.x=imgleft; canvasobj.y=imgtop; canvasobj.width=imgwidth; canvasobj.height=imgheight; canvasobj.src=image.src; drawcanvaslist[drawcanvaslist.length]=canvasobj; } }; }});var UbiCanvasObject=Base.extend({ type: "", divid: "", canvasid: "", imageid: "", left: 0, top: 0, width: 0, height: 0, src: "", linewidth: 0, strokestyle: "", fillstyle: "", radius: 0});var __ubi_isFF=false;var __ubi_isIE=false;var __ubi_isChrome=false;var __ubi_isOpera=false;var __ubi_isSafari=false;var __ubi_isMacOS=false;var __ubi_ieVersion=6;var __ubi_isMobile=false;var __ubi_isEdge=false;var __ubi_isWhale=false;var mobileKeyWords=new Array('iPhone', 'iPod', 'iPad', 'BlackBerry', 'Android', 'Windows CE', 'LG', 'MOT', 'SAMSUNG', 'SonyEricsson');try{ for (var word in mobileKeyWords) { if( navigator.userAgent.match(mobileKeyWords[word]) != null ) { __ubi_isMobile=true; break; } };}catch(e){}if (navigator.userAgent.indexOf('Macintosh')!= -1) __ubi_isMacOS=true;if (navigator.userAgent.indexOf('Trident/7')!= -1 && navigator.appName.indexOf("Netscape")!= -1 && navigator.product == "Gecko") { __ubi_isIE=true; __ubi_ieVersion=11;}else if (navigator.userAgent.indexOf('Whale')!= -1) { __ubi_isWhale=true;}else if (navigator.userAgent.indexOf('Edge')!= -1) { __ubi_isEdge=true;}else if (navigator.userAgent.indexOf('Chrome')!= -1) { if (navigator.userAgent.indexOf('OPR')!= -1) { __ubi_isOpera=true; } else { __ubi_isChrome=true; }}else if (navigator.userAgent.indexOf('Firefox')!= -1) { __ubi_isFF=true;}else if ((navigator.userAgent.indexOf('Safari')!= -1)||(navigator.userAgent.indexOf('Konqueror') != -1)) { __ubi_isSafari=true;}else if (navigator.userAgent.indexOf('Opera')!= -1) { __ubi_isOpera=true; _OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf('Opera')+6, 3));}else if (navigator.appName.indexOf("Microsoft")!= -1 || navigator.userAgent.indexOf("MSIE")!= -1) { __ubi_isIE=true; if (navigator.appVersion.indexOf("MSIE 10.0")!= -1 && document.compatMode != "BackCompat") { if(navigator.appName.indexOf("Netscape")!= -1 && navigator.product == "Gecko") { __ubi_ieVersion=11; } else { __ubi_ieVersion=10; } } if (navigator.appVersion.indexOf("MSIE 9.0")!= -1 && document.compatMode != "BackCompat") { __ubi_ieVersion=9; } if (navigator.appVersion.indexOf("MSIE 8.0")!= -1 && document.compatMode != "BackCompat") { __ubi_ieVersion=8; } if (navigator.appVersion.indexOf("MSIE 7.0")!= -1) { __ubi_ieVersion=7; }}else { __ubi_isFF=true;};if (__ubi_isIE) { if (window.XMLHttpRequest==null) __ubi_ieVersion=6;};function _ubi_lowerIE9() { if (__ubi_isIE && __ubi_ieVersion < 9) { return true; } return false;}function _ubi_checkPdfReader() { var obj=null; if (__ubi_isIE) { try { obj=new ActiveXObject("AcroPDF.PDF"); if( obj != null ) return true; } catch(e){ try { obj=new ActiveXObject("PDF.PdfCtrl"); if( obj != null ) return true; } catch(e1) { } } } else { var nav=navigator.plugins; for ( var i=0; i < nav.length; i++) { var name=nav[i].name; if( name.indexOf("Adobe Reader") != -1 || name.indexOf("Adobe PDF") != -1 || name.indexOf("Acrobat") != -1 || name.indexOf("Chrome PDF") != -1 ) { var version=nav[i].version; return true; } } } return false;}function _ubi_AddEvent(obj, evt, fn) { evt=(evt.indexOf(" ") != -1) ? evt.split(" ") : [ evt ]; for (i in evt) { var e=evt[i]; if (e == "mousewheel") { if (obj.addEventListener) obj.addEventListener('DOMMouseScroll', fn, false); obj.onmousewheel=fn; break; } if (obj.addEventListener) obj.addEventListener((e == "mousewheel") ? "DOMMouseScroll" : e, fn, false); else if (obj.attachEvent) obj.attachEvent('on' + e, fn); }}function _ubi_RemoveAddEvent(obj, evt, fn) { evt=(evt.indexOf(" ") != -1) ? evt.split(" ") : [ evt ]; for (i in evt) { var e=evt[i]; if (e == "mousewheel") { if (obj.removeEventListener) obj.removeEventListener('DOMMouseScroll', fn, false); obj.onmousewheel=null; break; } if (obj.removeEventListener) obj.removeEventListener((e == "mousewheel") ? "DOMMouseScroll" : e, fn, false); else if (obj.detachEvent) obj.detachEvent('on' + e, fn); }}function _ubi_strToBool(str) { if (str == "true") return true; if (str == "false") return false; return str;}function _ubi_strToInt(str) { var val=0; if (str) { try { val=parseInt(str); } catch (e) { val=0; } } return val;}function _ubi_isNumber(s) { s += ''; s=s.replace(/^\s*|\s*$/g, ''); if (s == '' || isNaN(s)) return false; return true;}function _ubi_clone(obj) { if (obj === null || typeof(obj) !== 'object') { return obj; } var copy=obj.constructor(); for (var attr in obj) { if (obj.hasOwnProperty(attr)) { copy[attr]=_ubi_clone(obj[attr]); } } return copy;}function _ubi_getMessage(language, key) { var lang=language; if (language == 'ko' || language == 'kr') { lang='korean'; } else if (language == 'en' || language == 'us') { lang='english'; } else if (language == 'es') { lang='spanish'; } if(typeof(_ubi_msg)=="undefined") { _ubi_msg={'korean':{ "StreamingMsg": "\uD604\uC7AC \uC2A4\uD2B8\uB9AC\uBC0D \uB9AC\uD3EC\uD2B8\uB97C \uC0DD\uC131 \uC911\uC785\uB2C8\uB2E4.", "StreamingMsg2": "\uD398\uC774\uC9C0 \uC0DD\uC131 \uC911...", "StreamingMsg3": "\uD398\uC774\uC9C0 \uC911 ", "CompleteMsg": "\uC2A4\uD2B8\uB9AC\uBC0D \uB9AC\uD3EC\uD2B8 \uC0DD\uC131\uC774 \uC644\uB8CC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.", "CreateErrMsg": "\uB9AC\uD3EC\uD2B8\uAC00 \uC0DD\uC131\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.", "TotalpageErrMsg": "\uC804\uCCB4 \uD398\uC774\uC9C0 \uC815\uBCF4\uB97C \uAC00\uC838\uC624\uB294 \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.", "UnknownErrMsg": "\uC54C \uC218 \uC5C6\uB294 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.", "ErrMsg": "\uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.", "ExportMsg" : "\uD30C\uC77C\uC744 \uC0DD\uC131 \uC911\uC785\uB2C8\uB2E4.", "ExportMsg2" : "\uC804\uC6A9 \uBDF0\uC5B4 \uBAA8\uB4DC\uC5D0\uC11C \uC9C0\uC6D0\uD558\uC9C0 \uC54A\uB294 \uC800\uC7A5 \uD0C0\uC785\uC785\uB2C8\uB2E4.", "StatusWaitMsg" : "\uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824 \uC8FC\uC138\uC694.", "PrintDlgTitle": "\uC778\uC1C4 \uBC94\uC704\uB97C \uC124\uC815\uD569\uB2C8\uB2E4.", "PrintDlgAll": "\uBAA8\uB450", "PrintDlgCurrent": "\uD604\uC7AC", "PrintDlgFromTo": "\uD398\uC774\uC9C0 \uC9C0\uC815", "PrintDlgFrom": "\uBD80\uD130", "PrintDlgTo": "\uAE4C\uC9C0", "PrintDlgHMent": "Internet Explorer\uC5D0\uC11C \uAC00\uB85C \uC591\uC2DD\uC740 \uC778\uC1C4 \uBBF8\uB9AC \uBCF4\uAE30", "PrintDlgHMent2": "\uC635\uC158\uC5D0\uC11C \uC6A9\uC9C0 \uBC29\uD5A5\uC744 \uBCC0\uACBD\uD558\uC5EC \uC778\uC1C4\uD558\uC138\uC694.", "PrintDlgLink": "\uC790\uC138\uD788 \uBCF4\uAE30", "PrintDlgMent": "\u203B \uC778\uC1C4\uB7C9\uC774 \uB9CE\uC544\uC11C \uBD80\uBD84\uC778\uC1C4\uB9CC \uAC00\uB2A5\uD569\uB2C8\uB2E4.", "PrintDlgMaxMent" : "\uCD5C\uB300 \uD398\uC774\uC9C0 \uC218 : ", "PrintDlgHTMLRangeErr": "HTML\uC778\uC1C4 \uD5C8\uC6A9 \uD398\uC774\uC9C0 \uBC94\uC704\uB97C \uBC97\uC5B4\uB0AC\uC2B5\uB2C8\uB2E4.", "PrintDlgRangeErr": "\uD398\uC774\uC9C0 \uBC94\uC704\uB97C \uBC97\uC5B4\uB0AC\uC2B5\uB2C8\uB2E4.", "PrintDlgEnter": "\n\uB2E4\uC2DC \uC785\uB825\uD558\uC5EC \uC8FC\uC2ED\uC2DC\uC624.", "Button_OK": "\uD655\uC778", "Button_Cancel": "\uCDE8\uC18C", "PdfCheckMsg9": "Adobe Reader\uC758 \uBC84\uC804\uC774 \uC124\uCE58\uB418\uC5B4\uC788\uC9C0 \uC54A\uAC70\uB098, 9 \uBC84\uC804 \uC774\uD558\uC758 \uC624\uB798\uB41C \uBC84\uC804\uB9CC \uC124\uCE58\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.", "PdfCheckMsg6": "Adobe Reader\uC758 \uBC84\uC804\uC774 \uC124\uCE58\uB418\uC5B4\uC788\uC9C0 \uC54A\uAC70\uB098, 6 \uBC84\uC804 \uC774\uD558\uC758 \uC624\uB798\uB41C \uBC84\uC804\uB9CC \uC124\uCE58\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.", "PdfGuideMsg": "<a href='http:/"+""+"/get.adobe.com/kr/reader/' target='_blank' style='text-decoration:none; color:red; cursor:pointer;'><b>\uC5B4\uB3C4\uBE44 \uD648\uD398\uC774\uC9C0</b></a>\uC5D0\uC11C \uCD5C\uC2E0 Adobe Reader\uB97C<br> \uC124\uCE58\uD558\uC2DC\uAE30 \uBC14\uB78D\uB2C8\uB2E4.", "PdfDownloadMsg" : "\uD604\uC7AC \uC0AC\uC6A9 \uC911\uC778 ^browser^ \uBE0C\uB77C\uC6B0\uC800\uB294 PDF \uD30C\uC77C\uC774 <b>\uB2E4\uC6B4\uB85C\uB4DC</b>\uB429\uB2C8\uB2E4.<br>\uC778\uC1C4\uB97C \uC6D0\uD558\uB294 \uACBD\uC6B0 <b>\uC800\uC7A5 \uBC84\uD2BC</b>\uC744 \uC774\uC6A9\uD558\uC5EC \uD30C\uC77C \uC800\uC7A5 \uD6C4<br>\uC778\uC1C4\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.", "PdfDownloadChromeMsg" : "PDF \ud30c\uc77c\uc5d0 \uc554\ud638\uac00 \uc124\uc815\ub418\uc5b4 \ud30c\uc77c\uc774 <b>\ub2e4\uc6b4\ub85c\ub4dc</b>\ub429\ub2c8\ub2e4.<br>\uC778\uC1C4\uB97C \uC6D0\uD558\uB294 \uACBD\uC6B0 <b>\uC800\uC7A5 \uBC84\uD2BC</b>\uC744 \uC774\uC6A9\uD558\uC5EC \uD30C\uC77C \uC800\uC7A5 \uD6C4<br>\uC778\uC1C4\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.", "PdfInstallMsg1" : "<b>\uD604\uC7AC \uBE0C\uB77C\uC6B0\uC800\uC5D0\uC11C Adobe Reader\uB97C \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.</b>", "PdfInstallMsg2" : "<b>\uD604\uC7AC \uC124\uCE58\uB41C Adobe Reader\uC758 \uBC84\uC804\uC774 \uB0AE\uAC70\uB098 \uC815\uC0C1\uC801\uC73C\uB85C \uC124\uCE58\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.</b>", "PdfInstallMsg3" : "\uC815\uC0C1\uC801\uC778 \uC778\uC1C4\uB97C \uC704\uD574\uC11C\uB294 <b>Adobe Reader 10 \uBC84\uC804 \uC774\uC0C1\uC744 \uC124\uCE58</b>\uD574\uC57C \uD569\uB2C8\uB2E4.<br>\uBE0C\uB77C\uC6B0\uC800 \uC885\uB8CC \uD6C4 \uC544\uB798 \uC0AC\uC774\uD2B8\uB97C \uD1B5\uD574\uC11C \uC124\uCE58\uD558\uAE30 \uBC14\uB78D\uB2C8\uB2E4.<br><br><a style='color:red; text-decoration:none;' href='https://get.adobe.com/kr/reader' target='_blank'>https://get.adobe.com/kr/reader</a><br><br>\uC124\uCE58 \uC5C6\uC774 \uC778\uC1C4\uD558\uAE30\uB97C \uC6D0\uD55C\uB2E4\uBA74 <b>\uC800\uC7A5 \uBC84\uD2BC</b>\uC744 \uC774\uC6A9\uD558\uC5EC \uD30C\uC77C \uC800\uC7A5 \uD6C4 \uC778\uC1C4\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.", "SaveFileMsg1" : "&nbsp; \u203B \uBCC4\uB3C4\uC758 \uC124\uCE58 \uC5C6\uC774 \uD30C\uC77C\uC744 PC\uB85C \uB2E4\uC6B4\uB85C\uB4DC \uD569\uB2C8\uB2E4.", "SaveFileMsg2" : "&nbsp; ※ \uD398\uC774\uC9C0 \uC218\uAC00 \uB9CE\uC740 \uACBD\uC6B0 \uC77C\uBC18 \uC800\uC7A5\uBCF4\uB2E4 \uBE60\uB974\uAC8C \uC800\uC7A5\uC774 \uAC00\uB2A5\uD569\uB2C8\uB2E4.<br>&nbsp; \uD504\uB85C\uADF8\uB7A8 \uC124\uCE58\uAC00 \uD544\uC694\uD558\uBA70 \uD574\uB2F9 \uD504\uB85C\uADF8\uB7A8\uC774 \uC124\uCE58\uB418\uC5B4 \uC788\uC9C0 \uC54A\uC740 \uACBD\uC6B0<br>&nbsp; \uC124\uCE58 \uC791\uC5C5\uC774 \uC9C4\uD589\uB429\uB2C8\uB2E4.", "SaveDialogTitle" : "\uD30C\uC77C \uC800\uC7A5", "SaveDialogType" : "\uC800\uC7A5 \uBC29\uC2DD", "SaveDialogFileType" : "\uD30C\uC77C \uC720\uD615", "SaveDialogDefault" : "\uC77C\uBC18 \uC800\uC7A5", "SaveDialogUbiViewer" : "\uC804\uC6A9 \uBDF0\uC5B4 \uC800\uC7A5", "PrintPDFTitle" : "PDF \uC778\uC1C4 \uC548\uB0B4", "PrintHTMLTitle" : "HTML \uC778\uC1C4 \uC548\uB0B4", "PrintHTMLMsg_Edge" : "\uC778\uC1C4\uD558\uAE30 \uC804 \u2018\uBA38\uB9AC\uAE00 \uBC0F \uBC14\uB2E5\uAE00\u2019\uC5D0\uC11C \u2018\uB054\u2019\uC744 \uC120\uD0DD\uD558\uACE0 \uC778\uC1C4 \uBC84\uD2BC\uC744 \uB204\uB974\uBA74 \uB429\uB2C8\uB2E4.", "PrintHTMLMsg_FF" : "\uC778\uC1C4\uD558\uAE30 \uC804 \uBE0C\uB77C\uC6B0\uC800 \uC124\uC815\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.<br>\uBE0C\uB77C\uC6B0\uC800\uC758 [\uD30C\uC77C] \uBA54\uB274 > \uD398\uC774\uC9C0 \uC124\uC815 > \uC5EC\uBC31 \uBC0F \uBA38\uB9AC\uAE00/\uBC14\uB2E5\uAE00\uC5D0\uC11C \uBA38\uB9AC\uAE00, \uBC14\uB2E5\uAE00\uC744 \u2018\uACF5\uBC31\u2019\uC73C\uB85C \uC124\uC815\uD55C \uD6C4 \uC778\uC1C4\uD558\uAE30 \uBC14\uB78D\uB2C8\uB2E4.", "PrintHTMLMsg_Chrome" : "\uC778\uC1C4\uD558\uAE30 \uC804 \u2018\uC124\uC815 \uB354\uBCF4\uAE30\u2019\uC5D0\uC11C \u2018\uBA38\uB9AC\uAE00\uACFC \uBC14\uB2E5\uAE00\u2019 \uC635\uC158\uC744 \uD574\uC81C\uD55C \uD6C4 \uC778\uC1C4 \uBC84\uD2BC\uC744 \uB204\uB974\uBA74 \uB429\uB2C8\uB2E4.", "PrintHTMLMsg_Opera" : "\uC778\uC1C4\uD558\uAE30 \uC804 \u2018\uCD94\uAC00 \uC635\uC158\u2019\uC5D0\uC11C \u2018\uBA38\uB9AC\uAE00\uACFC \uBC14\uB2E5\uAE00\u2019 \uC635\uC158\uC744 \uD574\uC81C\uD55C \uD6C4 \uC778\uC1C4 \uBC84\uD2BC\uC744 \uB204\uB974\uBA74 \uB429\uB2C8\uB2E4.", "PrintHTMLMsg_IE" : "\uC778\uC1C4\uD558\uAE30 \uC804 \uBE0C\uB77C\uC6B0\uC800 \uC124\uC815\uC774 \uD544\uC694\uD569\uB2C8\uB2E4.<br>\uBE0C\uB77C\uC6B0\uC800\uC758 [\uD30C\uC77C] \uBA54\uB274 > \uD398\uC774\uC9C0 \uC124\uC815 > \uBA38\uB9AC\uAE00/\uBC14\uB2E5\uAE00\uC744 \u2018\uBE44\uC5B4 \uC788\uC74C\u2019\uC73C\uB85C \uC124\uC815\uD55C \uD6C4 \uC778\uC1C4\uD558\uAE30 \uBC14\uB78D\uB2C8\uB2E4.", "PrintHTMLMsg_IEObj" : "\uC778\uC1C4\uD558\uAE30 \uC804 '\uD398\uC774\uC9C0 \uC124\uC815(Alt + U)'\uC5D0\uC11C<br>\uBA38\uB9AC\uAE00 \uBC0F \uBC14\uB2E5\uAE00 \u2018\uBE44\uC5B4 \uC788\uC74C\u2019\uC744 \uC120\uD0DD \uD6C4 \uC778\uC1C4\uD558\uAE30 \uBC14\uB78D\uB2C8\uB2E4.", "ExportOption" : "\uC800\uC7A5 \uC635\uC158", "ExportFormat" : "\uD3EC\uB9F7", "TiffOption" : "Tiff \uC555\uCD95 \uBC29\uC2DD", "TiffPageOption" : "\uD398\uC774\uC9C0\uBCC4 Tiff \uC774\uBBF8\uC9C0 \uC0DD\uC131", "ZipFileMsg" : "※ \uC774\uBBF8\uC9C0\uB294 \uC555\uCD95 \uD30C\uC77C(*.zip)\uB85C \uB2E4\uC6B4\uB85C\uB4DC\uB429\uB2C8\uB2E4." }}; } var rtnstr=""; if (_ubi_msg[lang]) { if (_ubi_msg[lang][key] != undefined) rtnstr=_ubi_msg[lang][key]; } return rtnstr;}function _ubi_wafoucus(id) { if (!id) return; var obj=null; if (typeof(id) == "object") { obj=id; } else { obj=document.getElementById(id); } if (obj) { obj.setAttribute("orgstyle", obj.style.cssText); obj.style.border="2px solid #FF0000"; }}function _ubi_wablur(id) { if (!id) return; var obj=null; if (typeof(id) == "object") { obj=id; } else { obj=document.getElementById(id); } if (obj) { obj.style.cssText=obj.getAttribute("orgstyle"); }}var __ubi_createStyle=false;var __ubi_viewers=[];var __ubi_URF="0";var __ubi_EXPORT_URF="1";var __ubi_PDF="2";var __ubi_EXPORT_IMAGE="10";var __ubi_EXPORT_PDF="11";var __ubi_EXPORT_EXCEL1="12";var __ubi_EXPORT_EXCEL2="13";var __ubi_EXPORT_RTF="14";var __ubi_EXPORT_HWP="15";var __ubi_EXPORT_PPTX="16";var __ubi_EXPORT_HML="17";var __ubi_EXPORT_DOCX="18";var __ubi_EXPORT_CELL="19";var __ubi_PAGE="91";var __ubi_TOTAL_PAGE="99";var __ubi_EXPORT_JOB="93";var __ubi_EXPORT_RESULT="94";var __ubi_exportMap={ 'SAVE_PDF' : __ubi_EXPORT_PDF, 'PDF' : __ubi_EXPORT_PDF, 'EXCEL_TYPE1': __ubi_EXPORT_EXCEL1, 'EXCEL_TYPE2': __ubi_EXPORT_EXCEL2, 'SAVE_PPTX' : __ubi_EXPORT_PPTX, 'PPTX' : __ubi_EXPORT_PPTX, 'SAVE_HML' : __ubi_EXPORT_HML, 'HML' : __ubi_EXPORT_HML, 'SAVE_DOCX' : __ubi_EXPORT_DOCX, 'DOCX' : __ubi_EXPORT_DOCX, 'SAVE_CELL' : __ubi_EXPORT_CELL, 'CELL' : __ubi_EXPORT_CELL, 'IMAGE' : __ubi_EXPORT_IMAGE };var UbiViewer=Base.extend({ key: "", page: 0, totalPage: 0, PrintDefaultType : "PDF", SaveDefaultType : "", SaveExcelDefaultType : "EXCEL_TYPE1", exportSeq : -1, isEnableNoPage : false, retrieveUrfUrl : "", HmlExtension : "hml", ieAdobeReaderInfoPopup : false, vid : null, viewer : this, serviceValid : false, pageWidth : 0, pageHeight : 0, pageOrientation : "Portrait", ds : 1, exportsetmode : 1, _isMultiDocument: false, _isMultiPaper: false, _isPrintPDF: false, _isAutoDownload: true, _isReceiveTotalpage: false, _exportImageType: "", _scrollUpdateTimerID : null, _scrollPageCount : -1, _arghash : new UbiMap(), _datasets : [], constructor: function(params, styles, events) { this.params={ reqtype: __ubi_URF, cHJvY2lk: "GATEWAY", imageid: "", key: params.key || "", ubiserverurl: params.ubiserverurl || "", printurl: params.printurl || "", timeout: params.timeout || "600000", jrffile: params.jrffile || "", masterfilename: params.masterfilename || "", resid: params.resid || "", arg: params.arg || "", ismultireport: params.ismultireport || "false", multicount: params.multicount || "1", ismultireportpaging: params.ismultireportpaging || "true", exportseq: params.exportseq || "", reporttitle: params.reporttitle || "", sheetname: params.sheetname || "", toolbar: params.toolbar || "true", resource: params.resource || "", divid: params.divid || params.div.id, skin: params.skin || "standard", scale: params.scale || "PageWidth", userscale: params.userscale || "0", isencrypt: params.isencrypt || "false", isencrypt64: params.isencrypt64 || "false", statusmsghide: params.statusmsghide || "false", disabledivhide: params.disabledivhide || "false", bgcolor: params.bgcolor || "#E4E4E4", bgimage: params.bgimage || "", flicking: params.flicking || "false", scrollpage: params.scrollpage || "true", isStreaming: params.isStreaming || "true", issvg: params.issvg || "false", direction: params.direction || "", language: params.language || "ko", printlimit: params.printlimit || "50", imagescale: params.imagescale || "100", isexportchartimage : params.isexportchartimage || "true", exceladjustpage : params.exceladjustpage || "false", excelExportLineItem : params.excelExportLineItem || "false", excelPrintPaperSize : params.excelPrintPaperSize || "", excelPrintfitWidth : params.excelPrintfitWidth || "", excelPrintfitHeight : params.excelPrintfitHeight || "", excelSheetPerReport : params.excelSheetPerReport || "false", excelSheetPerMasterPage: params.excelSheetPerMasterPage || "false", excelSheetPerPage: params.excelSheetPerPage || "false", excelSkipMasterItem : params.excelSkipMasterItem || "false", excelSheetPerPageCount: params.excelSheetPerPageCount || "100", excelOrgItemType : params.excelOrgItemType || "false", excelExportUseUrf : params.excelExportUseUrf || "true", tiffType : params.tiffType || "GROUP3_2D", tiffPerPage : params.tiffPerPage || "false", docxTableFixed : params.docxTableFixed || "true", streamdata : params.streamdata || "", clienttype : params.clienttype || "", datasetinfos : params.datasetinfos || "", runtimedata: params.runtimedata || "", isvoiceye : params.isvoiceye || "false", iswa : params.iswa || "false", isredbc : params.isredbc || "false", password : params.password || "", drmdocnumber : params.drmdocnumber || "", drmdocname : params.drmdocname || "", drmpagenames : params.drmpagenames || "", hmlTableProtect : params.hmlTableProtect || "false", hmlTextWrap : params.hmlTextWrap || "InFrontOfText", fontElement : params.fontElement || "", userHeader : params.userHeader || "", useplugin : params.useplugin || "true", usepluginsave : params.usepluginsave || "false", pluginprogress : params.pluginprogress || "false", printIEobj : params.printIEobj || "false", useAdobeReader : params.useAdobeReader || "true", exportPageFrom : params.exportPageFrom || "0", exportPageTo : params.exportPageTo || "0", exportAsOrgImage : params.exportAsOrgImage || "true", exportDS : params.exportDS || "1", serviceid : "" }; this.pluginparams=[]; if (styles == undefined) styles={}; this.styles={ margin: styles.margin || "10", pagegap: styles.pagegap || "10", pageborder: styles.pageborder || "true", pagebordercolor: styles.pagebordercolor || "#A0A0A0", toolbarbgcolor: styles.toolbarbgcolor || "#ffffff" }; if (events == undefined) events={}; this.events={ printEnd: events.printEnd, exportEnd: events.exportEnd, closeEnd: events.closeEnd, linkButtonDown: events.linkButtonDown, getUserParams: events.getUserParams, printClicked : events.printClicked, exportClicked : events.exportClicked, changeScaleEnd : events.changeScaleEnd }; if (_ubi_strToBool(this.params.issvg)) { if (_ubi_lowerIE9()) { alert("IE8 이하에서는 HTML5 뷰어 기능을 지원하지 않습니다.\nHTML4 뷰어로 미리보기를 진행합니다."); this.params.issvg=false; } else { this.params.isStreaming=true; this.params.scrollpage=true; } } this.vid=this.params.divid; var params=this.params; var styles=this.styles; for(var viewerIndex in __ubi_viewers) { if(__ubi_viewers[viewerIndex]) { if(this.vid == __ubi_viewers[viewerIndex].vid) { __ubi_viewers[viewerIndex].destroy(); __ubi_viewers[viewerIndex]=null; } } } __ubi_viewers[this.vid]=this; _ubi_AddEvent(window, "resize", function() { __ubi_viewers[params.divid].resize(); } ); this.page=1; this.totalPage=0; this.isEnableNoPage=false; this.toolbarHeight=44; this.msgWidth=380; this.msgHeight=122; this.msg=""; if (__ubi_createStyle == false) { __ubi_createStyle=true; if (document.styleSheets.length < 1) { var s=document.createElement('style'); document.head.appendChild(s); }; if (document.styleSheets[0]) { var sheet=document.styleSheets[0]; if (sheet.addRule) { try { sheet.addRule('.ubireportcontainer', 'white-space:normal; box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer div', 'box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer .toolbar', 'position:relative; white-space:normal; box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer .toolbar div', 'position:relative; white-space:normal; box-sizing:content-box; overflow:visible;', 0); sheet.addRule('.ubireportcontainer .toolbar input', 'position:relative; white-space:normal; box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer .dialog', 'position:absolute; white-space:normal; box-sizing:content-box; overflow:visible;', 0); sheet.addRule('.ubireportcontainer .dialog div', 'position:static; white-space:normal; box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer .dialog input', 'position:static; white-space:normal; box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer .textitem', 'position: absolute; border: 0px; margin:0px; padding: 0px; letter-spacing: 0px; overflow: hidden; box-sizing:content-box;', 0); sheet.addRule('.ubireportcontainer .textitem td', 'margin:0px; padding:0px; word-wrap:break-word; white-space:pre-wrap; word-break:break-all; letter-spacing:-0.3px; text-align: center; vertical-align: middle; box-sizing:content-box;', 0); sheet.addRule('.ubireportdlgcontainer', 'white-space:normal; box-sizing:content-box;', 0); sheet.addRule('.ubireportdlgcontainer div', 'white-space:normal; box-sizing:content-box;', 0); } catch(e) { sheet.insertRule('.ubireportcontainer { white-space:normal; box-sizing:content-box; }', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer div { box-sizing:content-box; }', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .toolbar {position:relative; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .toolbar div {position:relative; white-space:normal; box-sizing:content-box; overflow:visible;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .toolbar input {position:relative; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .dialog {position:absolute; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .dialog div {position:static; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .dialog input {position:static; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .textitem {position: absolute; border: 0px; margin:0px; padding: 0px; letter-spacing: 0px; overflow: hidden; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .textitem td { margin:0px; padding:0px; word-wrap:break-word; white-space:pre-wrap; word-break:break-all; letter-spacing:-0.3px; text-align: center; vertical-align: middle; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportdlgcontainer { white-space:normal; box-sizing:content-box; }', sheet.cssRules.length); sheet.insertRule('.ubireportdlgcontainer div { box-sizing:content-box; }', sheet.cssRules.length); } } else { sheet.insertRule('.ubireportcontainer { white-space:normal; box-sizing:content-box; }', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer div { box-sizing:content-box; }', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .toolbar {position:relative; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .toolbar div {position:relative; white-space:normal; box-sizing:content-box; overflow:visible;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .toolbar input {position:relative; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .dialog {position:absolute; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .dialog div {position:static; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .dialog input {position:static; white-space:normal; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .textitem {position: absolute; border: 0px; margin:0px; padding: 0px; letter-spacing: 0px; overflow: hidden; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportcontainer .textitem td { margin:0px; padding:0px; word-wrap:break-word; white-space:pre-wrap; word-break:break-all; letter-spacing:-0.3px; text-align: center; vertical-align: middle; box-sizing:content-box;}', sheet.cssRules.length); sheet.insertRule('.ubireportdlgcontainer { white-space:normal; box-sizing:content-box; }', sheet.cssRules.length); sheet.insertRule('.ubireportdlgcontainer div { box-sizing:content-box; }', sheet.cssRules.length); } } else { alert('[UbiReport] StyleSheets is null!'); }; } this.divMain=null; this.divToolbar=null; this.divPreviewFrame=null; this.divCanvas=null; this.divLoadImage=null; this.divMsg=null; this.toolbar=null; this.ubidoc=null; this.divMain=document.getElementById(params.divid); var divMain=this.divMain; divMain.style.textAlign="center"; divMain.className="ubireportcontainer"; this.divToolbar=document.createElement("div"); var divToolbar=this.divToolbar; divToolbar.id=params.divid + "_toolbar"; if( params.toolbar == "false" ) this.toolbarHeight=0; divToolbar.className="toolbar"; divToolbar.style.height=this.toolbarHeight + 'px'; divToolbar.style.whiteSpace="nowrap"; divToolbar.style.overflow="hidden"; divToolbar.style.backgroundColor=styles.toolbarbgcolor; if( params.toolbar == "true" ) divToolbar.style.borderBottom="1px solid #767676"; divMain.appendChild(divToolbar); this.toolbar=new UbiPreviewToolbar(this); if (params.iswa == true || params.iswa == "true") { this.toolbar.applyWA(params.divid); } this.toolbar.setCurrScale(params.scale); this.toolbar.setVisibleToolbar("PRINTSET", false); this.toolbar.setVisibleToolbar("PRINT_UBI", _ubi_strToBool(this.params.useplugin)); if (this.params.language == 'ko') { this.toolbar.setMenuTextToolbar('HML', '\uD55C\uAE00'); this.toolbar.setMenuTextToolbar('CELL', '\uD55C\uC140'); } if (_ubi_strToBool(params.isredbc) == true) { this.toolbar.setVisibleToolbar("SAVE", false); this.toolbar.setVisibleToolbar("PRINT_PDF", false); this.toolbar.setVisibleToolbar("PRINT_HTML", false); this.toolbar.setVisibleToolbar("PRINT_UBI", false); this.toolbar.setVisibleToolbar("PRINTSET", false); this.setPrintMenu("PDF"); } this.divPreviewFrame=document.createElement("div"); var divPreviewFrame=this.divPreviewFrame; divPreviewFrame.id=params.divid + "_previewframe"; if( params.bgimage == "" ) divPreviewFrame.style.backgroundColor=params.bgcolor; else divPreviewFrame.style.backgroundImage="url(" + params.bgimage + ")"; divPreviewFrame.style.position="relative"; divPreviewFrame.style.margin="0px"; divPreviewFrame.style.padding="0px"; divPreviewFrame.style.width="100%"; divPreviewFrame.style.height=(parseInt(divMain.style.height) - parseInt(divToolbar.style.height)) + 'px'; divPreviewFrame.style.overflow="auto"; divPreviewFrame.style.textAlign="center"; divPreviewFrame.style.whiteSpace="normal"; divPreviewFrame.style.MozUserSelect="none"; divPreviewFrame.style.webkitUserSelect="none"; divMain.appendChild(divPreviewFrame); var tmpviewer=this; _ubi_AddEvent(divPreviewFrame, "scroll", function(){ tmpviewer.divPreviewFrame.click(); clearTimeout(tmpviewer._scrollUpdateTimerID); tmpviewer._scrollUpdateTimerID=setTimeout(function(){tmpviewer._scrollUpdate();},100); }); if (!_ubi_lowerIE9()) { _ubi_AddEvent(divPreviewFrame, "touchmove", function (evt) { evt.stopPropagation(); }); _ubi_AddEvent(divPreviewFrame, "mousewheel", function (evt) { evt.stopPropagation(); }); } this.divMsg=document.createElement("div"); var divMsg=this.divMsg; divMsg.id=params.divid + "_msg"; divMsg.style.display="none"; divMsg.style.position="absolute"; divMsg.style.left=(parseInt(this.divMain.style.width) - this.msgWidth) / 2 + "px"; divMsg.style.top=(parseInt(this.divMain.style.height) - this.msgHeight) / 2 + "px"; divMsg.style.width=(this.msgWidth + "px"); divMsg.style.height=(this.msgHeight + "px"); divMsg.style.fontFamily="Tahoma"; divMsg.style.fontSize="11px"; divMsg.style.margin="0 auto"; divMsg.style.backgroundColor="#f3f3f3"; divMsg.style.border="2px solid #000000"; divMain.appendChild(divMsg); this.divDisable=document.createElement("div"); this.divDisable.style.display="none"; this.divDisable.style.position="absolute"; this.divDisable.style.left='0px'; this.divDisable.style.top='0px'; if (__ubi_isIE && __ubi_ieVersion <= 9) { this.divDisable.style.backgroundColor='rgb(190,190,190)'; this.divDisable.style.filter="alpha(opacity=50)"; } else { this.divDisable.style.backgroundColor='rgba(190,190,190,0.5)'; } divMain.appendChild(this.divDisable); this.divLoadImage=document.createElement("div"); var loadImgWidth=54; var loadImgHeight=55; var divLoadImage=this.divLoadImage; divLoadImage.style.display="none"; divLoadImage.style.position="absolute"; divLoadImage.style.left=(parseInt(divMain.style.width) - loadImgWidth)/2 + 'px'; divLoadImage.style.top=(parseInt(divMain.style.height) - loadImgHeight)/2 + 'px'; divLoadImage.style.width=loadImgWidth + "px"; divLoadImage.style.height=loadImgHeight + "px"; divLoadImage.style.margin="0 auto"; var loadImg="<img src='" + params.resource + "/images/page_loading.gif' width='" + loadImgWidth + "px' height='" + loadImgHeight + "px' style='position:relative'>"; divLoadImage.innerHTML=loadImg; divMain.appendChild(divLoadImage); divMain.appendChild(this._createErrorDialog()); divMain.appendChild(this._createProgress()); divMain.appendChild(this._createStatusBar()); }, resize : function() { try{ if(this.params) { this.divPreviewFrame.style.height=(parseInt(document .getElementById(this.params.divid).style.height) - parseInt(document.getElementById(this.params.divid + "_toolbar").style.height)) + 'px'; if (this.toolbar) { var scale=this.toolbar.getCurrScale(); if (scale == "PageWidth" || scale == "WholePage") { var viewer=this; setTimeout(function(){viewer._changeScale();},5); } } } }catch(e){} }, destroy : function() { _ubi_RemoveAddEvent(this.divPreviewFrame, "scroll", this._scrollUpdate); this.toolbar.destroy(); }, _enableViewer : function() { this.divDisable.style.display="none"; }, _disableViewer : function() { this.divDisable.style.width=this.divMain.style.width; this.divDisable.style.height=this.divMain.style.height; this.divDisable.style.display=""; }, _jobStart : function() { if( !_ubi_strToBool(this.params.disabledivhide) ) { this._disableViewer(); } this.divLoadImage.style.display=""; this.divMain.style.cursor="progress"; }, _jobEnd : function() { this.divLoadImage.style.display="none"; this.divMain.style.cursor="default"; if( !_ubi_strToBool(this.params.disabledivhide) ) { this._enableViewer(); } }, _showErrorDialog : function(title, msg) { document.getElementById(this.vid+'UbiToolbarPop_Error_Title').innerText=title; document.getElementById(this.vid+'UbiToolbarPop_Error_Contents').innerHTML=msg; document.getElementById(this.vid+'UbiToolbarPop_Error').style.display=''; }, _showStatusBar : function(msg) { document.getElementById(this.vid+'_UbiStatus_Msg').innerText=msg; document.getElementById(this.vid+'_UbiStatus').style.display=''; }, _closeStatusBar : function() { var statusobj=document.getElementById(this.vid+'_UbiStatus'); if (statusobj) { statusobj.style.display='none'; } }, _setStatusBar : function(msg, pagemsg) { document.getElementById(this.vid+'_UbiStatus_Msg').innerText=msg; document.getElementById(this.vid+'_UbiStatus_PageMsg').innerText=pagemsg; }, _showProgress : function(msg) { this._disableViewer(); document.getElementById(this.vid+'_UbiProgress_Msg').innerText=msg; document.getElementById(this.vid+'_UbiProgress_Position').style.width=0 + "px"; document.getElementById(this.vid+'_UbiProgress').style.display=''; }, _closeProgress : function() { document.getElementById(this.vid+'_UbiProgress').style.display='none'; this._enableViewer(); }, _setProgress : function(msg, page, totalpage) { var pos=0; if (page != undefined && _ubi_isNumber(page)) { var barwidth=196; var edgewidth=7*2; pos=Math.floor((barwidth - edgewidth) * (parseInt(page) / totalpage)); msg += " ("+ page +"/"+ totalpage +")"; } document.getElementById(this.vid+'_UbiProgress_Msg').innerText=msg; document.getElementById(this.vid+'_UbiProgress_Position').style.width=pos + "px"; }, _createErrorDialog : function() { var str=[]; var i=0; var obj=document.createElement("div"); obj.id=this.vid+"UbiToolbarPop_Error"; obj.className="dialog"; obj.style.cssText='display:none;position:absolute;z-index:999999104;left:50%;top:50%;width:450px;height:300px;margin-left:-225px;margin-top:-150px;border:1px solid #555555; background:#fff;'; str[i++]="<div style='width:100%; margin:0px;'>"; str[i++]=" <div style='background:#a22020; padding:11px 15px 12px 15px; font: bold 20px Dotum; color:#fff;text-align:left;'>Error<br>"; str[i++]=" <span id='"+this.vid+"UbiToolbarPop_Error_Title' style='font-size:9pt; color:white;'>" + _ubi_getMessage(this.params.language, "ErrMsg") + "</span>"; str[i++]=" </div>"; str[i++]=" <div style='width:420px; padding:15px 15px; background:#fff;'>"; str[i++]=" <div id='"+this.vid+"UbiToolbarPop_Error_Contents' style='border:1px solid #bdbdbd; text-align:left; white-space:pre-wrap; word-break:break-all; font-size: 14px; color:#000;height:150px;'>"; str[i++]=" </div>"; str[i++]=" </div>"; str[i++]=" <div style='height:45px;margin-top:10px; text-align:center; overflow:hidden'>"; str[i++]=" <input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#666666;' onclick=\"document.getElementById('"+this.vid+"UbiToolbarPop_Error').style.display='none';\" value='" + _ubi_getMessage(this.params.language, "Button_OK") + "'>"; str[i++]=" </div>"; str[i++]="</div>"; obj.innerHTML=str.join(""); return obj; }, _createProgress : function() { var str=[]; var obj=document.createElement("div"); obj.id=this.vid + "_UbiProgress"; obj.className="dialog"; obj.style.cssText="display:none; position: absolute; left:50%; top:50%; margin-left:-120px; margin-top:-32px; width:240px; height:65px; z-index: 999999101; padding: 2px; border: 1px solid rgb(80, 80, 80); border-image: none; overflow: hidden; background-color: #646464;"; str.push(" <div style=\"position:absolute; top:15px; left:20px; width:220px; height:16px; margin:0px; padding:0px; font-family:맑은고딕,Tahoma; font-size:12px; color:white;\">"); str.push(" <table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"margin:0px; padding:0px;\">"); str.push(" <tr>"); str.push(" <td id=\""+ this.vid +"_UbiProgress_Msg\" style=\"width:220px; font-family:맑은고딕,Tahoma; font-size:12px; color:white;\">" + _ubi_getMessage(this.params.language, "ExportMsg") + "</td>"); str.push(" </tr>"); str.push(" </table>"); str.push(" </div>"); str.push(" <div style=\"position:absolute; top:40px; left:20px; background-image:url('" + this.params.resource + "/images/progress_bg_gray.png'); background-repeat:no-repeat; width:196px; height:16px; margin:0px; padding:0px;\">"); str.push(" <table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"margin:0px; padding:0px;\">"); str.push(" <tr height=\"15px\">"); str.push(" <td style=\"width:7px; height:15px; background-image:url('"+ this.params.resource +"/images/progress_left.png'); background-repeat:no-repeat;\"></td>"); str.push(" <td id=\""+ this.vid +"_UbiProgress_Position\" style=\"width:0px; height:15px; background-image:url('"+ this.params.resource +"/images/progress_center.png');\"></td>"); str.push(" <td style=\"width:7px; height:15px; background-image:url('"+ this.params.resource +"/images/progress_right.png'); background-repeat:no-repeat;\"></td>"); str.push(" </tr>"); str.push(" </table>"); str.push(" </div>"); obj.innerHTML=str.join(""); return obj; }, _createStatusBar : function() { var str=[]; var obj=document.createElement("div"); obj.id=this.vid + "_UbiStatus"; obj.className="dialog"; if (_ubi_lowerIE9()) { obj.style.cssText="display:none; position: absolute; right:5%; top:90%; margin-left:-120px; margin-top:-40px; width:240px; height:55px; z-index: 999999101; padding: 2px; border-radius: 10px;border-image: none; overflow: hidden; background-color: rgb(35,114,185); filter:alpha(opacity=40);"; } else { obj.style.cssText="display:none; position: absolute; right:5%; top:90%; margin-left:-120px; margin-top:-40px; width:240px; height:55px; z-index: 999999101; padding: 2px; border-radius: 10px;border-image: none; overflow: hidden; background-color: rgba(35,114,185,0.3);"; } str.push(" <div style=\"position:absolute; top:10px; left:10px; width:220px; height:45px; margin:0px; padding:0px; font-family:맑은고딕,Tahoma; font-size:12px; color:white;\">"); str.push(" <table cellspacing=\"0\" cellpadding=\"0\" border=\"0\" style=\"margin:0px; padding:0px;\">"); str.push(" <tr>"); str.push(" <td id=\""+ this.vid +"_UbiStatus_Msg\" style=\"width:220px; height:20px;vertical-align:middle;font-family:맑은고딕,Tahoma; font-size:12px; color:white;\">" + _ubi_getMessage(this.params.language, "StreamingMsg") + "</td>"); str.push(" </tr>"); str.push(" <tr>"); str.push(" <td id=\""+ this.vid +"_UbiStatus_PageMsg\" style=\"width:220px; height:20px;vertical-align:middle;font-family:맑은고딕,Tahoma; font-size:12px; color:white;\">" + _ubi_getMessage(this.params.language, "StatusWaitMsg") + "</td>"); str.push(" </tr>"); str.push(" </table>"); str.push(" </div>"); obj.innerHTML=str.join(""); return obj; }, _createPreview : function(page) { var divPreview=document.createElement("div"); divPreview.id=this.vid + "_preview_"+ page; divPreview.setAttribute("isloaded", "false"); if (_ubi_strToBool(this.styles.pageborder)) { divPreview.style.border="1px solid "+ this.styles.pagebordercolor; } divPreview.style.backgroundColor="#ffffff"; divPreview.style.marginRight="auto"; divPreview.style.marginLeft="auto"; if (page > 1 && this.styles.pagegap != "") { divPreview.style.marginTop=this.styles.pagegap + "px"; } if (_ubi_strToInt(this.styles.margin) > 0) { if (page == 1) { divPreview.style.marginTop=this.styles.margin + "px"; } if (page == this.totalPage || _ubi_strToBool(this.params.scrollpage) == false) { divPreview.style.marginBottom=this.styles.margin + "px"; } } divPreview.style.position="relative"; divPreview.style.overflow="hidden"; divPreview.style.display="none"; var divLoadImage=document.createElement("div"); divLoadImage.style.position="relative"; divLoadImage.style.top="50%"; divLoadImage.style.width="100%"; divLoadImage.style.height="100%"; divLoadImage.style.margin="0 auto"; divLoadImage.innerHTML="<img src='" + this.params.resource + "/images/page_loading.gif'>"; divPreview.appendChild(divLoadImage); this.divPreviewFrame.appendChild(divPreview); return divPreview; }, _drawPage : function(preview, page) { var isSvg=_ubi_strToBool(this.params.issvg); var scale=this.toolbar.getCurrScale(); var frame=document.getElementById(this.vid+"_previewframe"); var frameWidth=frame.clientWidth; if (page == 1 && (scale == "PageWidth" || scale == "WholePage")) { frameWidth -= 17; } var frameHeight=frame.clientHeight; var framemargin=2; var isloaded=preview.getAttribute("isloaded"); var baseScale=1.0; if (isSvg) { baseScale=2.0; } var ds=1.0; if (scale != "PageWidth" && scale != "WholePage") { scale=parseInt(scale*1.33); ds=parseInt(scale)/100; this.ds=ds; } if (_ubi_strToInt(this.styles.margin) > 0) { framemargin += parseInt(this.styles.margin) * 2; } if (isSvg && isloaded == "true") { var children=preview.children; var svgObj=null; if (children) { svgObj=children[0]; var svgWidth=parseInt(svgObj.getAttribute("orgwidth")); var svgHeight=parseInt(svgObj.getAttribute("orgheight")); if (page == 1) { this.totalPage=parseInt(svgObj.getAttribute("totalpage")); this.params.serviceid=svgObj.getAttribute("serviceid"); this.pageOrientation=svgObj.getAttribute("orientation"); this.pageWidth=svgWidth; this.pageHeight=svgHeight; if (page == this.totalPage) { preview.style.marginBottom=this.styles.margin + "px"; } } preview.setAttribute("orgwidth", svgWidth); preview.setAttribute("orgheight", svgHeight); if (scale == "PageWidth") { ds=(frameWidth-framemargin) / (svgWidth / baseScale); var height=svgHeight / baseScale * ds; if ((height+framemargin) > frameHeight && page == 1) { if (__ubi_isIE && __ubi_ieVersion < 8) { frameWidth=frame.clientWidth - 17; } else { preview.style.height=(height) +"px"; preview.style.display=""; frameWidth=frame.clientWidth; } frameWidth=frame.clientWidth; ds=(frameWidth-framemargin) / (svgWidth / baseScale); } } else if (scale == "WholePage") { ds=Math.min((frameHeight-framemargin) / (svgHeight / baseScale), (frameWidth-framemargin) / (svgWidth / baseScale)); } svgWidth=svgWidth / baseScale * ds; svgHeight=svgHeight / baseScale * ds; var conscale=ds / baseScale; svgObj.setAttribute("width", svgWidth); svgObj.setAttribute("height", svgHeight); if (__ubi_isIE) { svgObj.setAttribute("letter-spacing", (-0.15*baseScale*2)+"px"); } else { svgObj.setAttribute("letter-spacing", (-0.15*baseScale)+"px"); } var gObj=svgObj.childNodes; if (gObj) { for (var i=0; i<gObj.length; i++) { if (gObj[i].tagName == "g") { gObj=gObj[i]; break; } } gObj.setAttribute("transform", "scale("+ conscale +")"); } if (!__ubi_isIE) { preview.innerHTML=""; } preview.style.width=(svgWidth) +"px"; preview.style.height=(svgHeight) +"px"; preview.setAttribute("pagewidth", (svgWidth)); preview.setAttribute("pageheight", (svgHeight)); if (!__ubi_isIE) { preview.appendChild(svgObj); } } } else { if (page == 1) { if (scale == "PageWidth") { ds=(frameWidth-framemargin) / (this.pageWidth / baseScale); var height=this.pageHeight / baseScale * ds; if ((height+framemargin) > frameHeight && (page == 1 || _ubi_strToBool(this.params.scrollpage) == false)) { if (__ubi_isIE && __ubi_ieVersion < 8) { frameWidth=frame.clientWidth - 17; } else { preview.style.height=(height) +"px"; preview.style.display=""; frameWidth=frame.clientWidth; } frameWidth=frame.clientWidth; ds=(frameWidth-framemargin) / (this.pageWidth / baseScale); } } else if (scale == "WholePage") { ds=Math.min((frameHeight-framemargin) / (this.pageHeight / baseScale), (frameWidth-framemargin) / (this.pageWidth / baseScale)); } this.ds=ds; } else { if (scale == "PageWidth" || scale == "WholePage") { ds=this.ds; } } var width=this.pageWidth / baseScale * ds; var height=this.pageHeight / baseScale * ds; preview.style.width=(width) +"px"; preview.style.height=(height) +"px"; if (!isSvg) { var doc=this.ubidoc.doc; var pageobj=doc.pages.GetAt(page - 1); if (pageobj) { var objWidth=0; var objHeight=0; var objLeft=0; var objTop=0; if (pageobj.width > 0) { objWidth=pageobj.width; objHeight=pageobj.height; objLeft=pageobj.left; objTop=pageobj.top; } else { objWidth=doc.docprop.width; objHeight=doc.docprop.height; objLeft=doc.docprop.marginleft; objTop=doc.docprop.margintop; } if (objWidth != this.pageWidth || objHeight != this.pageWidth) { if (scale == "PageWidth") { ds=(frameWidth-framemargin) / (objWidth / baseScale); var height=objHeight / baseScale * ds; if ((height+framemargin) > frameHeight && (page == 1 || _ubi_strToBool(this.params.scrollpage) == false)) { if (__ubi_isIE && __ubi_ieVersion < 8) { frameWidth=frame.clientWidth - 17; } else { preview.style.height=(height) +"px"; preview.style.display=""; frameWidth=frame.clientWidth; } frameWidth=frame.clientWidth; ds=(frameWidth-framemargin) / (objWidth / baseScale); this.ds=ds; } } else if (scale == "WholePage") { ds=Math.min((frameHeight-framemargin) / (objHeight / baseScale), (frameWidth-framemargin) / (objWidth / baseScale)); this.ds=ds; } preview.style.width=(objWidth / baseScale * ds) +"px"; preview.style.height=(objHeight / baseScale * ds) +"px"; } var previewPage=document.createElement("div"); previewPage.id=this.vid + "_previewpage_"+ page; var objRight=doc.docprop.marginright; var objBottom=doc.docprop.marginbottom; previewPage.style.width=(Math.round((objWidth-objLeft-objRight)*ds)+1) + "px"; previewPage.style.marginLeft=Math.round(objLeft*ds) + "px"; previewPage.style.marginTop=Math.round(objTop*ds) + "px"; previewPage.style.position="relative"; if (pageobj.bgcolor != "") { previewPage.style.backgroundColor="#" + pageobj.bgcolor; } if (pageobj.iscusom) { previewPage.style.height="auto"; preview.divPreview.style.height="auto"; } else { previewPage.style.height=(Math.round((objHeight-objTop-objBottom)*ds)+1) +"px"; } preview.innerHTML=""; preview.appendChild(previewPage); this.ubidoc.Draw(previewPage, page, ds); } } } preview.style.display=""; }, _drawPageStream : function(page) { this._requestReportPage(page); var pages=[page-1]; if (this._scrollPageCount > 1) { for (var i=1; i < this._scrollPageCount; i++) { pages.push(page+i); } } else { pages.push(page+1); } var v=this; for (var i=0; i<pages.length; i++) { if (pages[i] > 0 && pages[i] <= this.totalPage) { var streampage=pages[i]; v._requestReportPage(streampage); } } }, _drawRemainPages : function() { if (_ubi_strToBool(this.params.scrollpage) && this._scrollPageCount == -1) { var page_cnt=-1; var pageObj=document.getElementById(this.vid + "_preview_1"); if (pageObj) { var frame=document.getElementById(this.vid+"_previewframe"); var frameHeight=frame.clientHeight; var pageHeight=parseInt(pageObj.style.height); var pageGap=parseInt(this.styles.pagegap); page_cnt=frameHeight / (pageHeight + pageGap); this._scrollPageCount=page_cnt; } } if (this.totalPage > 1) { var preview=null; for (var i=2; i<=this.totalPage; i++) { preview=document.getElementById(this.vid + "_preview_"+ i); if (!preview) { preview=this._createPreview(i); preview.style.width=this.pageWidth; preview.style.height=this.pageHeight; this._drawPage(preview, i); preview.style.display=""; if (this._scrollPageCount > -1 && i <= Math.round(this._scrollPageCount)) { this._requestReportPage(i); } } } } }, _movePage : function(page) { if (_ubi_strToBool(this.params.issvg) || _ubi_strToBool(this.params.scrollpage)) { var preview=document.getElementById(this.vid + "_preview_"+ page); if (preview) { if (page == 1) this.divPreviewFrame.scrollTop=preview.offsetTop - parseInt(this.styles.margin); else this.divPreviewFrame.scrollTop=preview.offsetTop - parseInt(this.styles.pagegap); } } else { this.divPreviewFrame.innerHTML=""; var preview=this._createPreview(page); if (this.ubidoc.doc.pages.GetAt(parseInt(page)-1) == undefined) { this._drawPage(preview, page); this._requestReportPage(page); } else { this._drawPage(preview, page); } } }, _changeScale : function() { if (this.totalPage < 1) return; if (_ubi_strToBool(this.params.issvg) == false) this.divPreviewFrame.innerHTML=""; if (_ubi_strToBool(this.params.scrollpage)) { for (var i=1; i<=this.totalPage; i++) { var preview=null; if (_ubi_strToBool(this.params.issvg) == false) { preview=this._createPreview(i); } else { preview=document.getElementById(this.vid + "_preview_"+ i); } if (preview) this._drawPage(preview, i); } if (_ubi_strToBool(this.params.isStreaming)) { var pagePos=0; var frameHeight=this.divPreviewFrame.clientHeight; for (var i=1; i<=this.totalPage; i++) { pagePos=document.getElementById(this.vid+"_preview_"+i).getBoundingClientRect().top; if(pagePos > 0 && pagePos < frameHeight) { this._requestReportPage(i); } } } if (_ubi_strToBool(this.params.issvg)) { if (!__ubi_isIE) { var tempObj=document.createElement("div"); tempObj.innerHTML=this.divPreviewFrame.innerHTML; this.divPreviewFrame.innerHTML=""; this.divPreviewFrame.innerHTML=tempObj.innerHTML; tempObj.innerHTML=""; tempObj=null;  } } this._movePage(this.toolbar.page); } else { var preview=this._createPreview(this.toolbar.page); this._drawPage(preview, this.toolbar.page); } if (this.events.changeScaleEnd) { this.events.changeScaleEnd(); } }, callUrl : function(strUrl, callback) { function callReport(viewer) { var params=_ubi_clone(viewer.params); params.arg=viewer._getArguments(); _ubi_ajax({ type: "POST", datatype: "text", timeout: params.timeout, url: strUrl, reqdata: params, exportseq: "", returnmsg: "", onSuccess: function(msg) { this.returnmsg=msg; }, onComplete: function() { viewer._jobEnd(); if (callback) { try{ callback(this.returnmsg); } catch(e){} } }, onError: function(msg) { viewer._showErrorDialog("", msg); } }); }; if (strUrl == undefined || strUrl == null || strUrl == "") { return; } this._jobStart(); callReport(this, callback); }, showReport : function(callback) { function createControl(xml, viewer) { viewer.divPreviewFrame.innerHTML=""; var preview=viewer._createPreview(1); if (_ubi_strToBool(viewer.params.issvg)) { preview.innerHTML=decodeURIComponent(xml); preview.setAttribute("isloaded", "true"); viewer._drawPage(preview, 1); } else { var doc=UbiDoc.CreateInstance(xml, true); if (_ubi_strToBool(viewer.params.iswa)) doc.isWA=true; else doc.isWA=false; if(_ubi_strToBool(doc.isEnableNoPage) == false || _ubi_strToBool(viewer.params.usepluginsave)) { viewer.toolbar.enableButton("SaveExcelBase", false); } else { viewer.toolbar.enableButton("SaveExcelBase", true); } if (viewer.params.runtimedata == "") { viewer.isEnableNoPage=_ubi_strToBool(doc.isEnableNoPage); } else { viewer.isEnableNoPage=false; } viewer.ubidoc=new UbiDocument(doc, viewer.vid, viewer.params.jrffile, viewer.params.key, viewer.params.resid, viewer.params.ubiserverurl, viewer.params.exportseq); viewer.params.serviceid=viewer.ubidoc.doc.serviceid; viewer.totalPage=doc.pagecount; viewer.pageWidth=doc.docprop.width; viewer.pageHeight=doc.docprop.height; viewer.pageOrientation=doc.docprop.orientation; viewer._drawPage(preview, 1); } viewer.toolbar.setCurrPage(1); if (viewer.totalPage > 0 && viewer._isMultiDocument && _ubi_strToBool(viewer.params.isStreaming)) { viewer.toolbar.setTotalPage(viewer.totalPage +"+"); } else { viewer.toolbar.setTotalPage(viewer.totalPage); } if (_ubi_strToBool(viewer.params.issvg) || _ubi_strToBool(viewer.params.scrollpage)) { setTimeout(function(){ viewer._drawRemainPages(); }, 10); } }; function requestReport(viewer) { var isError=false; var reqDatatype="xml"; var params=_ubi_clone(viewer.params); params.arg=viewer._getArguments(); params.streamdata=viewer._getDatasets(); if (_ubi_strToBool(params.issvg)) { reqDatatype="text"; } _ubi_ajax({ type: "POST", datatype: reqDatatype, timeout: params.timeout, url: params.ubiserverurl, reqdata: params, exportseq: "", onSuccess: function(xml) { viewer.serviceValid=true; if (xml == null) { viewer._showErrorDialog("", _ubi_getMessage(viewer.params.language, "CreateErrMsg")); isError=true; } else { createControl(xml, viewer); viewer.exportSeq=this.exportseq; viewer.params.exportseq=this.exportseq; } }, onComplete: function() { viewer._jobEnd(); if (_ubi_strToBool(viewer.params.isStreaming) && viewer.totalPage > 0) { if( !_ubi_strToBool(viewer.params.statusmsghide) ) viewer._showStatusBar(_ubi_getMessage(viewer.params.language, "StreamingMsg")); } if (_ubi_strToBool(viewer.params.isStreaming) && viewer.serviceValid) { setTimeout(function(){ viewer._receiveTotalPage(callback); }, 100); } var ubiserverurl=viewer.params.ubiserverurl; ubiserverurl=ubiserverurl.toUpperCase(); if (ubiserverurl.indexOf("HTTP") != 0) { ubiserverurl=self.location.protocol +"//"+ self.location.host + viewer.params.ubiserverurl; } else { ubiserverurl=viewer.params.ubiserverurl; } viewer.retrieveUrfUrl=ubiserverurl + "?cHJvY2lk=GATEWAY" + "&key=" + viewer.params.key + "&resid=" + viewer.params.resid + "&jrffile=" + encodeURI(encodeURIComponent(viewer.params.jrffile)) + "&exportseq=" + viewer.exportSeq + "&isStreaming=" + viewer.params.isStreaming + "&serviceid=" + viewer.params.serviceid + "&reporttitle=" + encodeURI(encodeURIComponent(viewer.params.reporttitle)) + "&reqtype="+__ubi_EXPORT_URF; if( _ubi_strToBool(viewer.params.isStreaming) == false && viewer.params.reqtype == "0" ) { if (callback) { try{ callback(); } catch(e){} } } }, onError: function(msg) { viewer.serviceValid=false; if( msg.indexOf("ER0") == -1 ) { msg="ER9999#An unknown error occurred."; viewer._showErrorDialog(_ubi_getMessage(viewer.params.language, "UnknownErrMsg"), msg); return; } else { msg=msg.split("#")[0] + " : " + msg.split("#")[1]; viewer._showErrorDialog("", msg); } } }); }; this._isReceiveTotalpage=false; if (this.params.scale != this.toolbar.getCurrScale()) { this.toolbar.setCurrScale(this.params.scale); } if ( (this.params.toolbar == false && this.toolbarHeight != 0) || (this.params.toolbar == true && this.toolbarHeight == 0) ) { this.setToolbar(this.params.toolbar); } if (_ubi_strToBool(this.params.isStreaming) && ((_ubi_strToBool(this.params.ismultireport) && _ubi_strToInt(this.params.multicount) > 1) || this.params.jrffile.indexOf(",") > 0)) { this._isMultiDocument=true; } else { this._isMultiDocument=false; } this.exportSeq=-1; this.params.reqtype=__ubi_URF; var d=new Date(); this.params.exportseq=d.getTime(); this._jobStart(); requestReport(this, callback); }, _requestReportPage: function(page, isprint, callback) { if (!isprint || isprint == undefined) isprint=false; function createControl(xml, viewer, isprint, callback) { if (_ubi_strToBool(viewer.params.issvg)) { var preview=document.getElementById(viewer.vid + "_preview_"+ page); if (preview) { preview.innerHTML=decodeURIComponent(xml); preview.setAttribute("isloaded", "true"); viewer._drawPage(preview, page); viewer._changeTotalPage(); } } else { var doc=UbiDoc.CreateInstance(xml, false); var viewerDoc=viewer.ubidoc.doc; for ( var i=0; i < doc.colors.GetCount(); i++){ var key=doc.colors.GetAt(i); if (viewerDoc.colors.FindIndex(key) == -1) { viewerDoc.colors.SetAt(key, doc.colors.GetValue(i)); } } for ( var i=0; i < doc.fonts.GetCount(); i++){ var key=doc.fonts.GetAt(i); if (viewerDoc.fonts.FindIndex(key) == -1) { viewerDoc.fonts.SetAt(key, doc.fonts.GetValue(i)); } } for ( var i=0; i < doc.borders.GetCount(); i++){ var key=doc.borders.GetAt(i); if (viewerDoc.borders.FindIndex(key) == -1) { viewerDoc.borders.SetAt(key, doc.borders.GetValue(i)); } } for ( var i=0; i < doc.lines.GetCount(); i++){ var key=doc.lines.GetAt(i); if (viewerDoc.lines.FindIndex(key) == -1) { viewerDoc.lines.SetAt(key, doc.lines.GetValue(i)); } } for ( var i=0; i < doc.objects.GetCount(); i++){ var key=doc.objects.GetAt(i); if (viewerDoc.objects.FindIndex(key) == -1) { viewerDoc.objects.SetAt(key, doc.objects.GetValue(i)); } } viewerDoc.pages.SetAt(page-1, doc.pages.GetAt(0)); if (doc.pages.GetAt(0) != undefined) { var preview=document.getElementById(viewer.vid + "_preview_"+ page); if (preview) { viewer._drawPage(preview, page); viewer._changeTotalPage(); } } } if (callback) callback(); }; function requestReport(viewer, page, isprint, callback) { var reqDatatype="xml"; if (_ubi_strToBool(viewer.params.issvg)) { reqDatatype="text"; } var reqparams={ cHJvY2lk: viewer.params.cHJvY2lk, reqtype: __ubi_PAGE + "#"+ page, key: viewer.params.key || "", ubiserverurl: viewer.params.ubiserverurl || "", timeout: viewer.params.timeout || "60000", jrffile: viewer.params.jrffile || "", resid: viewer.params.resid || "", exportseq: viewer.exportSeq || "", userHeader: viewer.params.userHeader || "", issvg: viewer.params.issvg || "false", serviceid : viewer.params.serviceid }; _ubi_ajax({ type: "POST", datatype: reqDatatype, timeout: viewer.params.timeout, url: viewer.params.ubiserverurl, reqdata: reqparams, onSuccess: function(xml) { viewer.serviceValid=true; if (xml == null) { viewer._showErrorDialog("", _ubi_getMessage(viewer.params.language, "CompleteMsg")); } else { createControl(xml, viewer, isprint, callback); } }, onComplete: function() { }, onError: function(msg) { viewer.serviceValid=false; if( msg.indexOf("ER0") == -1 ) { msg="ER9999#An unknown error occurred."; viewer._showErrorDialog(_ubi_getMessage(viewer.params.language, "UnknownErrMsg"), msg); return; } else { msg=msg.split("#")[0] + " : " + msg.split("#")[1]; viewer._showErrorDialog("", msg); } } }); }; var isLoadedPage=true; if (_ubi_strToBool(this.params.issvg)) { var preview=document.getElementById(this.vid + "_preview_"+ page); if (preview) { var isloaded=preview.getAttribute("isloaded"); if (isloaded == undefined || isloaded == "false") { isLoadedPage=false; requestReport(this, page, isprint, callback); } } } else { if (this.ubidoc.doc.pages.GetAt(parseInt(page)-1) == undefined) { isLoadedPage=false; var viewer=this; setTimeout(function(){requestReport(viewer, page, isprint, callback);},100); } } if (isLoadedPage && callback) { callback(); } }, _receiveTotalPage: function(callback) { var viewer=this; var params=_ubi_clone(viewer.params); params.arg=viewer._getArguments(); params.reqtype=__ubi_TOTAL_PAGE; _ubi_ajax({ type: "POST", datatype: "text", timeout: params.timeout, url: params.ubiserverurl, reqdata: params, onSuccess: function(text) { viewer.serviceValid=true; }, onComplete: function() { viewer._changeTotalPage(); }, onError: function(msg) { viewer.serviceValid=false; if( msg.indexOf("ER0") == -1 ) { msg="ER9999#An unknown error occurred."; viewer._showErrorDialog(_ubi_getMessage(viewer.params.language, "UnknownErrMsg"), msg); return; } else { msg=msg.split("#")[0] + " : " + msg.split("#")[1]; viewer._showErrorDialog("", msg); } }, onStatus: function(status) { if (!status || status.length < 2) { return; } var errMsg=""; var index=0; if( (index=status.indexOf("ER0")) > -1 ) { errMsg=status.substring(index); status=status.substring(0,index); } var pos=status.lastIndexOf("^"); if (pos >= 0) { var msg=status.substring(pos+1); if (!_ubi_lowerIE9()) { try { msg=msg.trim(); } catch (e) {} } var arr=msg.split("#"); if (arr.length == 3) { if (viewer._isMultiDocument) { var preTotalPage=viewer.totalPage; if (arr[1] == '0') { viewer.totalPage=parseInt(arr[0]); viewer.toolbar.setTotalPage(arr[0]); viewer._isReceiveTotalpage=true; var ismultipaper=parseInt(arr[2]); if (ismultipaper == 1) { viewer._isMultiPaper=true; } else { viewer._isMultiPaper=false; } viewer._changeTotalPage(); viewer.toolbar.setStatus(); viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "CompleteMsg"), ''); if( !_ubi_strToBool(viewer.params.statusmsghide) ) setTimeout(function(){viewer._closeStatusBar();},3000); if (callback) { try{ callback(); } catch(e){} } } else { viewer.totalPage=parseInt(arr[0]); viewer.toolbar.setTotalPage(arr[0] +"+"); viewer._isReceiveTotalpage=false; viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "StreamingMsg"), ' ' + arr[0] + _ubi_getMessage(viewer.params.language, "StreamingMsg2")); } if (_ubi_strToBool(viewer.params.scrollpage)) { for (var i=preTotalPage+1; i<=viewer.totalPage; i++) { if (!document.getElementById(viewer.vid + "_preview_"+ i)) { var preview=viewer._createPreview(i); viewer._drawPage(preview, i); if (viewer._scrollPageCount > -1 && i <= Math.round(viewer._scrollPageCount)) { viewer._requestReportPage(i); } } } } } else { if (arr[1] == '0') { viewer._isReceiveTotalpage=true; viewer.toolbar.setStatus(); viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "CompleteMsg"), ''); if( !_ubi_strToBool(viewer.params.statusmsghide) ) setTimeout(function(){viewer._closeStatusBar();},3000); if (callback) { try{ callback(); } catch(e){} } } else { viewer._isReceiveTotalpage=false; if (viewer.params.language == 'ko') { viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "StreamingMsg"), viewer.totalPage + _ubi_getMessage(viewer.params.language, "StreamingMsg3") + arr[0] + _ubi_getMessage(viewer.params.language, "StreamingMsg2")); } else { viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "StreamingMsg"), arr[0] + ' of ' + viewer.totalPage + _ubi_getMessage(viewer.params.language, "StreamingMsg2")); } } } } } else { if( status.indexOf("ER0") == 0 ) { viewer._isReceiveTotalpage=false; viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "TotalpageErrMsg"), ''); if( !_ubi_strToBool(viewer.params.statusmsghide) ) setTimeout(function(){viewer._closeStatusBar();},3000); } } if( errMsg != '' ) { viewer._showErrorDialog(_ubi_getMessage(viewer.params.language, "UnknownErrMsg"), errMsg); viewer._isReceiveTotalpage=false; viewer._setStatusBar(_ubi_getMessage(viewer.params.language, "TotalpageErrMsg"), ''); if( !_ubi_strToBool(viewer.params.statusmsghide) ) setTimeout(function(){viewer._closeStatusBar();},3000); return; } } }); }, _changeTotalPage : function() { if (this._isReceiveTotalpage) { if (_ubi_strToBool(this.params.issvg)) { for(var k=this.totalPage; k > 0; k--) { var preview=document.getElementById(this.vid + "_preview_"+ k); if (preview) { var str=preview.innerHTML; str=str.replace("^totalpage^", ""+this.totalPage); preview.innerHTML=str; } } } else { for(var k=this.ubidoc.doc.totalpageNodes.length-1; k>=0; k--) { var node=this.ubidoc.doc.totalpageNodes[k]; var item=this.ubidoc.doc.totalpageItems[k]; this.ubidoc.doc.totalpageNodes.pop(node); this.ubidoc.doc.totalpageItems.pop(node); var str=""; if (_ubi_lowerIE9()) { str=node.nodeValue; } else { str=node.textContent; } str=str.replace("^totalpage^", ""+this.totalPage); if (_ubi_lowerIE9()) { node.nodeValue=str; } else { node.textContent=str; } str=item.value; str=str.replace("^totalpage^", ""+this.totalPage); item.value=str; } } } }, _scrollUpdate : function() { if (_ubi_strToBool(this.params.scrollpage)) { var pageHeight=this.divPreviewFrame.clientHeight; var pageTop=this.divPreviewFrame.getBoundingClientRect().top; var pageNum=0; var pagePos=0; for(var k=1; k<=this.totalPage; k++) { pagePos=document.getElementById(this.vid+"_preview_"+k).getBoundingClientRect().top; if(pagePos > 0) break; } if(pageTop+pageHeight/2 < pagePos) { pageNum=k-1; } else { pageNum=Math.min(this.totalPage,k); } this.toolbar.setCurrPage(pageNum); this._drawPageStream(pageNum); } }, _printPDF : function(isPrintSet) { if (!isPrintSet || isPrintSet == undefined) isPrintSet=false; if (_ubi_strToBool(this.params.isredbc) && (!_ubi_strToBool(this.params.useAdobeReader) && __ubi_isIE)) { this._exportReport(__ubi_EXPORT_PDF); return; } if (__ubi_isFF || __ubi_isSafari || __ubi_isEdge || (__ubi_isChrome && this.params.password != "")) { var obj=document.getElementById(this.vid +"Popup_PdfDownLoad_Message"); if (obj) { obj.style.display=""; } return; } var viewer=this; var params=_ubi_clone(viewer.params); params.arg=viewer._getArguments(); if (params.language == 'ko') { viewer._showProgress("\uc778\uc1c4 \uc900\ube44 \uc911\uc785\ub2c8\ub2e4."); } else { viewer._showProgress("Please wait while the file is generated for printing."); } params.reqtype=__ubi_EXPORT_JOB; params.reqsubtype=__ubi_EXPORT_PDF; _ubi_ajax({ type: "POST", datatype: "text", timeout: params.timeout, url: params.ubiserverurl, reqdata: params, flag: true, filename: "", onSuccess: function(xml) { this.flag=true; if (this.filename == "" || this.filename == undefined) { var pos=status.lastIndexOf("^"); if (pos >= 0) { var msg=status.substring(pos+1); if (!_ubi_lowerIE9()) { try { msg=msg.trim(); } catch (e) {} } var arr=msg.split("#"); if (arr[0] == "filename") this.filename=arr[1]; } } }, onComplete: function() { viewer._printEnd(this.flag, this.filename, isPrintSet); }, onError: function(msg) { this.flag=false; if( msg.indexOf("ER0") == -1 ) { msg="ER9999#An unknown error occurred."; viewer._showErrorDialog(_ubi_getMessage(viewer.params.language, "UnknownErrMsg"), msg); return; } else { msg=msg.split("#")[0] + " : " + msg.split("#")[1]; viewer._showErrorDialog("", msg); } }, onStatus: function(status) { var pos=status.lastIndexOf("^"); if (pos >= 0) { var msg=status.substring(pos+1); if (!_ubi_lowerIE9()) { try { msg=msg.trim(); } catch (e) {} } var arr=msg.split("#"); if (arr[0] == "page") { if (viewer.params.language == 'ko') { viewer._setProgress("\uc778\uc1c4 \uc900\ube44 \uc911\uc785\ub2c8\ub2e4.", arr[1], viewer.totalPage); } else { viewer._setProgress("Please wait while the file is generated for printing.", arr[1], viewer.totalPage); } } else if (arr[0] == "info") { viewer._setProgress(arr[1], null); } else if (arr[0] == "filename") { this.filename=arr[1]; } } } }); }, _printEnd : function(flag, filename, isPrintSet) { this._closeProgress(); var pdfobj=null; var divPrint=document.getElementById(this.vid + "_print"); if (!divPrint) { divPrint=document.createElement("div"); divPrint.id=this.vid + "_print"; this.divMain.appendChild(divPrint); } var isAdobePrint=false; if( __ubi_isIE) { if (_ubi_strToBool(this.params.useAdobeReader)) { if( _ubi_checkPdfReader() ) { pdfobj=document.createElement("object"); pdfobj.setAttribute('id', this.vid+'UbiPdfDoc'); pdfobj.setAttribute('classid', 'CLSID:CA8A9780-280D-11CF-A24D-444553540000'); pdfobj.setAttribute('type', 'application/pdf'); pdfobj.style.position="absolute"; pdfobj.style.top="0px"; pdfobj.style.width="0px"; pdfobj.style.height="0px"; divPrint.appendChild(pdfobj); try { pdfVersion=pdfobj.getVersions(); pdfVersion=pdfVersion.substring(pdfVersion.indexOf('=')+1, pdfVersion.indexOf('.')); if (((__ubi_ieVersion > 10) && parseInt(pdfVersion) < 10) || parseInt(pdfVersion) <= 6) { isAdobePrint=false; } else { isAdobePrint=true; } } catch(e){ isAdobePrint=false; } } else { isAdobePrint=false; } } else { isAdobePrint=false; } if( isAdobePrint ) { var userparamUrl=""; if (this.events.getUserParams) { var userparams=this.events.getUserParams(); if (userparams != undefined) { for ( var i=0; i < userparams.length; i+=2) { var str="&" + userparams[i] + "=" + userparams[i+1]; userparamUrl += str; } } } var url=""; var ubiserverurl=this.params.ubiserverurl; ubiserverurl=ubiserverurl.toUpperCase(); if (ubiserverurl.indexOf("HTTP") != 0) { ubiserverurl=self.location.protocol +"//"+ self.location.host + this.params.ubiserverurl; } else { ubiserverurl=this.params.ubiserverurl; } url=ubiserverurl + "?cHJvY2lk=GATEWAY&reqtype=" + __ubi_EXPORT_RESULT + "&jrffile=" + this.params.jrffile + "&resid=" + this.params.resid + "&key=" + this.params.key + "&arg=&pagenum=&imageid=&exportseq=" + this.exportSeq + "&isvoiceye=" + this.params.isvoiceye + "&isStreaming=" + this.params.isStreaming + "&exportfilename=" + filename + "&reqsubtype=2" + "&serviceid=" + this.params.serviceid; if (userparamUrl != "") { url += userparamUrl; } pdfobj.src=url; if (isPrintSet) { pdfobj.setCurrentPage(this.page); pdfobj.printWithDialog(); } else { pdfobj.printAll(); } if (this.events.printEnd) { this._isPrintPDF=true; this.events.printEnd(true); } } else { if (this.ieAdobeReaderInfoPopup) { this.toolbar.makePrintPdfErrorMessage(flag, filename); var obj=document.getElementById(this.vid +"Popup_PdfError_Message"); if (obj) { obj.style.display=""; } } else { this._isPrintPDF=true; this._exportEnd(flag, filename); } } } else { if (__ubi_isChrome || __ubi_isOpera || __ubi_isWhale) { var framename=this.vid + '_ubipdf'; var formname=this.vid + '_pdfForm'; var events=this.events; var postUrl=[]; postUrl.push("<iframe id='" + framename + "' name='" + framename + "' width='200' height='200' style='position:absolute; top:20px; left:50px; display:none;'></iframe>"); postUrl.push(" <form name='" + formname + "' method='post' action='" + this.params.ubiserverurl + "#toolbar=1' target='" + framename + "'>"); var inputArray=[]; inputArray.push("<input type='hidden' name='cHJvY2lk' value='GATEWAY'>\n"); inputArray.push("<input type='hidden' name='reqtype' value='94'>\n"); inputArray.push("<input type='hidden' name='reqsubtype' value='2'>\n"); inputArray.push("<input type='hidden' name='exportfilename' value='" + encodeURIComponent(filename) + "'>\n"); inputArray.push("<input type='hidden' name='jrffile' value='" + encodeURIComponent(this.params.jrffile) + "'>\n"); inputArray.push("<input type='hidden' name='resid' value='" + this.params.resid + "'>\n"); inputArray.push("<input type='hidden' name='key' value='" + this.params.key + "'>\n"); inputArray.push("<input type='hidden' name='serviceid' value='" + this.params.serviceid + "'>\n"); inputArray.push("<input type='hidden' name='exportseq' value='" + this.exportSeq + "'>\n"); inputArray.push("<input type='hidden' name='isvoiceye' value='" + this.params.isvoiceye + "'>\n"); inputArray.push("<input type='hidden' name='isStreaming' value='" + this.params.isStreaming + "'>\n"); if (this.events.getUserParams) { var userparams=this.events.getUserParams(); if (userparams != undefined) { for ( var i=0; i < userparams.length; i+=2) { var str="<input type='hidden' name='" + userparams[i] + "' value='" + userparams[i+1] + "'>"; inputArray.push(str); } } } postUrl.push(inputArray.join('')); postUrl.push("</form>"); divPrint.innerHTML=postUrl.join(''); if (document.forms[formname] == undefined) { divPrint.innerHTML="<iframe id='" + framename + "' name='" + framename + "' width='200' height='200' style='position:absolute; top:20px; left:50px; display:none;'></iframe>"; var formobj=document.createElement("form"); formobj.method='post'; formobj.name=formname; formobj.action=this.params.ubiserverurl + "#toolbar=1"; formobj.target=framename; divPrint.appendChild(formobj); formobj.innerHTML=inputArray.join(""); } document.forms[formname].submit(); var ifr=document.getElementById(framename); var params=this.params; var intervalCnt=0; self.interval=setInterval(function() { var isComplete=false; try { intervalCnt++; if (document.getElementById(framename).contentWindow.location.href != 'about:blank' && ifr.contentDocument.readyState === 'complete') { isComplete=true; clearInterval(self.interval); document.getElementById(framename).focus(); document.getElementById(framename).contentWindow.print(); if (events.printEnd) { events.printEnd(true); } } if (intervalCnt >= 30) { clearInterval(self.interval); var w=window.open('', 'Ubi_PDF','menubar=no,toolbar=no,status=no,scrollbars=no'); divPrint.innerHTML=""; var formobj=document.createElement("form"); formobj.name='pdfForm'; formobj.method='post'; formobj.action=params.ubiserverurl + '#toolbar=1'; formobj.target='Ubi_PDF'; formobj.innerHTML=inputArray.join(''); divPrint.appendChild(formobj); document.pdfForm.submit(); if (events.printEnd) { events.printEnd(true); } } } catch (e) { clearInterval(self.interval); var w=window.open('', 'Ubi_PDF','menubar=no,toolbar=no,status=no,scrollbars=no'); divPrint.innerHTML=""; var formobj=document.createElement("form"); formobj.name='pdfForm'; formobj.method='post'; formobj.action=params.ubiserverurl + '#toolbar=1'; formobj.target='Ubi_PDF'; formobj.innerHTML=inputArray.join(''); divPrint.appendChild(formobj); document.pdfForm.submit(); if (events.printEnd) { events.printEnd(true); } } }, 100); } else if (__ubi_isMobile) { var w=window.open('', 'Ubi_PDF','menubar=no,toolbar=no,status=no,scrollbars=no'); var postUrl="<form name='pdfForm' method='post' action='" + this.params.ubiserverurl + "#toolbar=1' target='Ubi_PDF'>"; postUrl += "<input type='hidden' name='cHJvY2lk' value='GATEWAY'>"; postUrl += "<input type='hidden' name='reqtype' value='94'>"; postUrl += "<input type='hidden' name='reqsubtype' value='2'>"; postUrl += "<input type='hidden' name='exportfilename' value='" + encodeURIComponent(filename) + "'>"; postUrl += "<input type='hidden' name='jrffile' value='" + encodeURIComponent(this.params.jrffile) + "'>"; postUrl += "<input type='hidden' name='resid' value='" + this.params.resid + "'>"; postUrl += "<input type='hidden' name='key' value='" + this.params.key + "'>"; postUrl += "<input type='hidden' name='serviceid' value='" + this.params.serviceid + "'>"; postUrl += "<input type='hidden' name='exportseq' value='" + this.exportSeq + "'>"; if (this.events.getUserParams) { var userparams=this.events.getUserParams(); if (userparams != undefined) { for ( var i=0; i < userparams.length; i+=2) { var str="<input type='hidden' name='" + userparams[i] + "' value='" + userparams[i+1] + "'>"; postUrl += str; } } } postUrl += "</form>"; divPrint.innerHTML=postUrl; document.pdfForm.submit(); if (this.events.printEnd) { this.events.printEnd(true); } } else { this._isPrintPDF=true; this._exportEnd(flag, filename); } } }, _printRetrieveAll : function(pagefrom, pageto) { var page=pagefrom - 1; var viewer=this; this._jobStart(); retrievePage(); function retrievePage() { if (page < pageto) { page++; viewer._requestReportPage(page, true, retrievePage); } else { viewer._printHTML(pagefrom, pageto); } }; }, _printHTML : function(pagefrom, pageto) { this._jobStart(); var divPrint=document.createElement("div"); divPrint.style.display="none"; this.divMain.appendChild(divPrint); var issvg=_ubi_strToBool(this.params.issvg); if (!issvg) { var doc=this.ubidoc.doc; var ds=1.2; var pagewidth=Math.round(doc.docprop.width*ds - doc.docprop.marginleft*ds - doc.docprop.marginright*ds); var pageheight=Math.round(doc.docprop.height*ds - doc.docprop.margintop*ds - doc.docprop.marginbottom*ds); for( var i=pagefrom; i <= pageto; i++ ) { var divPreviewPage=document.createElement("div"); divPreviewPage.style.position="relative"; divPreviewPage.style.width=pagewidth +"px"; divPreviewPage.style.height=pageheight +"px"; if (i > pagefrom && i > 1) { divPreviewPage.style.marginTop=doc.docprop.margintop*ds + "px"; divPreviewPage.style.pageBreakBefore="always"; } divPrint.appendChild(divPreviewPage); this.ubidoc.Draw(divPreviewPage, i, ds, true); } } var win=window.open("about:blank", "UbiReportPrint", "width=800px, height=600px,menubar=no,toolbar=no,status=no,scrollbars=yes"); var viewer=this; setTimeout(function() { _printHTMLWrite(viewer, win, ds); }, 500); function _printHTMLWrite(viewer, win, ds) { var marginLeft=0; var marginTop=0; function convertPixelToMm(pixel) { return pixel * (25.4 / 72) / 10; }; var doc=null; var clist=null; if (!issvg) { doc=viewer.ubidoc.doc; clist=viewer.ubidoc.canvaslist; marginLeft=convertPixelToMm(doc.docprop.marginleft); marginTop=convertPixelToMm(doc.docprop.margintop); } var contents=[]; contents.push("<!DOCTYPE html>\n"); contents.push("<html><head>"); contents.push("<title>Print</title>"); contents.push("<style type='text/css'>\n"); contents.push("@media print{\n"); contents.push("@page {size: "+viewer.pageOrientation.toLowerCase()+"; margin:0;}\n"); contents.push(" #header{display: none;}\n"); contents.push(" #sidebar{display: none;}\n"); contents.push(" #footer{display: none;}\n"); contents.push(" BODY {margin-left: "+marginLeft+"cm; margin-top: "+marginTop+"cm; background: transparent; width:auto; } \n"); contents.push(" }\n"); if (!issvg) { contents.push(".textitem { position: absolute; border: 0px; margin:0px; padding: 0px; letter-spacing: 0px; overflow: hidden; box-sizing:content-box; }\n"); contents.push(".textitem td { margin:0px; padding:0px; word-wrap:break-word; white-space:pre-wrap; word-break:break-all; letter-spacing:-0.3px; text-align: center; vertical-align: middle; box-sizing:content-box; }\n"); contents.push(viewer.ubidoc.GetReportStyle(doc, ds)); } contents.push("</style>\n"); if (!issvg && clist.length > 0) { contents.push("<!--[if IE]><script src=\""+viewer.params.resource+"/ubiexcanvas.js\"></script><![endif]-->\n"); } contents.push("<script language='javascript'>\n"); contents.push("var _ubi_print_imgcount=0;\n"); contents.push("function CanvasDrawRect(canvas, linewidth, strokestyle, fillstyle, isround, radius) {\n"); contents.push(" if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas);\n"); contents.push(" var ctx=canvas.getContext('2d');\n"); contents.push(" ctx.save();\n"); contents.push(" ctx.lineWidth=linewidth;\n"); contents.push(" ctx.strokeStyle=strokestyle;\n"); contents.push(" ctx.beginPath();\n"); contents.push(" if(isround) {\n"); contents.push(" var x=ctx.lineWidth / 2;\n"); contents.push(" var y=ctx.lineWidth / 2;\n"); contents.push(" var width=canvas.width - ctx.lineWidth;\n"); contents.push(" var height=canvas.height - ctx.lineWidth;\n"); contents.push(" ctx.beginPath();\n"); contents.push(" ctx.moveTo(x,y+radius);\n"); contents.push(" ctx.lineTo(x,y+height-radius);\n"); contents.push(" ctx.quadraticCurveTo(x,y+height,x+radius,y+height);\n"); contents.push(" ctx.lineTo(x+width-radius,y+height);\n"); contents.push(" ctx.quadraticCurveTo(x+width,y+height,x+width,y+height-radius);\n"); contents.push(" ctx.lineTo(x+width,y+radius);\n"); contents.push(" ctx.quadraticCurveTo(x+width,y,x+width-radius,y);\n"); contents.push(" ctx.lineTo(x+radius,y);\n"); contents.push(" ctx.quadraticCurveTo(x,y,x,y+radius);\n"); contents.push(" }\n"); contents.push(" else {\n"); contents.push(" ctx.rect(ctx.lineWidth / 2, ctx.lineWidth / 2, canvas.width - ctx.lineWidth, canvas.height - ctx.lineWidth);\n"); contents.push(" }\n"); contents.push(" ctx.closePath();\n"); contents.push(" if( fillstyle != '' ) {\n"); contents.push(" ctx.fillStyle=fillstyle;\n"); contents.push(" ctx.fill();\n"); contents.push(" }\n"); contents.push(" ctx.stroke();\n"); contents.push(" ctx.restore();\n"); contents.push("};\n"); contents.push("function CanvasDrawCircle(canvas, linewidth, strokestyle, fillstyle) {\n"); contents.push(" if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas);\n"); contents.push(" var ctx=canvas.getContext('2d');\n"); contents.push(" ctx.save();\n"); contents.push(" ctx.lineWidth=linewidth;\n"); contents.push(" ctx.strokeStyle=strokestyle;\n"); contents.push(" var KAPPA=4 * ((Math.sqrt(2) - 1) / 3);\n"); contents.push(" var cx=canvas.width / 2;\n"); contents.push(" var cy=canvas.height / 2;\n"); contents.push(" var rx=cx * KAPPA;\n"); contents.push(" var ry=cy * KAPPA;\n"); contents.push(" ctx.beginPath();\n"); contents.push(" ctx.moveTo(cx, ctx.lineWidth);\n"); contents.push(" ctx.bezierCurveTo(cx + rx, ctx.lineWidth, canvas.width - ctx.lineWidth, cy - ry, canvas.width - ctx.lineWidth, cy);\n"); contents.push(" ctx.bezierCurveTo(canvas.width - ctx.lineWidth, cy + ry, cx + rx, canvas.height - ctx.lineWidth, cx, canvas.height - ctx.lineWidth);\n"); contents.push(" ctx.bezierCurveTo(cx - rx, canvas.height - ctx.lineWidth, ctx.lineWidth, cy + ry, ctx.lineWidth, cy);\n"); contents.push(" ctx.bezierCurveTo(ctx.lineWidth, cy - ry, cx - rx, ctx.lineWidth, cx, ctx.lineWidth);\n"); contents.push(" ctx.closePath();\n"); contents.push(" if( fillstyle != '' ) {\n"); contents.push(" ctx.fillStyle=fillstyle;\n"); contents.push(" ctx.fill();\n"); contents.push(" }\n"); contents.push(" ctx.stroke();\n"); contents.push(" ctx.restore();\n"); contents.push("};\n"); contents.push("function CanvasDrawImage(canvas, imageid, imagesrc, x, y, width, height) {\n"); contents.push(" _ubi_print_imgcount++;\n"); contents.push(" if( !canvas.getContext ) G_vmlCanvasManager.initElement(canvas);\n"); contents.push(" var ctx=canvas.getContext('2d');\n"); contents.push(" var image=new Image();\n"); contents.push(" image.id=imageid;\n"); contents.push(" image.src=imagesrc;\n"); contents.push(" image.onload=function() {\n"); contents.push(" ctx.drawImage(image, x, y, width, height);\n"); contents.push(" _ubi_print_imgcount--;\n"); contents.push(" };\n"); contents.push(" image.onerror=function(){\n"); contents.push(" _ubi_print_imgcount--;\n"); contents.push(" };\n"); contents.push("};\n"); contents.push("function ChildWindowPrintHTML() {\n"); contents.push(" if (_ubi_print_imgcount > 0) {\n"); contents.push(" timer=setTimeout(function() { ChildWindowPrintHTML(); }, 500);\n"); contents.push(" return;\n"); contents.push(" }\n"); if (__ubi_isIE && _ubi_strToBool(viewer.params.printIEobj)) { contents.push(" window.ieExecWB(7, 1);\n"); } else { contents.push(" window.print();\n"); } contents.push(" window.close();\n"); contents.push("};\n"); contents.push("function printStart() { ChildWindowPrintHTML(); };\n"); contents.push("function ieExecWB( intOLEcmd, intOLEparam ) {\n"); contents.push(" var WebBrowser='<OBJECT ID=\"WebBrowser1\" WIDTH=0 HEIGHT=0 CLASSID=\"CLSID:8856F961-340A-11D0-A96B-00C04FD705A2\"></OBJECT>';\n"); contents.push(" document.body.insertAdjacentHTML('beforeEnd', WebBrowser);\n"); contents.push(" if ( ( ! intOLEparam ) || ( intOLEparam < -1 ) || (intOLEparam > 1 ) )\n"); contents.push(" intOLEparam=1;\n"); contents.push(" WebBrowser1.ExecWB( intOLEcmd, intOLEparam );\n"); contents.push(" WebBrowser1.outerHTML=\"\";\n"); contents.push("}\n"); contents.push("</script>\n"); contents.push("</head>\n"); if(__ubi_isIE && viewer.pageOrientation.toLowerCase()=="landscape" && _ubi_strToBool(viewer.params.printIEobj) == false){ contents.push("<body>"); } else { contents.push("<body onload='printStart()'>"); } win.document.open(); win.document.write(contents.join("")); if (issvg) { var preview=null; for (var i=1; i<=viewer.totalPage; i++) { preview=document.getElementById(viewer.vid + "_preview_"+ i); if (preview) { win.document.write(preview.innerHTML); if (i > 1 && i< viewer.totalPage) { win.document.write("<div style='page-break-before:always;'></div>"); } } } } else { win.document.write(divPrint.innerHTML); } if (!issvg && clist.length > 0) { contents="<script>\n"; var listlength=clist.length; for (var i=0; i < listlength; i++) { contents += "var canvas_"+ i +"=document.getElementById('"+clist[i].canvasid+"');\n"; if (clist[i].type == "IMAGE") { contents += "CanvasDrawImage(canvas_"+ i +", '"+clist[i].imageid+"', '"+clist[i].src+"', "+clist[i].x+", "+clist[i].y+", "+clist[i].width+", "+clist[i].height+");\n"; } else if (clist[i].type == "RECT") { contents += "CanvasDrawRect(canvas_"+ i +", "+clist[i].linewidth+", '"+clist[i].strokestyle+"', '"+clist[i].fillstyle+"', false, 0);\n"; } else if (clist[i].type == "ROUNDRECT") { contents += "CanvasDrawRect(canvas_"+ i +", "+clist[i].linewidth+", '"+clist[i].strokestyle+"', '"+clist[i].fillstyle+"', true, "+clist[i].radius+");\n"; } else if (clist[i].type == "CIRCLE") { contents += "CanvasDrawCircle(canvas_"+ i +", "+clist[i].linewidth+", '"+clist[i].strokestyle+"', '"+clist[i].fillstyle+"');\n"; } } contents += "</script>\n"; win.document.write(contents); } win.document.write("</body></html>"); win.focus(); win.document.close(); viewer.divMain.removeChild(divPrint); divPrint=null; viewer.ubidoc.canvaslist=new Array(); viewer._jobEnd(); if (viewer.events.printEnd) { viewer.events.printEnd(true); } }; }, _exportReport : function(type) { var dlgFlag=false; if (_ubi_strToBool(this.params.usepluginsave) || type == __ubi_EXPORT_IMAGE || (type != __ubi_EXPORT_EXCEL2 && _ubi_strToBool(this.params.usepluginsave) == false && parseInt(this.exportsetmode) != 1)) { dlgFlag=true; } if (dlgFlag == true) { var obj=document.getElementById(this.vid +"Popup_ExportDialog"); var iframeobj=document.getElementById(this.vid +"Popup_ExportDialogFrame"); if (obj && iframeobj) { var exportTypeObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_ExportType"); var fileComboObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_FileType"); var saveTypeObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_SaveType"); var exportRangeObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_ExportRange"); var exportmode=parseInt(this.exportsetmode); if (exportmode != 1) { if (exportmode == 2) { var currObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Current"); currObj.checked='checked'; } else if (exportmode == 3) { var pagesObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Pages"); pagesObj.checked='checked'; } else { var allObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_All"); allObj.checked='checked'; } var pageFromObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_PageFrom"); var pageToObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_PageTo"); pageFromObj.value='1'; pageToObj.value=this.totalPage; } exportTypeObj.style.display=""; if (type == __ubi_EXPORT_PDF) fileComboObj.selectedIndex='0'; else if (type == __ubi_EXPORT_EXCEL1) fileComboObj.selectedIndex='1'; else if (type == __ubi_EXPORT_EXCEL2) fileComboObj.selectedIndex='2'; else if (type == __ubi_EXPORT_DOCX) fileComboObj.selectedIndex='3'; else if (type == __ubi_EXPORT_PPTX) fileComboObj.selectedIndex='4'; else if (type == __ubi_EXPORT_HML) fileComboObj.selectedIndex='5'; else if (type == __ubi_EXPORT_CELL) fileComboObj.selectedIndex='6'; else if (type == __ubi_EXPORT_IMAGE) fileComboObj.selectedIndex='7'; if (_ubi_strToBool(this.params.usepluginsave)) { saveTypeObj.style.display=""; var pluginSaveObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Plugin"); pluginSaveObj.checked='checked'; var msgObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_PluginMsg"); if (msgObj) { msgObj.innerHTML=_ubi_getMessage(this.params.language, "SaveFileMsg2"); msgObj.style.display=""; } } else { if (exportmode != 1) { exportRangeObj.style.display=""; } else { exportRangeObj.style.display="none"; } } var imageObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Image"); if (imageObj) { if (type != __ubi_EXPORT_IMAGE) { imageObj.style.display="none"; } else { imageObj.style.display=""; } var zipMsgObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_ZipMsg"); if (zipMsgObj) { if (_ubi_strToBool(this.params.usepluginsave)) { zipMsgObj.innerHTML=""; if (type == __ubi_EXPORT_IMAGE) { zipMsgObj.style.borderBottom="1px solid #bdbdbd"; } } else { zipMsgObj.innerHTML=_ubi_getMessage(this.params.language, "ZipFileMsg"); zipMsgObj.style.borderBottom="none"; } } } obj.style.display=""; var tobj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Table"); var iframeheight=tobj.scrollHeight; iframeobj.height=iframeheight + "px"; obj.style.height=iframeheight + "px"; obj.style.marginTop=(-iframeheight/2) + "px"; } } else { this._exportStart(type); } }, _exportStart : function(type) { var upperExt=this.HmlExtension.toUpperCase(); if (upperExt == 'HWP' && type == __ubi_EXPORT_HML) { type=__ubi_EXPORT_HWP; } var viewer=this; var params=_ubi_clone(viewer.params); params.arg=viewer._getArguments(); var exportTotalPage=this.totalPage; if (parseInt(params.exportPageTo) > 0 && parseInt(params.exportPageFrom) > 0) { exportTotalPage=parseInt(params.exportPageTo) - parseInt(params.exportPageFrom) + 1; } if (params.language == 'ko') { viewer._showProgress("\ud30c\uc77c \uc0dd\uc131\uc911\uc785\ub2c8\ub2e4."); } else { viewer._showProgress("Please wait while the file is generated."); } params.reqtype=__ubi_EXPORT_JOB; params.reqsubtype=type; if (type == __ubi_EXPORT_IMAGE) { params.reqimagetype=viewer._exportImageType; } _ubi_ajax({ type: "POST", datatype: "text", timeout: params.timeout, url: params.ubiserverurl, reqdata: params, flag: true, filename: "", onSuccess: function(xml) { this.flag=true; if (this.filename == "" || this.filename == undefined) { var pos=status.lastIndexOf("^"); if (pos >= 0) { var msg=status.substring(pos+1); if (!_ubi_lowerIE9()) { try { msg=msg.trim(); } catch (e) {} } var arr=msg.split("#"); if (arr[0] == "filename") this.filename=arr[1]; } } }, onComplete: function() { viewer._exportEnd(this.flag, this.filename); }, onError: function(msg) { this.flag=false; msg=msg.split("#")[0] + " : " + msg.split("#")[1]; viewer._showErrorDialog("", msg); }, onStatus: function(status) { var pos=status.lastIndexOf("^"); if (pos >= 0) { var msg=status.substring(pos+1); if (!_ubi_lowerIE9()) { try { msg=msg.trim(); } catch (e) {} } var arr=msg.split("#"); if (arr[0] == "page") { if (viewer.params.language == 'ko') { viewer._setProgress(_ubi_getMessage(viewer.params.language, "ExportMsg"), arr[1], exportTotalPage); } else { viewer._setProgress("Please wait while the file is generated.", arr[1], exportTotalPage); } } else if (arr[0] == "info") { viewer._setProgress(arr[1], null); } else if (arr[0] == "filename") { this.filename=arr[1]; } } } }); }, _exportEnd : function(flag, filename) { this._closeProgress(); if (flag && this._isAutoDownload) { var frameObj=document.getElementById(this.vid +"UbiExportFrame"); if (!frameObj) { frameObj=document.createElement("div"); frameObj.style.position="absolute"; frameObj.style.margin="0px"; frameObj.style.padding="0px"; frameObj.style.left="-1px"; frameObj.style.width="1px"; frameObj.style.height="1px"; frameObj.innerHTML= "<iframe id='"+ this.vid +"UbiExportFrame' name='"+ this.vid +"UbiExportFrame' width='1' height='1' frameborder='0' scrolling='no'></iframe>"; this.divMain.appendChild(frameObj); } var formObj=document.getElementById(this.vid + "UbiExportForm"); if (!formObj) { formObj=document.createElement("form"); formObj.id=this.vid + "UbiExportForm"; formObj.method="POST"; formObj.action=this.params.ubiserverurl; formObj.target=this.vid +'UbiExportFrame'; } if( __ubi_isMobile ) formObj.method='get'; else formObj.method='post'; var innerHtml=[]; innerHtml.push("<input type='hidden' name='cHJvY2lk' value='GATEWAY'>"); innerHtml.push("<input type='hidden' name='reqtype' value='"+ __ubi_EXPORT_RESULT +"'>"); innerHtml.push("<input type='hidden' name='reqsubtype' value='" + this.params.reqsubtype + "'>"); innerHtml.push("<input type='hidden' name='jrffile' value='" + encodeURIComponent(this.params.jrffile) + "'>"); innerHtml.push("<input type='hidden' name='resid' value='" + this.params.resid + "'>"); innerHtml.push("<input type='hidden' name='key' value='" + this.params.key + "'>"); innerHtml.push("<input type='hidden' name='serviceid' value='" + this.params.serviceid + "'>"); innerHtml.push("<input type='hidden' name='reporttitle' value='" + encodeURIComponent(this.params.reporttitle) + "'>"); innerHtml.push("<input type='hidden' name='exportseq' value='" + this.exportSeq + "'>"); innerHtml.push("<input type='hidden' name='exportfilename' value='" + encodeURIComponent(filename) + "'>"); innerHtml.push("<input type='hidden' name='exceladjustpage' value='" + this.params.exceladjustpage + "'>"); if(this.params.excelPrintPaperSize != "") { innerHtml.push("<input type='hidden' name='excelPrintPaperSize' value='" + this.params.excelPrintPaperSize + "'>"); } if(this.params.excelPrintfitWidth != "") { innerHtml.push("<input type='hidden' name='excelPrintfitWidth' value='" + this.params.excelPrintfitWidth + "'>"); } if(this.params.excelPrintfitHeight != "") { innerHtml.push("<input type='hidden' name='excelPrintfitHeight' value='" + this.params.excelPrintfitHeight + "'>"); } if (this.events.getUserParams) { var userparams=this.events.getUserParams(); if (userparams != undefined) { for ( var i=0; i < userparams.length; i+=2) { var str="<input type='hidden' name='" + userparams[i] + "' value='" + userparams[i+1] + "'>"; innerHtml.push(str); } } } formObj.innerHTML=innerHtml.join(""); this.divMain.appendChild(formObj); formObj.submit(); } if (this.events.printEnd && (_ubi_strToBool(this.params.isredbc) || this._isPrintPDF)) { this.events.printEnd(flag); } else { if (this.events.exportEnd) { var exporturl=""; if (this._isAutoDownload == false && filename != undefined && filename != "") { exporturl=this.params.ubiserverurl + "?cHJvY2lk=GATEWAY&reqtype="+__ubi_EXPORT_RESULT + "&key=" + this.params.key + "&resid=" + this.params.resid + "&serviceid=" + this.params.serviceid + "&exportseq=" + this.params.exportseq + "&jrffile=" + this.params.jrffile + "&exportfilename=" + filename; } else { var ext=''; switch(this.params.reqsubtype) { case __ubi_EXPORT_IMAGE : ext='.zip'; break; case __ubi_EXPORT_PDF : ext='.pdf'; break; case __ubi_EXPORT_EXCEL1 : case __ubi_EXPORT_EXCEL2 : ext='.xlsx'; break; case __ubi_EXPORT_RTF : ext='.rtf'; break; case __ubi_EXPORT_HWP : ext='.hwp'; break; case __ubi_EXPORT_PPTX : ext='.pptx'; break; case __ubi_EXPORT_HML : ext='.hml'; break; case __ubi_EXPORT_DOCX : ext='.docx'; break; case __ubi_EXPORT_CELL : ext='.cell'; break; } if (this.params.reporttitle != undefined && this.params.reporttitle != "") { exporturl=this.params.reporttitle + ext; } else if (filename != undefined && filename != "") { exporturl=filename; if (this.params.reqsubtype == __ubi_EXPORT_CELL) { exporturl=exporturl.substring(0, exporturl.lastIndexOf('.')) + ext; } } } this.events.exportEnd(flag, exporturl); } } this._isAutoDownload=true; this._exportImageType=""; }, _linkButtonDown : function(filename, args) { if (this.events.linkButtonDown) { this.events.linkButtonDown(filename, args); } }, setArgument : function(key, value) { if (key == '') return; var replaceStr=String.fromCharCode(26) + '#'.charCodeAt(0) + String.fromCharCode(26); try { value=value.replace(/#/g, replaceStr); } catch (e) { } this._arghash.SetAt(key, value); }, _getArguments : function() { var arghash=new UbiMap(); if (this._arghash && this._arghash.GetCount() > 0) { if (this._arghash) { for (i=0; i<this._arghash.GetCount(); i++) { arghash.SetAt(this._arghash.GetKey(i), this._arghash.GetValue(i)); } } var argArray=[]; for (i=0; i<arghash.GetCount(); i++) { argArray.push(arghash.GetKey(i)); argArray.push('#'); argArray.push(arghash.GetValue(i)); argArray.push('#'); } return argArray.join(''); } return this.params.arg; }, clearDataset : function() { this._datasets=[]; }, setDataset : function(id, data, datatype) { if (!id || id == '') { console.log('[setDataset]ID가 정의되지 않았습니다.'); return; } if (!datatype) { datatype="STREAM"; } datatype=datatype.trim(); if (datatype == '') { datatype="STREAM"; } if (!data) { data=''; } this._datasets.push([id, data, datatype]); }, _getDatasets : function() { if (this._datasets && this._datasets.length > 0) { var _rs_=String.fromCharCode(30); var _nrs_=String.fromCharCode(28); var datasetinfos=[]; datasetinfos.push("HTMLLOCALDATASET:" + _rs_); for (var i=0; i<this._datasets.length; i++) { datasetinfos.push(this._datasets[i][0]); datasetinfos.push(_rs_ + this._datasets[i][2] + _rs_); datasetinfos.push(this._datasets[i][1]); datasetinfos.push(_nrs_); } return datasetinfos.join(''); } return this.params.streamdata; }, aboutbox : function() { this.toolbar.aboutbox(); }, first : function() { this.toolbar.first(); }, previous : function() { this.toolbar.previous(); }, next : function() { this.toolbar.next(); }, last : function() { this.toolbar.last(); }, zoomIn : function() { this.toolbar.zoomin(); }, zoomOut : function() { this.toolbar.zoomout(); }, changeScale : function(scale) { this.toolbar.setscale(scale); }, refresh : function() { this.toolbar.refresh(); }, gopage : function(page) { this.toolbar.movePage(page); }, setPluginVariable : function(key, value) { this.pluginparams.push(key, value); }, clearPluginVariable : function() { this.pluginparams=[]; }, setToolbar : function(flag) { if (flag == true || flag == "true") { this.toolbarHeight=44; } else { this.toolbarHeight=0; } var divToolbar=this.divToolbar; if (divToolbar) { divToolbar.style.height=this.toolbarHeight + 'px'; var divPreviewFrame=this.divPreviewFrame; if (divPreviewFrame) { divPreviewFrame.style.height=(parseInt(this.divMain.style.height) - parseInt(divToolbar.style.height)) + 'px'; } } }, setUserSaveList : function(list) { this.toolbar.setUserSaveList(list); }, setUserPrintList : function(list) { this.toolbar.setUserPrintList(list); }, setVisibleToolbar : function(id, flag) { this.toolbar.setVisibleToolbar(id, flag); }, setMenuTextToolbar : function(id, text) { this.toolbar.setMenuTextToolbar(id, text); }, setEnableToolbar : function(id, flag) { var name=id.toUpperCase(); switch(name) { case "SAVE": this.toolbar.enableButton("SaveButton",flag); this.toolbar.enableButton("SaveDropMenu",flag); break; case "PRINT": this.toolbar.enableButton("PrintButton",flag); this.toolbar.enableButton("PrintDropMenu",flag); break; case "PRINTSET": this.toolbar.enableButton("PrintSetButton",flag); break; case "PRINT_UBI": if (_ubi_strToBool(this.params.useplugin)) { this.toolbar.enableButton("PrintUbi",flag); } else { this.toolbar.enableButton("PrintUbi",false); } break; case "PRINT_PDF": this.toolbar.enableButton("PrintPdf",flag); break; case "PRINT_HTML": this.toolbar.enableButton("PrintHtml",flag); break; } }, setSaveMenu : function(menuType) { var type=__ubi_exportMap[menuType.toUpperCase()]; if (type) { this.toolbar.saveDefaultType=type; } else { this.toolbar.saveDefaultType=""; } }, setPrintMenu : function(menuType) { var type=menuType.toUpperCase(); if (type == "PDF" || type == "HTML" || type == "UBI") { this.toolbar.printDefaultType=type; } else { this.toolbar.printDefaultType=""; } }, setSaveExcelMenu : function(menuType) { var type=__ubi_exportMap[menuType.toUpperCase()]; if (type) { this.toolbar.saveExcelDefaultType=type; } else { this.toolbar.saveExcelDefaultType=""; } }, printHTML : function() { this.toolbar.printHTML(); }, printPDF : function() { this._printPDF(true); }, printSet: function() { this.toolbar.printPLUGIN(true); }, print : function() { this.toolbar.printPLUGIN(false); }, exportReport : function(typename, isplugin) { var upperType=typename.toUpperCase(); var exportType=__ubi_EXPORT_PDF; if (upperType == 'EXCEL') { exportType=__ubi_EXPORT_EXCEL1; } else if (upperType == 'EXCEL_NO') { exportType=__ubi_EXPORT_EXCEL2; if (_ubi_strToBool(isplugin)) { this._showErrorDialog("", _ubi_getMessage(this.params.language, "ExportMsg2")); return; } } else if (upperType == 'PPTX') { exportType=__ubi_EXPORT_PPTX; } else if (upperType == 'HML') { exportType=__ubi_EXPORT_HML; } else if (upperType == 'DOCX') { exportType=__ubi_EXPORT_DOCX; } else if (upperType == 'CELL') { exportType=__ubi_EXPORT_CELL; } else if (upperType == 'IMAGE') { exportType=__ubi_EXPORT_IMAGE; } else { exportType=__ubi_EXPORT_PDF; } if (upperType == 'IMAGE') { var org_usepluginsave=this.params.usepluginsave; this.params.usepluginsave=_ubi_strToBool(isplugin); this._exportReport(exportType); this.params.usepluginsave=org_usepluginsave; } else { if (_ubi_strToBool(isplugin)) { this.toolbar.exportPLUGIN(exportType); } else { this._exportStart(exportType); } } }, exportFile : function(type, subtype, isautodownload) { this._isPrintPDF=false; var type=__ubi_exportMap[type.toUpperCase()]; this._isAutoDownload=true; this._exportImageType=""; if (type) { if (isautodownload != undefined && isautodownload == false) { this._isAutoDownload=false; } if (type == __ubi_EXPORT_IMAGE && subtype != undefined && subtype != "") { this._exportImageType=subtype; } this._exportReport(type); } }, exportPdf : function() { this._isPrintPDF=false; this._exportReport(__ubi_EXPORT_PDF); }, exportExcel : function() { this._exportReport(__ubi_EXPORT_EXCEL1); }, exportExcelNo : function() { this._exportReport(__ubi_EXPORT_EXCEL2); }, exportHml : function() { this._exportReport(__ubi_EXPORT_HML); }, exportDocx : function() { this._exportReport(__ubi_EXPORT_DOCX); }, exportPptx : function() { this._exportReport(__ubi_EXPORT_PPTX); }, exportCell : function() { this._exportReport(__ubi_EXPORT_CELL); }, exportImage : function() { this._exportReport(__ubi_EXPORT_IMAGE); }, setEnableScrollpage : function (flag) { if (_ubi_strToBool(this.params.scrollpage) != _ubi_strToBool(flag)) { this.params.scrollpage=flag; if (_ubi_strToBool(flag)) { setTimeout(this._drawRemainPages(), 10); } else { var curpageid=this.vid + "_preview_"+ this.toolbar.page; var list=document.getElementById(this.divPreviewFrame.id); var lastflag=true; while (list.hasChildNodes()) { if (lastflag) { var child=list.lastChild; if (child.id != curpageid) { list.removeChild(list.lastChild); } else { lastflag=false; } } else { var child=list.firstChild; if (child.id != curpageid) { list.removeChild(list.firstChild); } else { break; } } } } } }, setPluginprogress : function (flag) { this.params.pluginprogress=flag; }, setEnableDefaultSave : function (flag) { if (_ubi_strToBool(this.params.usepluginsave)) { var obj=document.getElementById(this.vid +"Popup_ExportDialog"); var iframeobj=document.getElementById(this.vid +"Popup_ExportDialogFrame"); if (obj && iframeobj) { var pluginSaveObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Plugin"); var defaultSaveObj=iframeobj.contentWindow.document.getElementById(this.vid + "_ExportDialog_Default"); if (_ubi_strToBool(flag) == false) { pluginSaveObj.disabled=true; defaultSaveObj.disabled=true; } else { pluginSaveObj.disabled=false; defaultSaveObj.disabled=false; } } } }});function UbiPreviewToolbar(ubiviewer){ var viewer=ubiviewer; this.buttons=[]; this.buttontds=[]; this.zoomCombo=null; this.pageCombo=null; this.saveList=null; this.excelList=null; this.printList=null; this.toolbarObj=null; var vid=viewer.vid; this.scaleValues=[]; this.scaleDispValues=[]; this.scaleIndex=13; this.page=0; this.saveDefaultType=""; this.printDefaultType=""; this.saveExcelDefaultType=""; this.userSaveList=""; this.userPrintList=""; var infos=[ ["SaveButton", "button", "save.png", "save_o.png", "save_d.png" ], ["SaveText", "text", "Save"], ["SaveDropMenu", "dropdown", "btnarrow.gif", "btnarrow.gif", "btnarrow_dis.gif" ], ["PrintButton", "button", "print.png", "print_o.png", "print_d.png" ], ["PrintText", "text", "Print"], ["PrintDropMenu", "dropdown", "btnarrow.gif", "btnarrow.gif", "btnarrow_dis.gif" ], ["PrintSetButton", "button", "printset.png", "printset_o.png", "printset_d.png" ], ["PrintSetText", "text", "PrintSet "], ["NaviSep", "sep"], ["FirstButton", "button", "first.png", "first_o.png", "first_d.png" ], ["PreviousButton", "button", "previous.png", "previous_o.png", "previous_d.png" ], ["PageCombo", "combo", "", 1], ["TotalPageText", "text", "/ 0"], ["NextButton", "button", "next.png", "next_o.png", "next_d.png" ], ["LastButton", "button", "last.png", "last_o.png", "last_d.png" ], ["ZoomSep", "sep"], ["ZoomOutButton", "button", "zoomout.png", "zoomout_o.png", "zoomout_d.png" ], ["ZoomCombo", "combo", "", 1], ["ZoomInButton", "button", "zoomin.png", "zoomin_o.png", "zoomin_d.png" ], ["RefreshSep", "sep"], ["RefreshButton", "button", "refresh.png", "refresh_o.png", "refresh_d.png" ], ["BlankSep", "blk"], ["AboutButton", "button", "info.png", "info_o.png", "info_d.png" ] ]; var saveinfos=[ ["Pdf", "button", "pdf.png", "pdf_o.png", "pdf_d.png" , "PDF"], ["Xls", "button", "xls.png", "xls_o.png", "xls_d.png" , "Excel"], ["Docx", "button", "rtf.png", "rtf_o.png", "rtf_d.png" , "Word"], ["Pptx", "button", "ppt.png", "ppt_o.png", "ppt_d.png" , "PowerPoint"], ["Hml", "button", "hwp.png", "hwp_o.png", "hwp_d.png" , "HWPML"], ["Cell", "button", "cell.png", "cell_o.png", "cell_d.png" , "HanCell"], ["Image", "button", "image.png", "image_o.png", "image_d.png" , "Image"] ]; var excelinfos=[ ["Print", "button", "print_form.png", "print_form_o.png", "print_form_d.png" , "Print Type"], ["Base", "button", "default_form.png", "default_form_o.png", "default_form_d.png" , "Base Type"] ]; var printinfos=[ ["Pdf", "button", "pdf.png", "pdf_o.png", "pdf_d.png" , "PDF Print"], ["Html", "button", "html.png", "html_o.png", "html_d.png" , "HTML Print"], ["Ubi", "button", "plugin.png", "plugin_o.png", "plugin_d.png" , "UbiViewer Print"] ]; var toolbarfontstyle="font-family: 맑은고딕, Tahoma; font-weight:normal; font-size:12px; letter-spacing:0em; color: #333333; -moz-user-select: none;"; this.initToolbar=function() { this.makeToolbarUI(); this.createCombo(); this.makeZoomList(); this.setStatus(); this.saveList=this.makePopupMenu("Save", this.saveList, saveinfos); this.excelList=this.makePopupMenu("SaveExcel", this.excelList, excelinfos); this.printList=this.makePopupMenu("Print", this.printList, printinfos); this.makeAboutBox(); this.makePrintDialog(); this.makePrintPdfMessage(); this.makeExportDialog(); _ubi_AddEvent(document, "click", clicked); }; this.makeToolbarUI=function() { var tableObj=document.createElement("table"); tableObj.id=viewer.vid+"UbiToolbar_ToolbarCtrl"; tableObj.cellspacing='0'; tableObj.cellpadding='0'; tableObj.style.cssText="width:100%; height:100%; margin:0; padding:0px; border:0px; border-spacing:0px; cursor: default; "+ toolbarfontstyle; var bodyObj=document.createElement("tbody"); var trObj=document.createElement("tr"); trObj.style.padding="0px"; var id=""; var type=""; var i=0; var isRtl=false; if (viewer.params.direction == "rtl") { isRtl=true; i=infos.length - 1; } while (true) { id=infos[i][0]; type=infos[i][1]; var tdObj=document.createElement("td"); tdObj.id=viewer.vid +"UbiToolbar_"+ id; tdObj.style.cssText="padding:1px;"; var buttonObj=null; if (type == "sep") { tdObj.setAttribute("width", "2px"); buttonObj=document.createElement("div"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; buttonObj.style.cssText="width: 1px; height: 31px; font-size: 2px; margin-left: 2px; margin-right: 2px; margin-top: 1px; border-left: #757575 1px solid; border-right: #909090 0px solid; -moz-user-select: none;"; } else if (type == "button") { if (infos[i][0] == "AboutButton") { if (isRtl) tdObj.setAttribute("align", "left"); else tdObj.setAttribute("align", "right"); } tdObj.setAttribute("width", "34px"); buttonObj=document.createElement("input"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; buttonObj.type="button"; buttonObj.style.cssText="margin:0px; padding: 0px; border:0px; background-repeat: no-repeat; width:34px; height:31px;"; buttonObj.style.backgroundImage="url('"+ viewer.params.resource + "/images/toolbar/"+ infos[i][2] +"')"; buttonObj.style.backgroundColor=viewer.divToolbar.style.backgroundColor; buttonObj.setAttribute("imageurl", viewer.params.resource + "/images/toolbar/"); buttonObj.setAttribute("overimage", infos[i][3]); buttonObj.setAttribute("outimage", infos[i][2]); buttonObj.setAttribute("disimage", infos[i][4]); buttonObj.onmouseover=function() { var disabledflag=(this.disabled == undefined ? true : !this.disabled); if (__ubi_isFF && !disabledflag) { return; } this.style.cursor="pointer"; if (this.getAttribute("overimage")) this.style.backgroundImage="url('"+ this.getAttribute("imageurl") + this.getAttribute("overimage") +"')"; }; buttonObj.onmouseout=function() { var disabledflag=(this.disabled == undefined ? true : !this.disabled); if (__ubi_isFF && !disabledflag) { return; } this.style.cursor="default"; if (this.getAttribute("outimage")) this.style.backgroundImage="url('"+ this.getAttribute("imageurl") + this.getAttribute("outimage") +"')"; }; } else if (type == "text") { tdObj.setAttribute("width", "10px"); buttonObj=document.createElement("div"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; if (isRtl) buttonObj.style.cssText="margin:0px; padding:0px 0px 0px 0px; border:0px; align:left; white-space:nowrap; "+ toolbarfontstyle; else buttonObj.style.cssText="margin:0px; padding:0px 0px 0px 0px; border:0px; align:left; white-space:nowrap; vertical-align: bottom; "+ toolbarfontstyle; buttonObj.style.lineHeight="31px"; buttonObj.appendChild(document.createTextNode(infos[i][2])); } else if (type == "combo") { tdObj.setAttribute("width", "74px"); buttonObj=document.createElement("div"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; buttonObj.style.cssText="width: 74px; height: 21px; overflow: hidden; text-indent:5px; text-align:left; vertical-align:middle; line-height: 20px; background: url(\"" + viewer.params.resource + "/images/toolbar/select_arr.gif\") no-repeat right #F2F2F2;border: 0px solid #ccc;margin-top:1px; margin-bottom:1px; border:1px solid #ff6600; border-color:#BDBDBD #BDBDBD #BDBDBD #BDBDBD;"+ toolbarfontstyle; } else if (type == "dropdown") { tdObj.setAttribute("width", "13px"); buttonObj=document.createElement("input"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; buttonObj.type="button"; buttonObj.style.cssText="background-image: url(\""+ viewer.params.resource+"/images/toolbar/btnarrow.gif\"); border:0px; background-color:#909090; width: 11px; height: 31px; position: relative; margin: -1px; @margin-top: 1px; moz-user-select: none; background-repeat: no-repeat; background-position: center;"; buttonObj.style.backgroundColor=viewer.divToolbar.style.backgroundColor; buttonObj.setAttribute("outimage", infos[i][2]); buttonObj.setAttribute("disimage", infos[i][4]); } else if (type == "blk") { tdObj.setAttribute("width", "*"); buttonObj=document.createElement("div"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; buttonObj.style.cssText="height: 31px; font-size: 2px; margin-left: 2px; margin-right: 2px; margin-top: 1px; border-left: #757575 1px solid; border-right: #909090 0px solid; -moz-user-select: none;"; } if (buttonObj) { this.buttons[infos[i][0]]=buttonObj; tdObj.appendChild(buttonObj); this.buttontds[infos[i][0]]=tdObj; trObj.appendChild(tdObj); } if (isRtl) { i--; if (i < 0) break; } else { i++; if (i == infos.length) break; } } if (isRtl) { convertRtlButtonImage(this.buttons, "FirstButton", "LastButton"); convertRtlButtonImage(this.buttons, "PreviousButton", "NextButton"); convertRtlButtonImage(this.buttons, "NextButton", "PreviousButton"); convertRtlButtonImage(this.buttons, "LastButton", "FirstButton"); } bodyObj.appendChild(trObj); tableObj.appendChild(bodyObj); viewer.divToolbar.appendChild(tableObj); this.toolbarObj=tableObj; function getInfos(id) { for (var i=0; i<infos.length; i++) { if (infos[i][0] == id) return infos[i]; } return null; }; function convertRtlButtonImage(buttons, id, convid) { var info=getInfos(id); if (info && buttons[id]) { var convinfo=getInfos(convid); if (convinfo) { buttons[id].style.backgroundImage="url('"+ viewer.params.resource + "/images/toolbar/"+ convinfo[2] +"')"; buttons[id].setAttribute("overimage", convinfo[3]); buttons[id].setAttribute("outimage", convinfo[2]); } } }; }; this.makeZoomList=function() { var scaleIndex=-1; for (var j=60; j <= 300; j += 20) { this.scaleValues.push(j); this.scaleDispValues.push(j); } this.scaleValues.push("PageWidth"); this.scaleValues.push("WholePage"); if (viewer.params.language == 'ko') { this.scaleDispValues.push("너비에 맞춤"); this.scaleDispValues.push("페이지 맞춤"); } else { this.scaleDispValues.push("Page width"); this.scaleDispValues.push("Whole page"); } for (var j=0; j < this.scaleValues.length; j++) { var obj=document.createElement("a"); obj.setAttribute("id", viewer.vid + "ZoomOption_"+ this.scaleValues[j]); obj.setAttribute("value", this.scaleValues[j]); obj.style.cssText="text-decoration:none; text-align:left; vertical-align:middle; line-height: 20px; display: block; height: 20px; text-indent: 5px; color: #343434; background-color: #F2F2F2; "+ toolbarfontstyle; obj.onmouseover=function() { this.style.cursor="pointer"; this.style.color="#343434"; this.style.backgroundColor="white"; }; obj.onmouseout=function() { this.style.cursor="default"; this.style.color="#343434"; this.style.backgroundColor="#F2F2F2"; }; obj.appendChild(document.createTextNode(""+ this.scaleDispValues[j])); this.zoomCombo.appendChild(obj); } }; this.makePageList=function() { if (this.pageCombo == null) { this.pageCombo=document.createElement("div"); this.pageCombo.id=viewer.vid + "UbiToolbarPop_Save"; } this.pageCombo.innerHTML=""; for (var j=1; j <= viewer.totalPage; j++) { var obj=document.createElement("a"); obj.setAttribute("id", viewer.vid + "PageOption_"+ j); obj.style.cssText="text-decoration:none; text-align:left; vertical-align:middle; line-height: 20px; display: block; height: 20px; text-indent: 5px; color: #343434; background-color: #F2F2F2; "+ toolbarfontstyle; obj.onmouseover=function() { this.style.cursor="pointer"; this.style.color="#343434"; this.style.backgroundColor="white"; }; obj.onmouseout=function() { this.style.cursor="default"; this.style.color="#343434"; this.style.backgroundColor="#F2F2F2"; }; obj.appendChild(document.createTextNode(""+ j)); this.pageCombo.appendChild(obj); } }; this.makePopupMenu=function(popupid, popup, infos) { var i=0; var id=""; var type=""; var buttonObj=null; var bgcolor="#F2F2F2"; if (popup == null) { popup=document.createElement("div"); popup.id=viewer.vid +"UbiToolbarPopup_"+ popupid; popup.className="dialog"; popup.style.cssText="display:none; float:left; position:absolute; z-index:999999101; width:130px; overflow:hidden; padding:2px; background-color:"+ bgcolor +"; border:1px solid #BDBDBD;"; } else { popup.innerHTML=""; } while (true) { id=popupid + infos[i][0]; type=infos[i][1]; buttonObj=document.createElement("input"); buttonObj.id=viewer.vid +"UbiToolbarButton_"+ id; buttonObj.type="button"; buttonObj.value=infos[i][5]; buttonObj.style.cssText="display:block; margin:0px; padding: 0px; background-repeat: no-repeat; width:100%; height:33px; text-align:left; "+ toolbarfontstyle; buttonObj.style.backgroundImage="url('"+ viewer.params.resource + "/images/toolbar/"+ infos[i][2] +"')"; buttonObj.style.backgroundColor=bgcolor; buttonObj.style.border="1px solid "+ bgcolor; if (__ubi_isIE && __ubi_ieVersion < 8) { buttonObj.style.paddingLeft="35px"; } else { buttonObj.style.textIndent="35px"; } buttonObj.setAttribute("imageurl", viewer.params.resource + "/images/toolbar/"); buttonObj.setAttribute("overimage", infos[i][3]); buttonObj.setAttribute("outimage", infos[i][2]); buttonObj.setAttribute("disimage", infos[i][4]); buttonObj.onmouseover=buttonObj.onfocus=function() { var disabledflag=(this.disabled == undefined ? true : !this.disabled); if (__ubi_isFF && !disabledflag) { return; } this.style.cursor="pointer"; this.style.backgroundColor="#fff"; this.style.borderColor="#70C0E7"; this.style.borderWidth="1px"; this.style.borderStyle="solid"; if (this.getAttribute("overimage")) this.style.backgroundImage="url('"+ this.getAttribute("imageurl") + this.getAttribute("overimage") +"')"; if (this.id == viewer.vid +"UbiToolbarButton_SaveXls") { var isVisibleExcelPrint=(viewer.toolbar.buttons["SaveExcelPrint"].style.display == 'none') ? false : true; var isVisibleExcelBase=(viewer.toolbar.buttons["SaveExcelBase"].style.display == 'none') ? false : true; if (!isVisibleExcelPrint && !isVisibleExcelBase) { viewer.toolbar.hidePopupExcel(); } else { viewer.toolbar.showPopupExcel(); } } else if (this.id.indexOf("UbiToolbarButton_Save") > 0 && this.id.indexOf("UbiToolbarButton_SaveExcel") < 0){ viewer.toolbar.hidePopupExcel(); } if (_ubi_strToBool(viewer.params.iswa)) { _ubi_wafoucus(this); } }; buttonObj.onmouseout=buttonObj.onblur=function() { var disabledflag=(this.disabled == undefined ? true : !this.disabled); if (__ubi_isFF && !disabledflag) { return; } if (_ubi_strToBool(viewer.params.iswa)) { _ubi_wablur(this); } this.style.cursor="default"; this.style.backgroundColor=bgcolor; this.style.borderColor=bgcolor; this.style.borderWidth="1px"; this.style.borderStyle="solid"; if (this.getAttribute("outimage")) this.style.backgroundImage="url('"+ this.getAttribute("imageurl") + this.getAttribute("outimage") +"')"; }; popup.appendChild(buttonObj); this.buttons[id]=buttonObj; i++; if (i == infos.length) break; } var flag=viewer.divMain.contains(popup); if (!flag) { viewer.divMain.appendChild(popup); } return popup; }; this.makePrintPdfMessage=function() { var _browser=''; if (__ubi_isFF) _browser='Firefox'; else if (__ubi_isSafari) _browser='Safari'; else if (__ubi_isEdge) _browser='Edge'; else _browser=''; var chromeflag=false; if (__ubi_isChrome && viewer.params.password != "") { chromeflag=true; } var msg=""; if (chromeflag) { msg=_ubi_getMessage(viewer.params.language, "PdfDownloadChromeMsg"); } else { msg=_ubi_getMessage(viewer.params.language, "PdfDownloadMsg"); msg=msg.replace("^browser^", _browser); } var str=[]; var obj=document.createElement("div"); obj.id=viewer.vid +"Popup_PdfDownLoad_Message"; obj.className="dialog"; obj.style.cssText="display:none; position: absolute; z-index: 999999104; left: 50%; top: 50%; width: 450px; height: 300px; margin-left: -225px; margin-top: -150px;"; str.push("<div style='height:30px; width:100%; background:#555555; height:30px; border:1px solid #555555; padding:15px 15px; font: bold 20px Arial, Dotum; color:#fff; text-align:left;'>"); str.push(_ubi_getMessage(viewer.params.language, "PrintPDFTitle")); str.push("</div>"); str.push("<div style='width:100%; background:#fff; border-left:1px solid #555555; border-right:1px solid #555555; border-bottom:1px solid #555555; padding:15px 15px;'>"); str.push(" <div style='height:100px; width:100%;'>"); str.push(" <div style='height:65px; text-align:left; white-space:pre-wrap; word-break:break-all; font-size: 14px; color:#000; line-height:1.6em; padding-top:15px;'>"); str.push(msg); str.push(" </div>"); str.push(" </div>"); str.push(" <div style='margin-top:15px; text-align:center; overflow:hidden;'>"); str.push(" <input type=\"button\" style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle; min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#2372ba;' onclick='parent.__ubi_viewers[\""+ viewer.vid +"\"].toolbar.downloadPDFok();' value=\"" + _ubi_getMessage(viewer.params.language, "Menu_SAVE") + "\">"); str.push("&nbsp;<input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#666666;' onclick='parent.document.getElementById(\""+ obj.id +"\").style.display=\"none\";' value='" + _ubi_getMessage(viewer.params.language, "Button_Cancel") + "'>"); str.push(" </div>"); str.push("</div>"); obj.innerHTML=str.join(""); viewer.divMain.appendChild(obj); }; this.makePrintPdfErrorMessage=function(flag, filename) { var str=[]; var createflag=false; var obj=document.getElementById(viewer.vid +"Popup_PdfError_Message"); if (obj) { obj.innerHTML=""; } else { createflag=true; obj=document.createElement("div"); } obj.id=viewer.vid +"Popup_PdfError_Message"; obj.className="dialog"; obj.style.cssText="display:none; position: absolute; z-index: 999999104; left: 50%; top: 50%; width: 450px; height: 300px; margin-left: -225px; margin-top: -150px;"; str.push("<div style='height:30px; width:100%; background:#555555; height:30px; border:1px solid #555555; padding:15px 15px; font: bold 20px Arial, Dotum; color:#fff; text-align:left;'>"); str.push(_ubi_getMessage(viewer.params.language, "PrintPDFTitle")); str.push("</div>"); str.push("<div style='width:100%; background:#fff; border-left:1px solid #555555; border-right:1px solid #555555; border-bottom:1px solid #555555; padding:15px 15px;'>"); str.push(" <div style='height:180px; width:100%;'>"); str.push(" <div id='"+ viewer.vid + "_PdfError_Message_Install' style='height:100px; text-align:left; white-space:pre-wrap; word-break:break-all; font-size: 12px; color:#000; line-height:1.6em; padding-top:15px;'>"); str.push(_ubi_getMessage(viewer.params.language, "PdfInstallMsg1") + "<br>"); str.push(_ubi_getMessage(viewer.params.language, "PdfInstallMsg3")); str.push(" </div>"); str.push(" </div>"); str.push(" <div style='margin-top:15px; text-align:center; overflow:hidden;'>"); str.push(" <input type=\"button\" id='"+ viewer.vid + "_PdfError_Message_Download' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle; min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#2372ba;' onclick='parent.__ubi_viewers[\""+ viewer.vid +"\"].toolbar.downloadPDFok(\"" + flag + "\", \"" + filename + "\");' value=\"" + _ubi_getMessage(viewer.params.language, "Menu_SAVE") + "\">"); str.push("&nbsp;<input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#666666;' onclick='parent.document.getElementById(\""+ obj.id +"\").style.display=\"none\";' value='" + _ubi_getMessage(viewer.params.language, "Button_Cancel") + "'>"); str.push(" </div>"); str.push("</div>"); obj.innerHTML=str.join(""); if (createflag) { viewer.divMain.appendChild(obj); } }; this.changeExportDialog=function(type) { var iframeobj=document.getElementById(viewer.vid +"Popup_ExportDialogFrame"); if (!iframeobj) { return; } var obj=document.getElementById(viewer.vid + "Popup_ExportDialog"); var tobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_Table"); if (obj && tobj) { var imgObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_Image"); if (imgObj) { if (type == __ubi_EXPORT_IMAGE) { imgObj.style.display=''; } else { imgObj.style.display='none'; } } var iframeheight=tobj.scrollHeight; iframeobj.height=iframeheight + "px"; obj.style.height=iframeheight + "px"; obj.style.marginTop=(-iframeheight/2) + "px"; } }; this.makeExportDialog=function() { var str=[]; var obj=document.createElement("div"); obj.id=viewer.vid +"Popup_ExportDialog"; obj.className="dialog"; obj.style.cssText="display:none; position: absolute; z-index: 999999104; left: 50%; top: 50%; width: 450px; height: 300px; margin-left: -225px; margin-top: -150px; border: 1px solid #555555;background:#fff;"; str.push("<div id='"+ viewer.vid +"_ExportDialog_Table' style='width:100%; margin:0px; font-family: Dotum, Tahoma, 맑은고딕;'>"); str.push(" <div style='width:420px;background:#555555; height:30px; padding:15px 15px; font-weight: bold;font-size: 20px; color:#fff;text-align:left;'>"); str.push(_ubi_getMessage(viewer.params.language, "SaveDialogTitle")); str.push(" </div>"); str.push(" <div id='"+ viewer.vid +"_ExportDialog_ExportType' style='height :40px;font-size: 12px;margin-left:15px;margin-top:10px;margin-right:15px;border-bottom:1px solid #bdbdbd;display:none;'>"); str.push(" <label style=\"display: inline-block;width:135px;\"><b>" + _ubi_getMessage(viewer.params.language, "SaveDialogFileType") + "</b></label>"); str.push(" <select id='"+ viewer.vid +"_ExportDialog_FileType' name=\"ExportFileType\" style=\"width:180px; height:25px;\" "); str.push(" onchange=\"parent.__ubi_viewers['"+ viewer.vid +"'].toolbar.changeExportDialog(this.value); \">"); str.push(" <option value=\"11\">PDF</option><option value=\"12\">Excel - Print</option><option id=\"ubi_excel_base\" value=\"13\" disabled>Excel - Base</option><option value=\"18\">Word</option>"); str.push(" <option value=\"16\">PowerPoint</option><option value=\"17\">HWPML</option><option value=\"19\">HanCell</option><option value=\"10\">Image</option>"); str.push(" </select>"); str.push(" </div>"); str.push(" <div id='"+ viewer.vid +"_ExportDialog_ExportRange' style='height :100px;font-size: 12px;margin-left:15px;margin-top:10px;margin-right:15px;border-bottom:1px solid #bdbdbd;display:none;'>"); str.push(" <div style='height:20px; '>"); str.push(" <label style=\"display: inline-block;width:135px;\"><b>" + _ubi_getMessage(viewer.params.language, "PrintDlgRange") + "</b></label>"); str.push(" </div>"); str.push(" <span style='display: block; padding:2px 0'><label for='"+ viewer.vid +"_ExportDialog_All'><input type='radio' id='"+ viewer.vid +"_ExportDialog_All' name='PageOption' checked>" + _ubi_getMessage(viewer.params.language, "PrintDlgAll") + "</label></span>"); str.push(" <span style='display: block; padding:2px 0'><label for='"+ viewer.vid +"_ExportDialog_Current'><input type='radio' id='"+ viewer.vid +"_ExportDialog_Current' name='PageOption'>" + _ubi_getMessage(viewer.params.language, "PrintDlgCurrent") + "</label></span>"); str.push(" <span style='display: block; padding:2px 0'><label for='"+ viewer.vid +"_ExportDialog_Pages'><input type='radio' id='"+ viewer.vid +"_ExportDialog_Pages' name='PageOption'>" + _ubi_getMessage(viewer.params.language, "PrintDlgFromTo") + "</label>"); str.push(" &nbsp;&nbsp;<input type='text' id='"+ viewer.vid +"_ExportDialog_PageFrom' style='width:40px; border:1px solid lightgray; font-size:12px;'>" + _ubi_getMessage(viewer.params.language, "PrintDlgFrom") + "&nbsp;&nbsp;"); str.push(" <input type='text' id='"+ viewer.vid +"_ExportDialog_PageTo' style='width:40px; border:1px solid lightgray; font-size:12px;'>" + _ubi_getMessage(viewer.params.language, "PrintDlgTo") + "</span>"); str.push(" </div>"); str.push(" <div id='"+ viewer.vid +"_ExportDialog_Image' style='height :150px; padding:15px 15px; font-size: 12px;display:;'>"); str.push(" <b>Image " + _ubi_getMessage(viewer.params.language, "ExportOption") + "</b>"); str.push(" <div style='height:30px;margin-left:5px;margin-bottom:5px;margin-top:10px;line-height:16px;'>"); str.push(" <label style=\"display: inline-block;width:130px;\">" + _ubi_getMessage(viewer.params.language, "ExportFormat") + "</label>"); str.push(" <select id='"+ viewer.vid +"_ExportDialog_ImageType' name=\"ExportImageType\" style=\"width:180px; height:25px;\" onchange=\"var disflag='true';if(this.value == 'tif'){disflag='';} document.getElementById('"+ viewer.vid + "_ExportDialog_TifType').disabled=disflag; document.getElementById('"+ viewer.vid + "_ExportDialog_TifPage').disabled=disflag;\">"); str.push(" <option value=\"jpg\">JPG</option>"); str.push(" <option value=\"gif\">GIF</option>"); str.push(" <option value=\"png\">PNG</option>"); str.push(" <option value=\"tif\">TIFF</option>"); str.push(" </select>"); str.push(" </div>"); str.push(" <div style='height:30px;margin-left:5px;margin-bottom:5px;margin-top:10px;line-height:16px;'>"); str.push(" <label style=\"display: inline-block;width:130px;\">" + _ubi_getMessage(viewer.params.language, "TiffOption") + "</label>"); str.push(" <select id='"+ viewer.vid +"_ExportDialog_TifType' name=\"ExportTifType\" style=\"width:180px; height:25px;\" disabled>"); str.push(" <option value=\"GROUP3_2D\">GROUP3_2D</option>"); str.push(" <option value=\"GROUP4\">GROUP4</option>"); str.push(" </select>"); str.push(" </div>"); str.push(" <div style='height:20px;margin-left:5px;margin-bottom:5px;margin-top:10px;line-height:16px;'>"); str.push(" <label for='"+ viewer.vid +"_ExportDialog_TifPage'>"); str.push(" <input type=\"checkbox\" id='"+ viewer.vid +"_ExportDialog_TifPage' name=\"TifPageOption\" disabled> "); str.push(_ubi_getMessage(viewer.params.language, "TiffPageOption") + "</label>"); str.push(" </div>"); str.push(" <div id='"+ viewer.vid +"_ExportDialog_ZipMsg' style='height:30px;padding-left:5px;margin-bottom:5px;margin-top:10px;line-height:16px;border-bottom:1px solid #bdbdbd;font-weight: bold;display:;'>"); str.push( _ubi_getMessage(viewer.params.language, "ZipFileMsg")); str.push(" </div>"); str.push(" </div>"); str.push(" <div id='"+ viewer.vid +"_ExportDialog_SaveType' style='height:120px;margin-left:15px;margin-top:15px;margin-right:15px;font-size: 12px;display:none;'>"); str.push(" <b>" + _ubi_getMessage(viewer.params.language, "SaveDialogType") + "</b>"); str.push(" <div style='height:30px;margin-left:5px;margin-bottom:5px;margin-top:10px;line-height:16px;'>"); str.push(" &nbsp; <label for='"+ viewer.vid +"_ExportDialog_Default'><input type=\"radio\" id='"+ viewer.vid +"_ExportDialog_Default' name=\"ExportType\" value=\"DEFAULT\" onClick=\"document.getElementById('"+ viewer.vid + "_ExportDialog_ZipMsg').innerHTML='" + _ubi_getMessage(viewer.params.language, "ZipFileMsg") + "'; document.getElementById('"+ viewer.vid + "_ExportDialog_PluginMsg').innerHTML='" + _ubi_getMessage(viewer.params.language, "SaveFileMsg1") + "' \">"); str.push(" " + _ubi_getMessage(viewer.params.language, "SaveDialogDefault") + "</label>&nbsp; &nbsp; &nbsp;"); str.push(" <label for='"+ viewer.vid +"_ExportDialog_Plugin'><input type=\"radio\" id='"+ viewer.vid +"_ExportDialog_Plugin' name=\"ExportType\" value=\"PLUGIN\" onClick=\"document.getElementById('"+ viewer.vid + "_ExportDialog_ZipMsg').innerHTML=''; document.getElementById('"+ viewer.vid + "_ExportDialog_PluginMsg').innerHTML='" + _ubi_getMessage(viewer.params.language, "SaveFileMsg2") + "' \">"); str.push(" " + _ubi_getMessage(viewer.params.language, "SaveDialogUbiViewer") + "</label>"); str.push(" </div>"); str.push(" <div id='"+ viewer.vid + "_ExportDialog_PluginMsg' style='height:50px;margin-left:5px;margin-bottom:10px;line-height:16px;'>"); str.push(_ubi_getMessage(viewer.params.language, "SaveFileMsg2")); str.push(" </div>"); str.push(" </div>"); str.push(" <div style='height:45px;background:#fff;margin-top:10px; text-align:center; overflow:hidden'>"); str.push(" <input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#2372ba;' onclick='parent.__ubi_viewers[\""+ viewer.vid +"\"].toolbar.exportok();' value='" + _ubi_getMessage(viewer.params.language, "Button_OK") + "'>"); str.push(" &nbsp;<input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#666666;' onclick='parent.document.getElementById(\""+ obj.id +"\").style.display=\"none\";' value='" + _ubi_getMessage(viewer.params.language, "Button_Cancel") + "'>"); str.push(" </div>"); str.push("</div>"); var iframeobj=document.createElement('iframe'); iframeobj.id=viewer.vid +"Popup_ExportDialogFrame"; iframeobj.scrolling="no"; iframeobj.style.cssText="width: 100%; margin:0px;border:0 none;"; obj.appendChild(iframeobj); viewer.divMain.appendChild(obj); var html=str.join(""); iframeobj.contentWindow.document.open(); iframeobj.contentWindow.document.write(html); iframeobj.contentWindow.document.body.style.cssText="margin:0px;"; iframeobj.contentWindow.document.close(); }; this.makeAboutBox=function() { var str=[]; var obj=document.createElement("div"); obj.id=viewer.vid +"Popup_AboutBox"; obj.className="dialog"; obj.style.cssText="display:none; position: absolute; z-index: 999999104; left: 50%; top: 50%; width: 450px; height: 300px; margin-left: -225px; margin-top: -150px;"; str[i++]="<div style='height:30px; width:100%; background:#555555; height:30px; border:1px solid #555555; padding:15px 15px; font: bold 20px Arial, Dotum; color:#fff; text-align:left;'>UbiReport</div>"; str[i++]="<div style='width:100%; background:#fff; border-left:1px solid #555555; border-right:1px solid #555555; border-bottom:1px solid #555555; padding:15px 15px;'>"; str[i++]=" <div style='height:130px; width:100%;'>"; str[i++]=" <div style='height:59px; text-align:center; font: bold 14px Dotum; color:#000; line-height:1.6em; border-bottom:1px solid #bdbdbd; padding-top:15px;'>"; str[i++]="" + _UBI_REPORT_BUILD_NO + "<br>This copy is licensed to UbiDecision."; str[i++]=" </div>"; str[i++]=" <div style='padding-top:25px; text-align:center; font: bold 14px Dotum; color:#2372ba;'>"; str[i++]=" <a target=\"ubireport_new\" style=\"text-decoration:none;\" href=\"http://www.ubireport.com\">www.ubireport.com</a>"; str[i++]=" </div>"; str[i++]=" </div>"; str[i++]=" <div style='margin-top:15px; text-align:center; overflow:hidden;'>"; str[i++]=" <input type=\"button\" style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle; min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#2372ba;' onclick=\"document.getElementById('"+ obj.id +"').style.display='none'\" value=\"" + _ubi_getMessage(viewer.params.language, "Button_OK") + "\">"; str[i++]=" </div>"; str[i++]="</div>"; obj.innerHTML=str.join(""); viewer.divMain.appendChild(obj); }; this.makePrintDialog=function() { var msg=""; var msgflag=true; if (__ubi_isFF) msg="PrintHTMLMsg_FF"; else if (__ubi_isChrome || __ubi_isWhale) msg="PrintHTMLMsg_Chrome"; else if (__ubi_isOpera) msg="PrintHTMLMsg_Opera"; else if (__ubi_isEdge) msg="PrintHTMLMsg_Edge"; else if (__ubi_isIE) { msg="PrintHTMLMsg_IE"; if (viewer.params.printIEobj) { msg="PrintHTMLMsg_IEObj"; } } else msgflag=false; var str=[]; var obj=document.createElement("div"); obj.id=viewer.vid +"Popup_PrintDialog"; obj.className="dialog"; obj.style.cssText="display:none; position: absolute; z-index: 999999104; left: 50%; top: 50%; width: 450px; height: 320px; margin-left: -225px; margin-top: -160px; border: 1px solid #555555;background:#fff;"; str.push("<div id='"+ viewer.vid +"_PrintDialog_Table' style='width:100%; margin:0px;'>"); str.push(" <div style='width:420px;background:#555555; height:30px; padding:15px 15px; font: bold 20px Arial; color:#fff;'>UbiReport</div>"); str.push(" <div style='width:420px; padding:15px 15px; background:#fff;'>"); if (msgflag) { str.push(" <div id='"+ viewer.vid + "_PrintDialog_Contents' style='height:170px; font: normal 12px Dotum;'>"); } else { str.push(" <div id='"+ viewer.vid + "_PrintDialog_Contents' style='height:154px; font: normal 12px Dotum;'>"); } str.push(" <div id='"+ viewer.vid + "_PrintDialog_Comment' style='display:;height:20px;margin-bottom:10px;'>"); str.push(_ubi_getMessage(viewer.params.language, "PrintDlgMent") + "("+ _ubi_getMessage(viewer.params.language, "PrintDlgMaxMent") + viewer.params.printlimit +")"); str.push(" </div>"); str.push(" <div style='height:20px; '>" + _ubi_getMessage(viewer.params.language, "PrintDlgRange") + "</div>"); str.push(" <div style='height:70px;border:1px solid #bdbdbd; padding:10px; font:normal 11px Dotum;'>"); str.push(" <span style='display: block; padding:2px 0'><label for='"+ viewer.vid +"_PrintDialog_All'><input type='radio' id='"+ viewer.vid +"_PrintDialog_All' name='PageOption'>" + _ubi_getMessage(viewer.params.language, "PrintDlgAll") + "</label></span>"); str.push(" <span style='display: block; padding:2px 0'><label for='"+ viewer.vid +"_PrintDialog_Current'><input type='radio' id='"+ viewer.vid +"_PrintDialog_Current' name='PageOption'>" + _ubi_getMessage(viewer.params.language, "PrintDlgCurrent") + "</label></span>"); str.push(" <span style='display: block; padding:2px 0'><label for='"+ viewer.vid +"_PrintDialog_Pages'><input type='radio' id='"+ viewer.vid +"_PrintDialog_Pages' name='PageOption'>" + _ubi_getMessage(viewer.params.language, "PrintDlgFromTo") + "</label>"); str.push(" &nbsp;&nbsp;<input type='text' id='"+ viewer.vid +"_PrintDialog_PageFrom' style='width:40px; border:1px solid lightgray; font-size:12px;'>" + _ubi_getMessage(viewer.params.language, "PrintDlgFrom") + "&nbsp;&nbsp;"); str.push(" <input type='text' id='"+ viewer.vid +"_PrintDialog_PageTo' style='width:40px; border:1px solid lightgray; font-size:12px;'>" + _ubi_getMessage(viewer.params.language, "PrintDlgTo") + "</span>"); str.push(" </div>"); if (msgflag) { str.push(" <div id='"+ viewer.vid + "_PrintDialog_HTMLMsg' style='display:;margin-top:10px; line-height:1.4em'>"); str.push(_ubi_getMessage(viewer.params.language, msg)); str.push(" </div>"); } str.push(" <div id='"+ viewer.vid + "_PrintDialog_Landscape' style='display:; font-weight: bold; color:red; margin-top:10px; line-height:1.4em'>"); str.push(_ubi_getMessage(viewer.params.language, "PrintDlgHMent") + "<br/>" + _ubi_getMessage(viewer.params.language, "PrintDlgHMent2") + "&nbsp;<a style='color:blue; text-decoration:none;' href='"); if (viewer.params.language=='korean' || viewer.params.language=='ko'){ str.push(viewer.params.resource + "/images/printGuide_kr.html' target='_blank'>"); } else { str.push(viewer.params.resource + "/images/printGuide_us.html' target='_blank'>"); } str.push(_ubi_getMessage(viewer.params.language, "PrintDlgLink") + "</a>"); str.push(" </div>"); str.push(" </div>"); str.push(" <div style='height:45px;margin-top:10px; text-align:center; overflow:hidden'>"); str.push(" <input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#2372ba;' onclick='parent.__ubi_viewers[\""+ viewer.vid +"\"].toolbar.printok();' value='" + _ubi_getMessage(viewer.params.language, "Button_OK") + "'>"); str.push(" &nbsp;<input type='button' style='background-color: transparent; border: 0 none; cursor: pointer; vertical-align: middle;min-width:100px; font: bold 14px Dotum; color:#fff; padding:12px 0 12px 0; text-align:center; background:#666666;' onclick='parent.document.getElementById(\""+ obj.id +"\").style.display=\"none\";' value='" + _ubi_getMessage(viewer.params.language, "Button_Cancel") + "'>"); str.push(" </div>"); str.push(" </div>"); str.push("</div>"); var iframeobj=document.createElement('iframe'); iframeobj.id=viewer.vid +"Popup_PrintDialogFrame"; iframeobj.scrolling="no"; iframeobj.style.cssText="width: 100%; margin:0px;border:0 none;"; obj.appendChild(iframeobj); viewer.divMain.appendChild(obj); var html=str.join(""); iframeobj.contentWindow.document.open(); iframeobj.contentWindow.document.write(html); iframeobj.contentWindow.document.body.style.cssText="margin:0px;"; iframeobj.contentWindow.document.close(); }; this.createCombo=function() { if (this.zoomCombo == null) { this.zoomCombo=document.createElement("div"); this.zoomCombo.id=viewer.vid +"UbiToolbarSelect_ZoomList"; this.zoomCombo.style.cssText="display: none; position: absolute; z-index: 999999101; width: 74px; height: 21px; font-family: Dotum, Tahoma, 맑은고딕; font-size: 13px; overflow: auto; border: 0px solid #ccc; margin-top:1px; margin-bottom:1px; background:#5f6064; border:1px solid #ff6600; border-color:#BDBDBD #BDBDBD #BDBDBD #BDBDBD;"; viewer.divMain.appendChild(this.zoomCombo); } if (this.pageCombo == null) { this.pageCombo=document.createElement("div"); this.pageCombo.id=viewer.vid +"UbiToolbarSelect_PageList"; this.pageCombo.style.cssText="display: none; position: absolute; z-index: 999999101; width: 74px; height: 21px; font-family: Dotum, Tahoma, 맑은고딕; font-size: 13px; overflow: auto; border: 0px solid #ccc; margin-top:1px; margin-bottom:1px; background:#5f6064; border:1px solid #ff6600; border-color:#BDBDBD #BDBDBD #BDBDBD #BDBDBD;"; viewer.divMain.appendChild(this.pageCombo); } }; this.showComboBox=function(type) { if (type != "ZoomCombo" && type != "PageCombo" ) return; var xpos=0; var ypos=0; var typeindex=0; var visiblecount=0; var tbodyObj=this.toolbarObj.childNodes; if (tbodyObj) { var trlist=tbodyObj[0].childNodes; if (trlist) { var tdlist=trlist[0].childNodes; for (var i=0; i<tdlist.length; i++) { if (tdlist[i].style.display == "none") { continue; } if (tdlist[i].id == (vid +"UbiToolbar_"+ type)) { typeindex=i; ypos=tdlist[i].clientHeight; break; } xpos += tdlist[i].clientWidth; if (__ubi_isIE && __ubi_ieVersion < 8 && tdlist[i].clientHeight > 0) { visiblecount++; } } } } ypos=(ypos - this.buttons[type].clientHeight)/2 + this.buttons[type].clientHeight + 1; if (__ubi_isIE) { var combotdObj=document.getElementById(viewer.vid +"UbiToolbar_"+ type); if (type == "ZoomCombo" && this.buttons["TotalPageText"] && combotdObj && combotdObj.clientWidth > 0) { if (this.buttons["TotalPageText"].innerText.length == 4) { xpos++; } } if (__ubi_ieVersion < 8) { xpos += visiblecount*2 + 4; ypos += 3; } else { xpos += 2; } } else { xpos += 1; } var viewerObj=document.getElementById(vid); var toolbarObj=document.getElementById(vid + "_toolbar"); var baseHeight=20; var listHeight=0; if (type == "ZoomCombo") { listHeight=Math.min(baseHeight*this.scaleValues.length, baseHeight*15); } else if (type == "PageCombo") { listHeight=Math.min(baseHeight*viewer.totalPage, baseHeight*15); } var viewerHeight=viewerObj.scrollHeight; if (toolbarObj && toolbarObj.style.display != "none") { viewerHeight -= toolbarObj.scrollHeight; } if (listHeight < baseHeight) { listHeight=baseHeight; } else { listHeight=Math.min(listHeight, viewerHeight); } if (type == "ZoomCombo") { this.zoomCombo.style.left=xpos + "px"; this.zoomCombo.style.top=ypos + "px"; this.zoomCombo.style.height=listHeight + "px"; this.zoomCombo.style.display=""; } else if (type == "PageCombo") { this.pageCombo.style.left=xpos + "px"; this.pageCombo.style.top=ypos + "px"; this.pageCombo.style.height=listHeight + "px"; this.pageCombo.style.display=""; } }; this.showPopup=function(type) { var buttonid=""; if (type == "SaveDropMenu") { buttonid="SaveButton"; } else if (type == "PrintDropMenu") { buttonid="PrintButton"; } else { return; } var xpos=0; var visiblecount=0; var tbodyObj=this.toolbarObj.childNodes; if (tbodyObj) { var trlist=tbodyObj[0].childNodes; if (trlist) { var tdlist=trlist[0].childNodes; for (var i=0; i<tdlist.length; i++) { if (tdlist[i].style.display == "none") { continue; } if (tdlist[i].id == (vid +"UbiToolbar_"+ buttonid)) { break; } xpos += tdlist[i].clientWidth; if (__ubi_isIE && __ubi_ieVersion < 8 && tdlist[i].clientHeight > 0) { visiblecount++; } } } } if (__ubi_isIE) { if (__ubi_ieVersion < 8) { xpos += visiblecount*2 + 4; } else { xpos += 2; } } else { xpos += 1; } if (type == "SaveDropMenu") { this.saveList.style.left=0 + "px"; this.saveList.style.display=""; } else if (type == "PrintDropMenu") { this.printList.style.left=xpos + "px"; this.printList.style.display= ""; } }; this.showPopupExcel=function() { if (this.buttons["SaveXls"]) { this.excelList.style.left="130px"; var height=viewer.divToolbar.style.height; if (height.indexOf('px') >= 0) { height=height.substring(0, height.indexOf('px')); } this.excelList.style.top=(parseInt(height) + this.buttons["SaveXls"].offsetTop) +"px"; this.excelList.style.display=""; } }; this.hidePopupExcel=function() { this.excelList.style.display="none"; }; this.isShowPopup=function(type) { if (type == "ZoomCombo") { if (this.zoomCombo.style.display != "none") return true; } else if (type == "PageCombo") { if (this.pageCombo.style.display != "none") return true; } else if (type == "SaveDropMenu") { if (this.saveList.style.display != "none") return true; } else if (type == "PrintDropMenu") { if (this.printList.style.display != "none") return true; } return false; }; this.hidePopupAll=function() { this.zoomCombo.style.display="none"; this.pageCombo.style.display="none"; this.saveList.style.display="none"; this.excelList.style.display="none"; this.printList.style.display="none"; }; this.destroy=function() { _ubi_RemoveAddEvent(document, "click", clicked); }; this.getCurrScale=function() { return this.scaleValues[this.scaleIndex]; }; this.setCurrScale=function(zoom) { var scalevalue="PageWidth"; this.scaleIndex=this.scaleValues.length - 2; var zoomstr=""+zoom; if (zoomstr == "-9998") { zoomstr="PageWidth"; } else if (zoomstr == "-9999") { zoomstr="WholePage"; } var lowerValue=""; var lowerZoomValue=zoomstr.toLowerCase(); for (var i=0; i<this.scaleValues.length; i++) { lowerValue=(""+this.scaleValues[i]).toLowerCase(); if (lowerValue == lowerZoomValue) { scalevalue=this.scaleDispValues[i]; this.scaleIndex=i; break; } } if (this.buttons["ZoomCombo"]) { this.buttons["ZoomCombo"].innerHTML=""; this.buttons["ZoomCombo"].appendChild(document.createTextNode(scalevalue)); } }; this.setCurrPage=function(page) { if (this.buttons["PageCombo"]) { this.buttons["PageCombo"].innerHTML=""; this.buttons["PageCombo"].appendChild(document.createTextNode(page)); } this.page=page; this.setStatus(); }; this.setTotalPage=function(totalpage) { var tstr=""; if (viewer.params.direction == "rtl") tstr=totalpage +" /"; else tstr="/ "+ totalpage; if (this.buttons["TotalPageText"]) { this.buttons["TotalPageText"].innerHTML=""; this.buttons["TotalPageText"].appendChild(document.createTextNode(tstr)); } this.makePageList(); this.setStatus(); }; this.movePage=function(page) { if (page != this.page && page > 0 && page <= viewer.totalPage) { this.setCurrPage(page); viewer._movePage(page); this.setStatus(); } }; this.changeScale=function(scale) { if (viewer.totalPage < 1) return; if (this.scaleValues[this.scaleIndex] != scale) { this.jobStart(); setTimeout(function() { viewer.toolbar.changeScaleJob(scale); },50); } }; this.changeScaleJob=function(scale) { this.setCurrScale(scale); this.setStatus(); viewer._changeScale(); this.jobEnd(); }; this.first=function() { if (viewer.totalPage > 0 && this.page != 1) { var page=1; this.movePage(page); } }; this.previous=function() { if (this.page > 1) { var page=this.page-1; this.movePage(page); } }; this.next=function() { if (this.page < viewer.totalPage) { var page=this.page+1; this.movePage(page); } }; this.last=function() { if (viewer.totalPage > 0 && this.page != viewer.totalPage) { var page=viewer.totalPage; this.movePage(page); } }; this.zoomout=function() { if (this.scaleIndex > 0) { var scale=this.scaleValues[this.scaleIndex-1]; this.changeScale(scale); } }; this.zoomin=function() { if ((this.scaleIndex+1) < this.scaleValues.length) { var scale=this.scaleValues[this.scaleIndex+1]; this.changeScale(scale); } }; this.setscale=function(scale) { var scalenum=scale; if (typeof(scale) != "number") { scalenum=parseInt(scale); } for (var i=0; i<this.scaleValues.length; i++) { if (this.scaleValues[i] == scale) { if (this.scaleIndex != i) { this.changeScale(scale); } break; } } }; this.refresh=function() { viewer.showReport(); }; this.aboutbox=function() { var obj=document.getElementById(viewer.vid +"Popup_AboutBox"); if (obj) { obj.style.display=""; } }; this.printHTML=function() { var limitpage=viewer.params.printlimit; if (!limitpage || limitpage == "") { limitpage="50"; } var isPopupPrnDialog=false; if (__ubi_isIE && viewer.pageOrientation == "Landscape") { isPopupPrnDialog=true; } if (isPopupPrnDialog == true || viewer.totalPage >= parseInt(limitpage)) { var obj=document.getElementById(viewer.vid +"Popup_PrintDialog"); var iframeobj=document.getElementById(viewer.vid +"Popup_PrintDialogFrame"); if (obj && iframeobj) { var commentFlag=false; if (viewer.totalPage <= parseInt(limitpage)) { var allobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_All"); allobj.checked=true; iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Comment").style.display='none'; commentFlag=true; iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_PageFrom").value=1; iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_PageTo").value=viewer.totalPage; } else { var allobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Pages"); allobj.checked=true; iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_PageFrom").value=1; iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_PageTo").value=limitpage; obj.style.height=350 + 'px'; var contentsObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Contents"); contentsObj.style.height=200 + 'px'; } var commentobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Landscape"); if (commentobj && __ubi_isIE && viewer.pageOrientation == "Landscape") { commentobj.style.display=''; var contentsObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Contents"); if (commentFlag) { obj.style.height=350 + 'px'; contentsObj.style.height=200 + 'px'; } else { obj.style.height=380 + 'px'; contentsObj.style.height=230 + 'px'; } } else { commentobj.style.display='none'; } obj.style.display=""; var tobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Table"); var iframeheight=tobj.scrollHeight; iframeobj.height=iframeheight + "px"; } } else { if (viewer.params.isStreaming) { viewer._printRetrieveAll(1, viewer.totalPage); } else { viewer._printHTML(1, viewer.totalPage); } } }; this.printPLUGIN=function(isPrintSet) { exePrint(isPrintSet, viewer); }; this.exportPLUGIN=function(type) { exeExport(type, viewer); }; this.downloadPDFok=function(flag, filename) { if (__ubi_isIE) { viewer._isPrintPDF=true; viewer._exportEnd(flag, filename); document.getElementById(viewer.vid +"Popup_PdfError_Message").style.display='none'; } else { viewer._isPrintPDF=true; viewer._exportReport(__ubi_EXPORT_PDF); document.getElementById(viewer.vid +"Popup_PdfDownLoad_Message").style.display='none'; } }; this.exportok=function() { var iframeobj=document.getElementById(viewer.vid +"Popup_ExportDialogFrame"); if (!iframeobj) { return; } var type=__ubi_EXPORT_IMAGE; var pluginSaveFlag=_ubi_strToBool(viewer.params.usepluginsave); if (_ubi_strToBool(viewer.params.usepluginsave) || parseInt(viewer.exportsetmode) != 1) { var fileComboObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_FileType"); type=fileComboObj.value; pluginSaveFlag=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_Plugin").checked; } if (type == __ubi_EXPORT_IMAGE) { var imgType='jpg'; var tiffType='GROUP3_2D'; var tiffPage=false; var obj=document.getElementById(viewer.vid +"Popup_ExportDialog"); if (obj) { var imgTypeObj=iframeobj.contentWindow.document.getElementById(viewer.vid +"_ExportDialog_ImageType"); if (imgTypeObj) { imgType=imgTypeObj.value; viewer._exportImageType=imgType; if (pluginSaveFlag) { viewer.setPluginVariable('Export.Image.DefaultExtension', imgType); } } if (imgType == 'tif') { var tiffCompObj=iframeobj.contentWindow.document.getElementById(viewer.vid +"_ExportDialog_TifType"); if (tiffCompObj) { tiffType=tiffCompObj.value; } var tiffPageObj=iframeobj.contentWindow.document.getElementById(viewer.vid +"_ExportDialog_TifPage"); if (tiffPageObj) { tiffPage=tiffPageObj.checked; } if (pluginSaveFlag) { if (tiffType == 'GROUP3_2D') { tiffType='GROUP3'; } else if (tiffType == 'JPEG_TTN2') { tiffType='JPEG'; } viewer.setPluginVariable('Export.Image.CompressionType', tiffType); viewer.setPluginVariable('Export.Image.TiffPerPage', tiffPage); } else { viewer.params.tiffType=tiffType; viewer.params.tiffPerPage=tiffPage; } } } } if (pluginSaveFlag) { viewer.toolbar.exportPLUGIN(type); } else { viewer.params.exportPageFrom=0; viewer.params.exportPageTo=0; if (parseInt(viewer.exportsetmode) != 1) { var allObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_All"); var currentObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_Current"); var pagesObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_Pages"); if (currentObj.checked) { var pageFrom=this.page; var pageTo=this.page; viewer.params.exportPageFrom=pageFrom; viewer.params.exportPageTo=pageTo; } else if (pagesObj.checked) { var fromObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_PageFrom"); var toObj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_ExportDialog_PageTo"); var pageFrom=parseInt(fromObj.value); var pageTo=parseInt(toObj.value); viewer.params.exportPageFrom=pageFrom; viewer.params.exportPageTo=pageTo; } } viewer._exportStart(type); } document.getElementById(viewer.vid +"Popup_ExportDialog").style.display='none'; }; this.printok=function() { var iframeobj=document.getElementById(viewer.vid +"Popup_PrintDialogFrame"); if (!iframeobj) { return; } var allobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_All"); var currobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Current"); var pagesobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_Pages"); var pagefrom=1, pageto=1; if (allobj.checked) { pageto=viewer.totalPage; } else if (currobj.checked) { pagefrom=this.page; pageto=this.page; } else if (pagesobj.checked) { var fromobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_PageFrom"); var toobj=iframeobj.contentWindow.document.getElementById(viewer.vid + "_PrintDialog_PageTo"); pagefrom=parseInt(fromobj.value); pageto=parseInt(toobj.value); } if (pagefrom < 1 || pageto > viewer.totalPage) { alert(_ubi_getMessage(viewer.params.language, "PrintDlgRangeErr") + _ubi_getMessage(viewer.params.language, "PrintDlgEnter")); return; } if ((pageto - pagefrom + 1) > viewer.params.printlimit) { alert(_ubi_getMessage(viewer.params.language, "PrintDlgHTMLRangeErr") + "\n(" + _ubi_getMessage(viewer.params.language, "PrintDlgMaxMent") + viewer.params.printlimit + ")" + _ubi_getMessage(viewer.params.language, "PrintDlgEnter")); return; } document.getElementById(viewer.vid +"Popup_PrintDialog").style.display='none'; if (viewer.params.isStreaming) viewer._printRetrieveAll(pagefrom, pageto); else viewer._printHTML(pagefrom, pageto); }; this.enableButton=function(buttonid, flag) { var button=this.buttons[buttonid]; if (button) { var orgImage=button.getAttribute("outimage"); if (orgImage) { var disImage=button.getAttribute("disimage"); if (flag) button.style.backgroundImage="url('"+ viewer.params.resource + "/images/toolbar/"+ orgImage +"')"; else button.style.backgroundImage="url('"+ viewer.params.resource + "/images/toolbar/"+ disImage +"')"; } if (flag) button.disabled=false; else button.disabled=true; } }; this.isEnabledButton=function(buttonid) { var button=this.buttons[buttonid]; if (button) { if (button.disabled == undefined) return true; return !button.disabled; } return false; }; this.setStatus=function() { if (this.page == viewer.totalPage || viewer.totalPage <= 1) { this.enableButton("NextButton", false); this.enableButton("LastButton", false); } else { this.enableButton("NextButton", true); this.enableButton("LastButton", true); } if (this.page == 1 || this.page == 0 || viewer.totalPage <= 1) { this.enableButton("FirstButton", false); this.enableButton("PreviousButton", false); } else { this.enableButton("FirstButton", true); this.enableButton("PreviousButton", true); } this.enableButton("ZoomOutButton", false); this.enableButton("ZoomInButton", false); if (viewer.totalPage > 0) { if (this.scaleIndex > 0) { this.enableButton("ZoomOutButton", true); } if (this.scaleIndex < (this.scaleValues.length-1)) { this.enableButton("ZoomInButton", true); } } if ((_ubi_strToBool(viewer.params.isStreaming) && viewer._isReceiveTotalpage) || (_ubi_strToBool(viewer.params.isStreaming) == false && viewer.totalPage > 0)) { this.enableButton("SaveButton", true); this.enableButton("PrintButton", true); this.enableButton("PrintSetButton", true); this.enableButton("RefreshButton", true); this.enableButton("SaveDropMenu", true); this.enableButton("PrintDropMenu", true); } else { this.enableButton("SaveButton", false); this.enableButton("PrintButton", false); this.enableButton("PrintSetButton", false); this.enableButton("RefreshButton", false); this.enableButton("SaveDropMenu", false); this.enableButton("PrintDropMenu", false); } if (viewer._isMultiPaper) { if (this.isEnabledButton("SaveButton")) { this.enableButton("SaveXls", false); this.enableButton("SaveRtf", false); this.enableButton("SaveHwp", false); this.enableButton("SavePptx", false); this.enableButton("SaveHml", false); this.enableButton("SaveDocx", false); this.enableButton("SaveCell", false); this.enableButton("SaveImage", false); } } }; this.setUserSaveList=function(list) { this.userSaveList=list; if (this.userSaveList != "") { var arr=this.userSaveList.split(","); var newsaveinfos=[]; for(var j in arr) { var savetype=arr[j].trim().toUpperCase(); if (savetype != "") { for (var k in saveinfos) { var info=saveinfos[k]; if (savetype == info[0].toUpperCase()) { newsaveinfos.push(info); break; } } } } if (newsaveinfos.length > 0) { this.saveList=this.makePopupMenu("Save", this.saveList, newsaveinfos); } } }; this.setUserPrintList=function(list) { this.userPrintList=list; if (this.userPrintList != "") { var arr=this.userPrintList.split(","); var newprintinfos=[]; for(var j in arr) { var printtype=arr[j].trim().toUpperCase(); if (printtype != "") { for (var k in printinfos) { var info=printinfos[k]; if (printtype == info[0].toUpperCase()) { newprintinfos.push(info); break; } } } } if (newprintinfos.length > 0) { this.printList=this.makePopupMenu("Print", this.printList, newprintinfos); } } }; this.setVisibleToolbar=function(id, flag) { var tdid=viewer.vid +"UbiToolbar_"; var name=id.toUpperCase(); var display=(flag) ? "block" : "none"; switch(name) { case "SAVE": this.buttontds["SaveButton"].style.display=display; this.buttontds["SaveText"].style.display=display; this.buttontds["SaveDropMenu"].style.display=display; break; case "SAVEBUTTON": this.buttontds["SaveButton"].style.display=display; break; case "SAVETEXT": this.buttontds["SaveText"].style.display=display; break; case "SAVEDROPMENU": this.buttontds["SaveDropMenu"].style.display=display; break; case "PRINT": this.buttontds["PrintButton"].style.display=display; this.buttontds["PrintText"].style.display=display; this.buttontds["PrintDropMenu"].style.display=display; this.buttons["PrintPdf"].style.display=display; this.buttons["PrintHtml"].style.display=display; this.buttons["PrintUbi"].style.display=display; break; case "PRINTBUTTON": this.buttontds["PrintButton"].style.display=display; break; case "PRINTTEXT": this.buttontds["PrintText"].style.display=display; break; case "PRINTDROPMENU": this.buttontds["PrintDropMenu"].style.display=display; break; case "PRINTSET": this.buttontds["PrintSetButton"].style.display=display; this.buttontds["PrintSetText"].style.display=display; break; case "PRINTSETBUTTON": this.buttontds["PrintSetButton"].style.display=display; break; case "PRINTSETTEXT": this.buttontds["PrintSetText"].style.display=display; break; case "NAVIGATION": this.buttontds["NaviSep"].style.display=display; this.buttontds["FirstButton"].style.display=display; this.buttontds["PreviousButton"].style.display=display; this.buttontds["PageCombo"].style.display=display; this.buttontds["TotalPageText"].style.display=display; this.buttontds["NextButton"].style.display=display; this.buttontds["LastButton"].style.display=display; break; case "FIRST": this.buttontds["FirstButton"].style.display=display; break; case "PREV": this.buttontds["PreviousButton"].style.display=display; break; case "PAGE": this.buttontds["PageCombo"].style.display=display; break; case "TOTALPAGE": this.buttontds["TotalPageText"].style.display=display; break; case "NEXT": this.buttontds["NextButton"].style.display=display; break; case "LAST": this.buttontds["LastButton"].style.display=display; break; case "PAGECOMBO": this.buttontds["PageCombo"].style.display=display; break; case "TOTALPAGETEXT": this.buttontds["TotalPageText"].style.display=display; break; case "ZOOM": this.buttontds["ZoomSep"].style.display=display; this.buttontds["ZoomOutButton"].style.display=display; this.buttontds["ZoomCombo"].style.display=display; this.buttontds["ZoomInButton"].style.display=display; break; case "ZOOM_OUT": this.buttontds["ZoomOutButton"].style.display=display; break; case "ZOOM_VALUE": this.buttontds["ZoomCombo"].style.display=display; break; case "ZOOM_IN": this.buttontds["ZoomInButton"].style.display=display; break; case "REFRESH": this.buttontds["RefreshButton"].style.display=display; break; case "INFO": this.buttontds["AboutButton"].style.display=display; break; case "SAVE_PDF": this.buttons["SavePdf"].style.display=display; break; case "SAVE_EXCEL": this.buttons["SaveXls"].style.display=display; break; case "SAVE_PPTX": this.buttons["SavePptx"].style.display=display; break; case "SAVE_HML": this.buttons["SaveHml"].style.display=display; break; case "SAVE_DOCX": this.buttons["SaveDocx"].style.display=display; break; case "SAVE_CELL": this.buttons["SaveCell"].style.display=display; break; case "SAVE_IMAGE" : this.buttons["SaveImage"].style.display=display; break; case "EXCEL_TYPE1": this.buttons["SaveExcelPrint"].style.display=display; break; case "EXCEL_TYPE2": this.buttons["SaveExcelBase"].style.display=display; break; case "PRINT_PDF": this.buttons["PrintPdf"].style.display=display; break; case "PRINT_HTML": this.buttons["PrintHtml"].style.display=display; break; case "PRINT_UBI": if (_ubi_strToBool(viewer.params.useplugin)) { this.buttons["PrintUbi"].style.display=display; } else { this.buttons["PrintUbi"].style.display="none"; } break; } var isVisiblePrintPDF=(this.buttons["PrintPdf"].style.display == 'none')?false:true; var isVisiblePrintHTML=(this.buttons["PrintHtml"].style.display == 'none')?false:true; var isVisiblePrintPLUGIN=(this.buttons["PrintUbi"].style.display == 'none')?false:true; if ( (!isVisiblePrintPDF && !isVisiblePrintHTML && !isVisiblePrintPLUGIN) || (isVisiblePrintPDF && !isVisiblePrintHTML && !isVisiblePrintPLUGIN && this.printDefaultType == 'PDF') || (isVisiblePrintHTML && !isVisiblePrintPDF && !isVisiblePrintPLUGIN && this.printDefaultType == 'HTML') || (isVisiblePrintPLUGIN && !isVisiblePrintPDF && !isVisiblePrintHTML && this.printDefaultType == 'UBI')) { this.buttontds["PrintDropMenu"].style.display='none'; } else { this.buttontds["PrintDropMenu"].style.display=''; } }; this.setMenuTextToolbar=function(id, text) { var name=id.toUpperCase(); switch(name) { case "SAVE": this.buttons["SaveText"].innerHTML=text; break; case "PRINT": this.buttons["PrintText"].innerHTML=text; break; case "PRINTSET": this.buttons["PrintSetText"].innerHTML=text; break; case "PDF": this.buttons["SavePdf"].value=text; break; case "EXCEL": this.buttons["SaveXls"].value=text; break; case "DOCX": this.buttons["SaveDocx"].value=text; break; case "PPTX": this.buttons["SavePptx"].value=text; break; case "HML": this.buttons["SaveHml"].value=text; break; case "CELL": this.buttons["SaveCell"].value=text; break; case "IMAGE": this.buttons["SaveImage"].value=text; break; case "EXCEL_TYPE1": this.buttons["SaveExcelPrint"].value=text; break; case "EXCEL_TYPE2": this.buttons["SaveExcelBase"].value=text; break; case "PRINT_PDF": this.buttons["PrintPdf"].value=text; break; case "PRINT_HTML": this.buttons["PrintHtml"].value=text; break; case "PRINT_UBI": this.buttons["PrintUbi"].value=text; break; } }; this.jobStart=function() { if( !_ubi_strToBool(viewer.params.disabledivhide) ) { viewer.divDisable.style.width=viewer.divToolbar.clientWidth; viewer.divDisable.style.height=viewer.divToolbar.style.height; viewer.divDisable.style.display=""; } viewer.divMain.style.cursor="progress"; }; this.jobEnd=function() { if( !_ubi_strToBool(viewer.params.disabledivhide) ) { viewer.divDisable.style.display="none"; } viewer.divMain.style.cursor="default"; }; this.initToolbar(); function clicked(e) { var target=e.target || e.srcElement; if (!target || !target.id || target.id.substring(0, vid.length) != vid) { __ubi_viewers[vid].toolbar.hidePopupAll(); return; } var targetid=target.id; if (targetid == (vid +"UbiToolbarButton_ZoomCombo")) { if (__ubi_viewers[vid].toolbar.isShowPopup("ZoomCombo") == false) { __ubi_viewers[vid].toolbar.hidePopupAll(); __ubi_viewers[vid].toolbar.showComboBox("ZoomCombo"); return; } } else if (targetid == (vid +"UbiToolbarButton_PageCombo")) { if (__ubi_viewers[vid].toolbar.isShowPopup("PageCombo") == false) { __ubi_viewers[vid].toolbar.hidePopupAll(); __ubi_viewers[vid].toolbar.showComboBox("PageCombo"); return; } } else if (targetid == (vid +"UbiToolbarButton_SaveDropMenu")) { if (__ubi_viewers[vid].toolbar.isShowPopup("SaveDropMenu") == false) { __ubi_viewers[vid].toolbar.hidePopupAll(); if (__ubi_viewers[vid].toolbar.isEnabledButton("SaveButton") == true) { __ubi_viewers[vid].toolbar.showPopup("SaveDropMenu"); } return; } } else if (targetid == (vid +"UbiToolbarButton_PrintDropMenu")) { if (__ubi_viewers[vid].toolbar.isShowPopup("PrintDropMenu") == false) { __ubi_viewers[vid].toolbar.hidePopupAll(); if (__ubi_viewers[vid].toolbar.isEnabledButton("PrintButton") == true) { __ubi_viewers[vid].toolbar.showPopup("PrintDropMenu"); } return; } } var viewer=__ubi_viewers[vid]; var toolbarid=vid + "UbiToolbarButton_"; if (targetid.indexOf(vid +"ZoomOption_") == 0) { var scale=target.getAttribute("value"); viewer.toolbar.changeScale(scale); } else if (targetid.indexOf(vid +"PageOption_") == 0) { var page=targetid.substring(targetid.lastIndexOf("_")+1); viewer.toolbar.movePage(parseInt(page)); } else if (targetid == toolbarid +"FirstButton") { if (viewer.toolbar.isEnabledButton("FirstButton")) __ubi_viewers[vid].toolbar.first(); } else if (targetid == toolbarid +"PreviousButton") { if (viewer.toolbar.isEnabledButton("PreviousButton")) viewer.toolbar.previous(); } else if (targetid == toolbarid +"NextButton") { if (viewer.toolbar.isEnabledButton("NextButton")) viewer.toolbar.next(); } else if (targetid == toolbarid +"LastButton") { if (viewer.toolbar.isEnabledButton("LastButton")) viewer.toolbar.last(); } else if (targetid == toolbarid +"ZoomOutButton") { if (viewer.toolbar.isEnabledButton("ZoomOutButton")) viewer.toolbar.zoomout(); } else if (targetid == toolbarid +"ZoomInButton") { if (viewer.toolbar.isEnabledButton("ZoomInButton")) viewer.toolbar.zoomin(); } else if (targetid == toolbarid +"RefreshButton") { if (viewer.toolbar.isEnabledButton("RefreshButton")) viewer.toolbar.refresh(); } else if (targetid == toolbarid +"AboutButton") { if (viewer.toolbar.isEnabledButton("AboutButton")) viewer.toolbar.aboutbox(); } else if (targetid == toolbarid +"PrintButton" || targetid == toolbarid +"PrintText") { if (viewer.toolbar.isEnabledButton("PrintButton")) { if (viewer.toolbar.printDefaultType == "") { if (viewer.toolbar.isShowPopup("PrintDropMenu") == false) { viewer.toolbar.hidePopupAll(); viewer.toolbar.showPopup("PrintDropMenu"); return; } } else { if (viewer.events.printClicked) { viewer.events.printClicked(viewer.toolbar.printDefaultType); } else { if (viewer.toolbar.printDefaultType == "PDF") { viewer._printPDF(true); } else if (viewer.toolbar.printDefaultType == "HTML") { viewer.toolbar.printHTML(); } else if (viewer.toolbar.printDefaultType == "UBI") { viewer.toolbar.printPLUGIN(false); } } } } } else if (targetid == toolbarid +"PrintSetButton" || targetid == toolbarid +"PrintSetText") { if (viewer.toolbar.isEnabledButton("PrintSetButton")) { viewer._printPDF(true); } } else if (targetid == toolbarid +"PrintPdf") { if (viewer.toolbar.isEnabledButton("PrintPdf")) { if (viewer.events.printClicked) { viewer.events.printClicked('PDF'); } else { viewer._printPDF(true); } } } else if (targetid == toolbarid +"PrintHtml") { if (viewer.toolbar.isEnabledButton("PrintHtml")) { if (viewer.events.printClicked) { viewer.events.printClicked('HTML'); } else { viewer.toolbar.printHTML(); } } } else if (targetid == toolbarid +"PrintUbi") { if (viewer.toolbar.isEnabledButton("PrintUbi")) { if (viewer.events.printClicked) { viewer.events.printClicked('UBI'); } else { viewer.toolbar.printPLUGIN(true); } } } else if (targetid == toolbarid +"SaveButton" || targetid == toolbarid +"SaveText") { if (viewer.toolbar.isEnabledButton("SaveButton")) { if (viewer.toolbar.saveDefaultType == "") { if (viewer.toolbar.isShowPopup("SaveDropMenu") == false) { viewer.toolbar.hidePopupAll(); viewer.toolbar.showPopup("SaveDropMenu"); return; } } else { if (viewer.events.exportClicked) { var savetype='PDF'; switch (viewer.toolbar.saveDefaultType) { case __ubi_EXPORT_EXCEL1 : savetype='EXCEL'; break; case __ubi_EXPORT_EXCEL2 : savetype='EXCEL_NO'; break; case __ubi_EXPORT_PPTX : savetype='PPTX'; break; case __ubi_EXPORT_DOCX : savetype='DOCX'; break; case __ubi_EXPORT_HML : savetype='HML'; break; case __ubi_EXPORT_CELL : savetype='CELL'; break; case __ubi_EXPORT_IMAGE : savetype='IMAGE'; break; } viewer.events.exportClicked(savetype); } else { viewer._exportReport(viewer.toolbar.saveDefaultType); } } } } else if (targetid == toolbarid +"SavePdf") { if (viewer.toolbar.isEnabledButton("SavePdf")) { viewer._isPrintPDF=false; if (viewer.events.exportClicked) { viewer.events.exportClicked('PDF'); } else { viewer._exportReport(__ubi_EXPORT_PDF); } } } else if (targetid == toolbarid +"SaveExcel") { if (viewer.toolbar.isEnabledButton("SaveExcel")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('EXCEL'); } else { viewer._exportReport(__ubi_EXPORT_EXCEL1); } } } else if (targetid == toolbarid +"SaveExcelPrint") { if (viewer.toolbar.isEnabledButton("SaveExcelPrint")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('EXCEL'); } else { viewer._exportReport(__ubi_EXPORT_EXCEL1); } } } else if (targetid == toolbarid +"SaveExcelBase") { if (viewer.toolbar.isEnabledButton("SaveExcelBase")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('EXCEL_NO'); } else { viewer._exportReport(__ubi_EXPORT_EXCEL2); } } } else if (targetid == toolbarid +"SaveDocx") { if (viewer.toolbar.isEnabledButton("SaveDocx")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('DOCX'); } else { viewer._exportReport(__ubi_EXPORT_DOCX); } } } else if (targetid == toolbarid +"SavePptx") { if (viewer.toolbar.isEnabledButton("SavePptx")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('PPTX'); } else { viewer._exportReport(__ubi_EXPORT_PPTX); } } } else if (targetid == toolbarid +"SaveHml") { if (viewer.toolbar.isEnabledButton("SaveHml")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('HML'); } else { viewer._exportReport(__ubi_EXPORT_HML); } } } else if (targetid == toolbarid +"SaveCell") { if (viewer.toolbar.isEnabledButton("SaveCell")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('CELL'); } else { viewer._exportReport(__ubi_EXPORT_CELL); } } } else if (targetid == toolbarid +"SaveImage") { if (viewer.toolbar.isEnabledButton("SaveImage")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('IMAGE'); } else { viewer._exportReport(__ubi_EXPORT_IMAGE); } } } else if (targetid == toolbarid +"SaveXls") { if (viewer.toolbar.saveExcelDefaultType != "") { if (viewer.toolbar.saveExcelDefaultType == __ubi_EXPORT_EXCEL1 && viewer.toolbar.isEnabledButton("SaveExcelPrint")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('EXCEL'); } else { viewer._exportReport(__ubi_EXPORT_EXCEL1); } } else if (viewer.toolbar.saveExcelDefaultType == __ubi_EXPORT_EXCEL2 && viewer.toolbar.isEnabledButton("SaveExcelBase")) { if (viewer.events.exportClicked) { viewer.events.exportClicked('EXCEL_NO'); } else { viewer._exportReport(__ubi_EXPORT_EXCEL2); } } } } if (targetid != toolbarid +"SaveXls" || (targetid == toolbarid +"SaveXls" && viewer.toolbar.saveExcelDefaultType != "") ) { __ubi_viewers[vid].toolbar.hidePopupAll(); } }; this.applyWA=function(id) { var buttonNames=[ ["SaveButton", "저장"], ["SaveDropMenu", "저장유형 선택"], ["SavePdf", "PDF로 저장" ], ["SaveXls", "엑셀로 저장" ], ["SaveExcelPrint", "프린트형식의 엑셀로 저장" ], ["SaveExcelBase", "리스트형식의 엑셀로 저장" ], ["SaveRtf", "RTF 저장" ], ["SaveDocx", "MS워드로 저장" ], ["SavePptx", "파워포인트로 저장" ], ["SaveHml", "한글파일로 저장" ], ["SaveCell", "한셀로 저장" ], ["SaveImage", "이미지로 저장" ], ["PrintButton", "인쇄"], ["PrintDropMenu", "인쇄유형 선택"], ["PrintPdf", "PDF로 인쇄" ], ["PrintHtml", "HTML로 인쇄"], ["PrintUbi", "대량 인쇄"], ["PrintSetButton", "인쇄설정"], ["FirstButton", "첫번째 페이지로 이동"], ["PreviousButton", "이전 페이지로 이동"], ["NextButton", "다음 페이지로 이동"], ["LastButton", "마지막 페이지로 이동"], ["ZoomOutButton", "축소"], ["ZoomInButton", "확대"], ["RefreshButton", "새로고침"], ["AboutButton", "솔루션 정보" ] ]; var obj=null; var tabindex=4; for (var i=0; i<buttonNames.length; i++) { obj=this.buttons[buttonNames[i][0]]; if (obj) { obj.title=buttonNames[i][1]; obj.setAttribute("tabindex", ""+(tabindex++)); switch (buttonNames[i][0]) { case "SavePdf": case "SaveXls": case "SaveDocx": case "SavePptx": case "SaveHml": case "SaveCell": case "SaveImage": case "SaveExcelPrint": case "SaveExcelBase": break; default: obj.setAttribute("onfocus", "_ubi_wafoucus(this)"); obj.setAttribute("onblur", "_ubi_wablur(this)"); } } } };};}